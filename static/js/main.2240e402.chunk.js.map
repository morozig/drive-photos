{"version":3,"sources":["lib/api.ts","lib/observable.ts","lib/screenfull.ts","App.tsx","lib/hooks.ts","components/thumbnails/hooks.ts","components/thumbnails/Thumbnail.tsx","components/thumbnails/VirtualGrid.tsx","components/thumbnails/index.tsx","components/viewer/index.tsx","components/viewer/hooks.ts","components/topbar/GoogleIcon.tsx","components/topbar/TitleTooltip.tsx","components/topbar/index.tsx","theme.ts","index.tsx"],"names":["GoogleAuth","google","picker","DirectoryEdge","Observable","observers","observer","this","push","subscribe","onceObserver","message","unsubscribe","splice","indexOf","forEach","scope","join","discoveryDocs","apiKey","process","gapi","window","signedInObservable","gapiErrorsObservable","gapiReadyObservable","pickObservable","pickerReadyObservable","onSignedInChanged","isSignedIn","createPicker","undefined","onPick","onGapiLoaded","a","client","init","clientId","auth2","getAuthInstance","get","listen","console","log","e","accessToken","currentUser","getAuthResponse","access_token","view","DocsView","ViewId","DOCS_IMAGES","setMimeTypes","setIncludeFolders","setParent","PickerBuilder","enableFeature","Feature","NAV_HIDDEN","addView","setOAuthToken","setDeveloperKey","setCallback","build","listFiles","options","parentId","pageToken","drive","files","list","q","fields","pageSize","orderBy","result","getEdgeFiles","edge","Begin","getParent","fileId","listDirectories","grandParentId","load","FitMode","document","fn","val","fnMap","i","l","length","ret","Screenfull","Boolean","fullscreenElement","event","callback","eventName","fullscreenerror","fullscreenchange","addEventListener","removeEventListener","element","Promise","resolve","reject","onFullScreenEntered","off","on","returnPromise","documentElement","requestFullscreen","then","catch","isFullscreen","onFullScreenExit","exitFullscreen","exit","request","fullscreenEnabled","localStorageKey","useAbortSignal","abortControllerRef","useRef","AbortController","useEffect","abortController","current","abort","signal","useIsSignedIn","onSignOut","useState","signedIn","setSignedIn","profile","setProfile","gapiError","setGapiError","isCookiesError","setCookiesError","onChange","onError","toggleSignedIn","useCallback","signOut","signIn","once","imageUrl","getBasicProfile","getImageUrl","details","useFullScreen","setFullscreen","isEnabled","run","toggleFullScreen","div","toggle","err","useEdgeFileId","edgeFileId","setEdgeFileId","edgeFiles","aborted","id","useDrive","prevDirId","setPrevDirId","nextDirId","setNextDirId","prevDirFileId","End","setFiles","setPageToken","parentIdRef","prevFiles","concat","nextPageToken","useFiles","nextDirFileId","directory","setDirectory","useDirectory","directories","setDirectories","useDirectories","parents","directoryIndex","useMemo","findIndex","sibling","directoryId","directoryName","name","prev","next","useRectSize","ref","width","height","rectSize","setRectSize","debouncedRectSize","value","delay","debouncedValue","setDebouncedValue","timeout","setTimeout","clearTimeout","useDebounce","check","requestAnimationFrame","offsetWidth","offsetHeight","Thumbnail","props","file","counter","isActive","onClick","Box","sx","borderRadius","boxSizing","overflow","display","alignContent","justifyContent","position","bgcolor","border","src","thumbnailLink","alt","ImageListItemBar","title","subtitle","background","color","VirtualGrid","forwardRef","scrollRef","Item","itemHeight","itemsCount","rowsAhead","rowGap","columnGap","itemWidth","scrollBar","scrollToIndex","onVisibleRows","center","className","itemsInRow","Math","floor","rowsCount","ceil","scrollTop","setScrollTop","scrollContainer","onScroll","target","useScrollAware","indexToOffset","index","block","scrollToRow","scrollOffset","scrollToRowTop","scrollToRowBottom","scrollBottom","totalHeight","useImperativeHandle","scrollTo","scroll","startRow","max","startItem","visibleItemsCount","min","offsetY","firstVisibleRow","lastVisibleRow","visibleRows","visibleItems","Array","fill","map","_","columnWidth","gridTemplateColumns","rowWidth","totalWidth","style","top","gap","justifyItems","Thumbnails","onSelect","onVisibleFiles","virtualGridRef","scrollIndexRef","activeIndex","Img","styled","Viewer","viewerRef","fitMode","onNextImage","onPrevImage","onFitModeChange","isScrollToBottom","isSlideshowEnabled","isSlideshowPlaying","onToggleSlideshowPlaying","contextMenu","setContextMenu","wheelCount","onScrollOverTop","onScrollBelowBottom","scrollTopRef","scrollOverTopCountRef","scrollBelowBottomCountRef","scrollToTop","scrollToBottom","scrollHeight","scrollNextSlide","slideSize","onWheel","deltaY","useScrollActions","timer","setInterval","clearInterval","activeFileId","toggleFullscreen","onContextMenu","preventDefault","x","clientX","y","clientY","onClose","onClickFullscreen","onClickFitBest","Best","onClickFitWidth","Width","onClickFitHeight","Height","onClickFitOriginal","Original","onClickSlideshow","component","textAlign","left","right","bottom","whiteSpace","verticalAlign","webContentLink","maxWidth","maxHeight","Menu","container","disableScrollLock","open","anchorReference","anchorPosition","MenuItem","ListItemIcon","ListItemText","GoogleIcon","SvgIcon","fontSize","transform","d","TitleTooltip","text","isOverflow","setOverflow","scrollWidth","Tooltip","disableHoverListener","Typography","variant","noWrap","Topbar","counterTitle","onOpenFile","fullscreenButtonActive","onToggleFullscreen","isFirstImageEnabled","isPrevImageEnabled","isNextImageEnabled","isLastImageEnabled","onFirstImage","onLastImage","recentFiles","onDownloadFile","onCloseFile","isMobileDrawerOpen","toggleMobileDrawer","isMenuOpen","setMenuOpen","menuRef","isRecentMenuOpen","setRecentMenuOpen","recentMenuRef","isHelpMenuOpen","setHelpMenuOpen","helpMenuRef","isProfileMenuOpen","setProfileMenuOpen","profileMenuRef","isFullscreenEnabled","handleMenuClose","handleMenuClick","onOpenClick","setVisible","Error","onThisPick","action","doc","docs","onDrawerClick","onDownloadClick","onCloseClick","handleRecentMenuClose","handleRecentMenuClick","onRecentFileClick","recentFile","handleHelpMenuClose","handleHelpMenuClick","handleProfileMenuClose","handleProfileMenuClick","onSignOutClick","Toolbar","IconButton","size","mr","anchorEl","xs","md","disabled","Divider","backgroundColor","PaperProps","anchorOrigin","vertical","horizontal","flexGrow","m","p","ToggleButtonGroup","exclusive","ToggleButton","MenuListProps","href","Avatar","ml","drawerWidth","defaultTitle","App","setFitMode","setParentId","setFileId","setIsScrollToBottom","setTitle","setSlideshowPlaying","visibleThumbnails","setVisibleThumbnails","setMobileDrawerOpen","isSmallScreen","theme","useTheme","useMediaQuery","breakpoints","down","useIsSmallScreen","setRecentFiles","recentJsonRef","recentJson","localStorage","getItem","JSON","parse","replace","slice","shift","recentLength","clear","stringify","setItem","removeItem","useRecentFiles","fileJustOpenedRef","activeFile","fileName","documentTitle","newIndex","url","createElement","download","body","appendChild","click","removeChild","viewFiles","preloadFiles","Set","add","delete","from","onKeyDown","key","AppBar","zIndex","drawer","SwipeableDrawer","anchor","onOpen","flexShrink","ModalProps","keepMounted","Drawer","flexDirection","createTheme","palette","primary","main","contrastText","components","MuiTooltip","styleOverrides","tooltip","ReactDOM","render","ThemeProvider","StrictMode","CssBaseline","getElementById"],"mappings":"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","file":"static/js/main.2240e402.chunk.js","sourcesContent":["import Observable from './observable';\r\nimport './Picker.css';\r\n\r\nconst scope = [\r\n  'https://www.googleapis.com/auth/drive.metadata.readonly',\r\n  'https://www.googleapis.com/auth/drive.readonly'\r\n].join(' ');\r\nconst discoveryDocs = [\r\n  'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'\r\n];\r\nconst apiKey = process.env.REACT_APP_GAPI_KEY ||\r\n  'AIzaSyDAXtOKqc3gYjmuoxZAqQHnBm-xTQi1-Mw';\r\nconst clientId = '321539141956-kn4i96a10682t0l8agfo5158fln9ai5d.apps.googleusercontent.com';\r\n\r\nconst gapi = (window as any).gapi;\r\nconst signedInObservable = new Observable<boolean>();\r\nconst gapiErrorsObservable = new Observable<any>();\r\nlet GoogleAuth: any\r\nlet google: any;\r\nconst gapiReadyObservable = new Observable<void>();\r\nlet picker: any;\r\nconst pickObservable = new Observable<any>();\r\nconst pickerReadyObservable = new Observable<void>();\r\n\r\nconst onSignedInChanged = (isSignedIn: boolean) => {\r\n  // console.log('onSignedInChanged', isSignedIn);\r\n  signedInObservable.push(isSignedIn);\r\n  if (isSignedIn) {\r\n    createPicker();\r\n    pickerReadyObservable.push();\r\n  } else {\r\n    picker = undefined;\r\n    pickObservable.unsubscribe(onPick);\r\n  }\r\n};\r\n\r\nconst onGapiLoaded = async () => {\r\n  try {\r\n    await gapi.client.init({\r\n      apiKey,\r\n      clientId,\r\n      scope,\r\n      discoveryDocs\r\n    });\r\n    GoogleAuth = gapi.auth2.getAuthInstance();\r\n    google = (window as any).google;\r\n    // console.log(gapi.auth2, GoogleAuth, GoogleAuth.isSignedIn, google);\r\n    onSignedInChanged(GoogleAuth.isSignedIn.get());\r\n    GoogleAuth.isSignedIn.listen(onSignedInChanged);\r\n    gapiReadyObservable.push();\r\n  }\r\n  catch (err) {\r\n    console.log(err);\r\n    gapiErrorsObservable.push(err);\r\n  }\r\n};\r\n\r\nconst onPick = (e: any) => {\r\n  // console.log('onPick', e);\r\n  pickObservable.push(e);\r\n};\r\n\r\nconst createPicker = () => {\r\n  const user = GoogleAuth.currentUser.get();\r\n  const authResponse = user.getAuthResponse(true);\r\n  const accessToken = authResponse.access_token;\r\n\r\n  const view = new google.picker.DocsView(google.picker.ViewId.DOCS_IMAGES)\r\n    .setMimeTypes('image/apng,image/avif,image/gif,image/jpeg,image/png,image/svg+xml,image/webp')\r\n    .setIncludeFolders(true)\r\n    .setParent('root');\r\n  \r\n  picker = new google.picker.PickerBuilder()\r\n    .enableFeature(google.picker.Feature.NAV_HIDDEN)\r\n    .addView(view)\r\n    .setOAuthToken(accessToken)\r\n    .setDeveloperKey(apiKey)\r\n    .setCallback(onPick)\r\n    .build();\r\n  // console.log({picker});\r\n};\r\n\r\n// console.log(gapi);\r\n\r\nconst isSignedIn = () => {\r\n  return !!GoogleAuth &&\r\n    GoogleAuth.isSignedIn.get() as boolean;\r\n};\r\nexport type SignedInChangeHandler = (isSignedIn: boolean) => void;\r\n\r\nconst subscribeToSignedInChange = (onChange: SignedInChangeHandler) => {\r\n  signedInObservable.subscribe(onChange);\r\n  return () => signedInObservable.unsubscribe(onChange);\r\n};\r\n\r\nconst signIn = () => {\r\n  if (GoogleAuth) {\r\n    GoogleAuth.signIn();\r\n  } else {\r\n    gapiReadyObservable.once(\r\n      () => {\r\n        if (GoogleAuth) {\r\n          GoogleAuth.signIn();\r\n        }\r\n      }\r\n    );\r\n  }\r\n};\r\nconst signOut = () => {\r\n  if (GoogleAuth) {\r\n    GoogleAuth.signOut();\r\n  }\r\n};\r\nconst pickFile = () => new Promise<any>(\r\n  (resolve, reject) => {\r\n    const onThisPick = (e: any) => {\r\n      if (e.action === 'picked') {\r\n        const doc = e.docs[0];\r\n        pickObservable.unsubscribe(onThisPick);\r\n        resolve(doc);\r\n      } else if (e.action === 'cancel') {\r\n        pickObservable.unsubscribe(onThisPick);\r\n        resolve(null);\r\n      }\r\n    };\r\n\r\n    if (picker) {\r\n      picker.setVisible(true);\r\n    } else {\r\n      pickerReadyObservable.once(() => {\r\n        if (picker) {\r\n          picker.setVisible(true);\r\n        } else {\r\n          reject(new Error('No Picker'));\r\n        }\r\n      });\r\n    }\r\n\r\n    pickObservable.subscribe(onThisPick);\r\n  }\r\n);\r\n\r\nconst getFile = async (fileId: string) => {\r\n  try {\r\n    const result = await gapi.client.drive.files.get({\r\n      fileId,\r\n      fields: '*'\r\n    });\r\n    return result.result;\r\n  }\r\n  catch(err) {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\nexport interface ListFilesOptions {\r\n  parentId: string;\r\n  pageToken?: string;\r\n};\r\n\r\nconst listFiles = async (options: ListFilesOptions) => {\r\n  const {\r\n    parentId,\r\n    pageToken\r\n  } = options;\r\n  try {\r\n    const result = await gapi.client.drive.files.list({\r\n      q: `'${parentId}' in parents and mimeType contains 'image/'`,\r\n      fields: 'files(id, name, thumbnailLink, webContentLink, imageMediaMetadata/*)',\r\n      // fields: '*',\r\n      pageSize: 1000,\r\n      orderBy: 'name',\r\n      pageToken\r\n    });\r\n    // console.log({result});\r\n    return result.result;\r\n  }\r\n  catch(err) {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\nexport enum DirectoryEdge {\r\n  Begin = 1,\r\n  End\r\n};\r\ninterface GetEdgeFileOptions {\r\n  parentId: string;\r\n  edge: DirectoryEdge;\r\n};\r\n\r\nconst getEdgeFiles = async (options: GetEdgeFileOptions) => {\r\n  const {\r\n    parentId,\r\n    edge\r\n  } = options;\r\n  try {\r\n    const result = await gapi.client.drive.files.list({\r\n      q: `'${parentId}' in parents and mimeType contains 'image/'`,\r\n      fields: 'files(id, name)',\r\n      pageSize: 1,\r\n      orderBy: edge === DirectoryEdge.Begin ?\r\n        'name' : 'name desc'\r\n    });\r\n    return (\r\n      result.result ?\r\n        result.result.files as any[] : []\r\n    );\r\n  }\r\n  catch(err) {\r\n    console.log(err);\r\n    return [];\r\n  }\r\n};\r\n\r\nconst getParent = async (parentId: string) => {\r\n  try {\r\n    const result = await gapi.client.drive.files.get({\r\n      fileId: parentId,\r\n      fields: '*'\r\n    });\r\n    return result.result;\r\n  }\r\n  catch(err) {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\nconst listDirectories = async (grandParentId: string) => {\r\n  try {\r\n    const result = await gapi.client.drive.files.list({\r\n      q: `'${grandParentId}' in parents and mimeType = 'application/vnd.google-apps.folder'`,\r\n      // fields: 'files(id, name, thumbnailLink, webContentLink, imageMediaMetadata/*)',\r\n      fields: '*',\r\n      pageSize: 1000,\r\n      orderBy: 'name'\r\n    });\r\n    // console.log({result});\r\n    return result.result;\r\n  }\r\n  catch(err) {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\nconst getProfile = () => {\r\n  const user = GoogleAuth.currentUser.get();\r\n  const profile = user.getBasicProfile();\r\n  const imageUrl = profile.getImageUrl();\r\n  return {\r\n    imageUrl\r\n  };\r\n};\r\n\r\nexport type GapiErrorHandler = (error: any) => void;\r\nconst subscribeToGapiErrors = (onError: GapiErrorHandler) => {\r\n  gapiErrorsObservable.subscribe(onError);\r\n  return () => gapiErrorsObservable.unsubscribe(onError);\r\n};\r\n\r\ngapi.load('client:auth2:picker', onGapiLoaded);\r\n\r\nexport {\r\n  isSignedIn,\r\n  signIn,\r\n  signOut,\r\n  subscribeToSignedInChange,\r\n  pickFile,\r\n  getFile,\r\n  listFiles,\r\n  getParent,\r\n  getEdgeFiles,\r\n  listDirectories,\r\n  getProfile,\r\n  subscribeToGapiErrors\r\n};\r\n","type Observer<T> = (message: T) => void;\r\n\r\nexport default class Observable<T> {\r\n  private observers = [] as Observer<T>[];\r\n  subscribe(observer: Observer<T>) {\r\n    this.observers.push(observer);\r\n  }\r\n  once(observer: Observer<T>) {\r\n    const onceObserver = (message: T) => {\r\n      observer(message);\r\n      this.unsubscribe(onceObserver);\r\n    };\r\n    this.subscribe(onceObserver);\r\n  }\r\n  unsubscribe(observer: Observer<T>){\r\n    this.observers.splice(\r\n      this.observers.indexOf(observer),\r\n      1\r\n    );\r\n  }\r\n  push(message: T) {\r\n    this.observers.forEach(observer => observer(message));\r\n  }\r\n  unsubscribeAll() {\r\n    this.observers = [];\r\n  }\r\n};","const document = typeof window !== 'undefined' &&\r\n\ttypeof window.document !== 'undefined' ?\r\n\t\twindow.document : {} as any;\r\n\r\nconst fn = (() => {\r\n\tlet val;\r\n\r\n\tlet fnMap = [\r\n\t\t[\r\n\t\t\t'requestFullscreen',\r\n\t\t\t'exitFullscreen',\r\n\t\t\t'fullscreenElement',\r\n\t\t\t'fullscreenEnabled',\r\n\t\t\t'fullscreenchange',\r\n\t\t\t'fullscreenerror'\r\n\t\t],\r\n\t\t// New WebKit\r\n\t\t[\r\n\t\t\t'webkitRequestFullscreen',\r\n\t\t\t'webkitExitFullscreen',\r\n\t\t\t'webkitFullscreenElement',\r\n\t\t\t'webkitFullscreenEnabled',\r\n\t\t\t'webkitfullscreenchange',\r\n\t\t\t'webkitfullscreenerror'\r\n\r\n\t\t],\r\n\t\t// Old WebKit\r\n\t\t[\r\n\t\t\t'webkitRequestFullScreen',\r\n\t\t\t'webkitCancelFullScreen',\r\n\t\t\t'webkitCurrentFullScreenElement',\r\n\t\t\t'webkitCancelFullScreen',\r\n\t\t\t'webkitfullscreenchange',\r\n\t\t\t'webkitfullscreenerror'\r\n\r\n\t\t],\r\n\t\t[\r\n\t\t\t'mozRequestFullScreen',\r\n\t\t\t'mozCancelFullScreen',\r\n\t\t\t'mozFullScreenElement',\r\n\t\t\t'mozFullScreenEnabled',\r\n\t\t\t'mozfullscreenchange',\r\n\t\t\t'mozfullscreenerror'\r\n\t\t],\r\n\t\t[\r\n\t\t\t'msRequestFullscreen',\r\n\t\t\t'msExitFullscreen',\r\n\t\t\t'msFullscreenElement',\r\n\t\t\t'msFullscreenEnabled',\r\n\t\t\t'MSFullscreenChange',\r\n\t\t\t'MSFullscreenError'\r\n\t\t]\r\n\t];\r\n\r\n\tlet i = 0;\r\n\tlet l = fnMap.length;\r\n\tlet ret = {} as any;\r\n\r\n\tfor (; i < l; i++) {\r\n\t\tval = fnMap[i];\r\n\t\tif (val && val[1] in document) {\r\n\t\t\tfor (i = 0; i < val.length; i++) {\r\n\t\t\t\tret[fnMap[0][i]] = val[i];\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n})();\r\n\r\ntype EventName = 'change' | 'error';\r\n\r\nclass Screenfull {\r\n\tstatic get isFullscreen() {\r\n\t\treturn Boolean(document[fn.fullscreenElement]);\r\n\t}\r\n\tstatic on(event: EventName, callback: (event: Event) => void) {\r\n    const eventName = event === 'error' ?\r\n      fn.fullscreenerror : fn.fullscreenchange;\r\n    document.addEventListener(eventName, callback, false);\r\n  }\r\n\tstatic off(event: EventName, callback: (event: Event) => void) {\r\n    const eventName = event === 'error' ?\r\n      fn.fullscreenerror : fn.fullscreenchange;\r\n    document.removeEventListener(eventName, callback, false);\r\n  }\r\n  static request(element?: Element) {\r\n    return new Promise<void>((resolve, reject) => {\r\n      const onFullScreenEntered = () => {\r\n        this.off('change', onFullScreenEntered);\r\n        resolve();\r\n      };\r\n\r\n      this.on('change', onFullScreenEntered);\r\n\r\n      const fullscreenElement = element || document.documentElement;\r\n\r\n      const returnPromise = fullscreenElement[fn.requestFullscreen]();\r\n\r\n      if (returnPromise instanceof Promise) {\r\n        returnPromise.then(onFullScreenEntered).catch(reject);\r\n      }\r\n    });\r\n  }\r\n  static exit() {\r\n    return new Promise<void>((resolve, reject) => {\r\n      if (!this.isFullscreen) {\r\n        resolve();\r\n        return;\r\n      }\r\n\r\n      const onFullScreenExit = () => {\r\n        this.off('change', onFullScreenExit);\r\n        resolve();\r\n      };\r\n\r\n      this.on('change', onFullScreenExit);\r\n\r\n      const returnPromise = document[fn.exitFullscreen]();\r\n\r\n      if (returnPromise instanceof Promise) {\r\n        returnPromise.then(onFullScreenExit).catch(reject);\r\n      }\r\n    });\r\n  }\r\n  static toggle(element?: Element){\r\n    return this.isFullscreen ? this.exit() : this.request(element);\r\n  }\r\n  static get isEnabled() {\r\n\t\treturn Boolean(document[fn.fullscreenEnabled]);\r\n\t}\r\n};\r\n\r\nexport default Screenfull;\r\n","import React, {\r\n  useState,\r\n  useRef,\r\n  useCallback,\r\n  useMemo,\r\n  useEffect\r\n} from 'react';\r\nimport {\r\n  AppBar,\r\n  Box,\r\n  Toolbar,\r\n  Drawer,\r\n  SwipeableDrawer\r\n} from '@material-ui/core';\r\nimport { useDrive, useIsSmallScreen, useRecentFiles } from './lib/hooks';\r\nimport Thumbnails from './components/thumbnails';\r\nimport Viewer, { ViewerRef } from './components/viewer';\r\nimport Topbar from './components/topbar';\r\n\r\n\r\nconst drawerWidth = 260;\r\nconst preloadCount = 3;\r\nconst defaultTitle = 'Drive Photos';\r\n\r\nexport enum FitMode {\r\n  Best = 1,\r\n  Width,\r\n  Height,\r\n  Original\r\n}\r\n\r\nconst App: React.FC = () => {\r\n  const [ fitMode, setFitMode ] = useState<FitMode>(FitMode.Best);\r\n  const [ parentId, setParentId ] = useState('');\r\n  const [ fileId, setFileId ] = useState('');\r\n  const [ isScrollToBottom, setIsScrollToBottom ] = useState(false);\r\n  const [ title, setTitle ] = useState(defaultTitle);\r\n  const [ isSlideshowPlaying, setSlideshowPlaying ] = useState(false);\r\n  const [\r\n    visibleThumbnails,\r\n    setVisibleThumbnails\r\n  ] = useState<number[]>([]);\r\n  const [ isMobileDrawerOpen, setMobileDrawerOpen ] = useState(false);\r\n\r\n  const toggleMobileDrawer = useCallback(() => {\r\n    setMobileDrawerOpen(current => !current);\r\n  }, []);\r\n  const isSmallScreen = useIsSmallScreen();\r\n\r\n\r\n  const {\r\n    files,\r\n    directoryId,\r\n    directoryName,\r\n    prevDirId,\r\n    prevDirFileId,\r\n    nextDirId,\r\n    nextDirFileId\r\n  } = useDrive(parentId);\r\n\r\n  const {\r\n    recentFiles,\r\n    replace,\r\n    shift,\r\n    clear\r\n  } = useRecentFiles();\r\n  const fileJustOpenedRef = useRef(false);\r\n\r\n  const onOpenFile = useCallback((file: any) => {\r\n    setFileId(file.id);\r\n    setParentId(file.parentId);\r\n    setIsScrollToBottom(false);\r\n    fileJustOpenedRef.current = true;\r\n  }, []);\r\n\r\n  const activeIndex = useMemo(() => {\r\n    if (fileId && files.length > 0) {\r\n      return files.findIndex(file => file.id === fileId);\r\n    } else {\r\n      return -1;\r\n    }\r\n  }, [\r\n    fileId,\r\n    files\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const activeFile = files[activeIndex];\r\n    const fileName = activeFile ? activeFile.name : '';\r\n    const title = (directoryName && fileName) ? \r\n      `${directoryName}/${fileName}` : '';\r\n    const documentTitle = title ?\r\n      `${title} | ${defaultTitle}` : defaultTitle;\r\n    setTitle(title || defaultTitle);\r\n    document.title = documentTitle;\r\n    if (activeFile && directoryId && title) {\r\n      const recentFile = {\r\n        id: activeFile.id,\r\n        parentId: directoryId,\r\n        title\r\n      };\r\n      if (fileJustOpenedRef.current) {\r\n        shift(recentFile);\r\n        fileJustOpenedRef.current = false;\r\n      } else {\r\n        replace(recentFile);\r\n      }\r\n    }\r\n  }, [\r\n    activeIndex,\r\n    directoryId,\r\n    directoryName,\r\n    files,\r\n    replace,\r\n    shift\r\n  ]);\r\n\r\n  const counterTitle = useMemo(() => {\r\n    return (activeIndex >= 0 && files.length > 0) ?\r\n      `${activeIndex + 1}/${files.length}` : '';\r\n  }, [\r\n    activeIndex,\r\n    files\r\n  ]);\r\n\r\n  const isFirstImageEnabled = useMemo(() => {\r\n    if (activeIndex < 0 || files.length < 0) {\r\n      return false;\r\n    }\r\n    return (activeIndex > 0);\r\n  }, [\r\n    activeIndex,\r\n    files.length\r\n  ]);\r\n  const isPrevImageEnabled = useMemo(() => {\r\n    if (activeIndex < 0 || files.length < 0) {\r\n      return false;\r\n    }\r\n    return (\r\n      activeIndex > 0 ||\r\n      !!prevDirFileId\r\n    )\r\n  }, [\r\n    activeIndex,\r\n    files.length,\r\n    prevDirFileId\r\n  ]);\r\n  const isNextImageEnabled = useMemo(() => {\r\n    if (activeIndex < 0 || files.length < 0) {\r\n      return false;\r\n    }\r\n    return (\r\n      activeIndex < files.length - 1 ||\r\n      !!nextDirFileId\r\n    )\r\n  }, [\r\n    activeIndex,\r\n    files.length,\r\n    nextDirFileId\r\n  ]);\r\n  const isLastImageEnabled = useMemo(() => {\r\n    if (activeIndex < 0 || files.length < 0) {\r\n      return false;\r\n    }\r\n    return (activeIndex < files.length - 1);\r\n  }, [\r\n    activeIndex,\r\n    files.length\r\n  ]);\r\n  const isSlideshowEnabled = useMemo(() => {\r\n    return isNextImageEnabled;\r\n  }, [\r\n    isNextImageEnabled\r\n  ]);\r\n\r\n  const onFirstImage = useCallback(() => {\r\n    const newIndex = 0;\r\n    if (files[newIndex]) {\r\n      setFileId(files[newIndex].id);\r\n      setIsScrollToBottom(false);\r\n    }\r\n  }, [\r\n    files\r\n  ]);\r\n  const onPrevImage = useCallback(() => {\r\n    const newIndex = activeIndex - 1;\r\n    if (files[newIndex]) {\r\n      setFileId(files[newIndex].id);\r\n      setIsScrollToBottom(true);\r\n    } else {\r\n      if (prevDirId && prevDirFileId) {\r\n        setFileId(prevDirFileId);\r\n        setParentId(prevDirId);\r\n        setIsScrollToBottom(true);\r\n      }\r\n    }\r\n  }, [\r\n    activeIndex,\r\n    files,\r\n    prevDirId,\r\n    prevDirFileId\r\n  ]);\r\n  const onNextImage = useCallback(() => {\r\n    const newIndex = activeIndex + 1;\r\n    if (files[newIndex]) {\r\n      setFileId(files[newIndex].id);\r\n      setIsScrollToBottom(false);\r\n    } else {\r\n      if (nextDirId && nextDirFileId) {\r\n        setFileId(nextDirFileId);\r\n        setParentId(nextDirId);\r\n        setIsScrollToBottom(false);\r\n      }\r\n    }\r\n  }, [\r\n    activeIndex,\r\n    files,\r\n    nextDirId,\r\n    nextDirFileId\r\n  ]);\r\n  const onLastImage = useCallback(() => {\r\n    const newIndex = files.length - 1;\r\n    if (files[newIndex]) {\r\n      setFileId(files[newIndex].id);\r\n      setIsScrollToBottom(false);\r\n    }\r\n  }, [\r\n    files\r\n  ]);\r\n\r\n  const onSelect = useCallback((fileId: string) => {\r\n    setFileId(fileId);\r\n    setIsScrollToBottom(false);\r\n  }, []);\r\n  useEffect(() => {\r\n    if (!isSlideshowEnabled && isSlideshowPlaying) {\r\n      setSlideshowPlaying(false);\r\n    }\r\n  }, [\r\n    isSlideshowEnabled,\r\n    isSlideshowPlaying\r\n  ]);\r\n  const onToggleSlideshowPlaying = useCallback(() => {\r\n    setSlideshowPlaying(current => !current);\r\n  }, []);\r\n  const onDownloadFile = useCallback(() => {\r\n    const activeFile = files[activeIndex];\r\n    if (activeFile) {\r\n      const name = activeFile.name;\r\n      const url = activeFile.webContentLink;\r\n      const a = document.createElement('a');\r\n      a.download = name;\r\n      a.href = url;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n    }\r\n  }, [\r\n    activeIndex,\r\n    files\r\n  ]);\r\n  const onCloseFile = useCallback(() => {\r\n    setFileId('');\r\n    setParentId('');\r\n    setIsScrollToBottom(false);\r\n  }, []);\r\n  const onSignOut = useCallback(() => {\r\n    onCloseFile();\r\n    clear();\r\n    localStorage.clear();\r\n  }, [\r\n    onCloseFile,\r\n    clear\r\n  ]);\r\n\r\n  const viewFiles = useMemo(() => {\r\n    if (activeIndex < 0 || files.length <= 0) {\r\n      return [];\r\n    }\r\n    const activeFile = files[activeIndex];\r\n    const preloadFiles = new Set<any>();\r\n    for (let i = 1; i <= preloadCount; i++) {\r\n      const file = files[activeIndex + i];\r\n      if (file) {\r\n        preloadFiles.add(file);\r\n      }\r\n    }\r\n    for (let i = 1; i <= preloadCount; i++) {\r\n      const file = files[activeIndex - i];\r\n      if (file) {\r\n        preloadFiles.add(file);\r\n      }\r\n    }\r\n    for (let i = 0; i < preloadCount; i++) {\r\n      const file = files[i];\r\n      if (file) {\r\n        preloadFiles.add(file);\r\n      }\r\n    }\r\n    for (let i = files.length - 1; i >= files.length - preloadCount; i--) {\r\n      const file = files[i];\r\n      if (file) {\r\n        preloadFiles.add(file);\r\n      }\r\n    }\r\n    for (let i of visibleThumbnails) {\r\n      const file = files[i];\r\n      if (file) {\r\n        preloadFiles.add(file);\r\n      }\r\n    }\r\n    preloadFiles.delete(activeFile);\r\n    return [activeFile].concat(Array.from(preloadFiles));\r\n  }, [\r\n    activeIndex,\r\n    files,\r\n    visibleThumbnails\r\n  ]);\r\n\r\n  const viewerRef = useRef<ViewerRef>(null);\r\n  const onToggleFullscreen = useCallback(() => {\r\n    if (viewerRef.current) {\r\n      viewerRef.current.toggleFullscreen();\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const onKeyDown = (e: KeyboardEvent) => {\r\n      switch (e.key) {\r\n        case 'Home': {\r\n          onFirstImage();\r\n          break;\r\n        }\r\n        case 'ArrowLeft': {\r\n          onPrevImage();\r\n          break;\r\n        }\r\n        case 'ArrowRight': {\r\n          onNextImage();\r\n          break;\r\n        }\r\n        case 'End': {\r\n          onLastImage();\r\n          break;\r\n        }\r\n        case ' ': {\r\n          onToggleSlideshowPlaying();\r\n          break;\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', onKeyDown);\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', onKeyDown);\r\n    };\r\n  }, [\r\n    onFirstImage,\r\n    onPrevImage,\r\n    onNextImage,\r\n    onLastImage,\r\n    onToggleSlideshowPlaying\r\n  ]);\r\n\r\n  return (\r\n    <Box sx={{ display: 'flex' }}>\r\n      <AppBar position='fixed' sx={{ zIndex: (theme) => theme.zIndex.drawer + 1 }}>\r\n        <Topbar\r\n          title={title}\r\n          counterTitle={counterTitle}\r\n          fitMode={fitMode}\r\n          onFitModeChange={setFitMode}\r\n          onOpenFile={onOpenFile}\r\n          fullscreenButtonActive={files.length > 0}\r\n          onToggleFullscreen={onToggleFullscreen}\r\n          isFirstImageEnabled={isFirstImageEnabled}\r\n          isPrevImageEnabled={isPrevImageEnabled}\r\n          isNextImageEnabled={isNextImageEnabled}\r\n          isLastImageEnabled={isLastImageEnabled}\r\n          isSlideshowEnabled={isSlideshowEnabled}\r\n          isSlideshowPlaying={isSlideshowPlaying}\r\n          onToggleSlideshowPlaying={onToggleSlideshowPlaying}\r\n          onFirstImage={onFirstImage}\r\n          onPrevImage={onPrevImage}\r\n          onNextImage={onNextImage}\r\n          onLastImage={onLastImage}\r\n          recentFiles={recentFiles}\r\n          onDownloadFile={onDownloadFile}\r\n          onCloseFile={onCloseFile}\r\n          onSignOut={onSignOut}\r\n          isMobileDrawerOpen={isMobileDrawerOpen}\r\n          toggleMobileDrawer={toggleMobileDrawer}\r\n        />\r\n      </AppBar>\r\n      {isSmallScreen ?\r\n        <SwipeableDrawer\r\n          anchor='left'\r\n          open={isMobileDrawerOpen}\r\n          onOpen={toggleMobileDrawer}\r\n          onClose={toggleMobileDrawer}\r\n          sx={{\r\n            width: drawerWidth,\r\n            flexShrink: 0,\r\n            [`& .MuiDrawer-paper`]: {\r\n              width: drawerWidth,\r\n              boxSizing: 'border-box'\r\n            },\r\n            display: 'flex',\r\n            flexDirection: 'column'\r\n          }}\r\n          ModalProps={{\r\n            keepMounted: true,\r\n          }}\r\n        >\r\n          <Toolbar />\r\n          <Thumbnails\r\n            files={files}\r\n            fileId={fileId}\r\n            onSelect={onSelect}\r\n            onVisibleFiles={setVisibleThumbnails}\r\n            sx={{\r\n              flexGrow: 1\r\n            }}\r\n          />\r\n        </SwipeableDrawer> :\r\n        <Drawer\r\n          variant='permanent'\r\n          sx={{\r\n            width: drawerWidth,\r\n            flexShrink: 0,\r\n            [`& .MuiDrawer-paper`]: {\r\n              width: drawerWidth,\r\n              boxSizing: 'border-box'\r\n            },\r\n            display: 'flex',\r\n            flexDirection: 'column'\r\n          }}\r\n        >\r\n          <Toolbar />\r\n          <Thumbnails\r\n            files={files}\r\n            fileId={fileId}\r\n            onSelect={onSelect}\r\n            onVisibleFiles={setVisibleThumbnails}\r\n            sx={{\r\n              flexGrow: 1\r\n            }}\r\n          />\r\n        </Drawer>\r\n      }\r\n      <Box component='main' sx={{\r\n        flexGrow: 1,\r\n        height: '100vh',\r\n        display: 'flex',\r\n        flexDirection: 'column'\r\n      }}>\r\n        <Toolbar />\r\n        {files.length > 0 &&\r\n          <Viewer\r\n            fitMode={fitMode}\r\n            files={viewFiles}\r\n            onPrevImage={onPrevImage}\r\n            onNextImage={onNextImage}\r\n            onFitModeChange={setFitMode}\r\n            isScrollToBottom={isScrollToBottom}\r\n            isSlideshowEnabled={isSlideshowEnabled}\r\n            isSlideshowPlaying={isSlideshowPlaying}\r\n            onToggleSlideshowPlaying={onToggleSlideshowPlaying}\r\n            sx={{\r\n              flexGrow: 1\r\n            }}\r\n            ref={viewerRef}\r\n          />\r\n        }\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import {\r\n  useCallback,\r\n  useEffect,\r\n  useMemo,\r\n  useRef,\r\n  useState\r\n} from 'react';\r\nimport {\r\n  DirectoryEdge,\r\n  getEdgeFiles,\r\n  getParent,\r\n  getProfile,\r\n  isSignedIn,\r\n  listDirectories,\r\n  listFiles,\r\n  signIn,\r\n  signOut,\r\n  subscribeToGapiErrors,\r\n  subscribeToSignedInChange\r\n} from './api';\r\nimport Screenfull from './screenfull';\r\nimport { useTheme } from '@material-ui/core/styles';\r\nimport { useMediaQuery } from '@material-ui/core';\r\n\r\nconst localStorageKey = 'recent';\r\nconst recentLength = 10;\r\n\r\nconst useAbortSignal = () => {\r\n  const abortControllerRef = useRef(new AbortController());\r\n\r\n  useEffect(() => {\r\n    const abortController = abortControllerRef.current;\r\n    return () => {\r\n      abortController.abort();\r\n    };\r\n  }, []);\r\n\r\n  return abortControllerRef.current.signal;\r\n};\r\n\r\nconst useIsSignedIn = (onSignOut: () => void) => {\r\n  const [ signedIn, setSignedIn ] = useState(isSignedIn());\r\n  const [ profile, setProfile ] = useState<any | null>(null);\r\n  const [ gapiError, setGapiError ] = useState<any | null>(null);\r\n  const [ isCookiesError, setCookiesError ] = useState(false);\r\n  \r\n  useEffect(() => {\r\n    return subscribeToSignedInChange(setSignedIn);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    return subscribeToGapiErrors(setGapiError);\r\n  }, []);\r\n\r\n  const toggleSignedIn = useCallback(() => {\r\n    // console.log('toggleSignedIn');\r\n    if (!signedIn) {\r\n      signIn();\r\n    } else {\r\n      onSignOut();\r\n      signOut();\r\n    }\r\n  }, [\r\n    signedIn,\r\n    onSignOut\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (signedIn) {\r\n      const profile = getProfile();\r\n      setProfile(profile);\r\n    } else {\r\n      setProfile(null);\r\n    }\r\n  }, [\r\n    signedIn\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (gapiError && gapiError.details &&\r\n      gapiError.details === 'Cookies are not enabled in current environment.'\r\n    ) {\r\n      setCookiesError(true);\r\n    } else {\r\n      setCookiesError(false);\r\n    }\r\n  }, [\r\n    gapiError\r\n  ]);\r\n\r\n  return {\r\n    isSignedIn: signedIn,\r\n    toggleSignedIn,\r\n    profile,\r\n    isCookiesError\r\n  };\r\n};\r\n\r\nconst useFiles = (parentId?: string) => {\r\n  const [ files, setFiles ] = useState<any[]>([]);\r\n  const [ pageToken, setPageToken ] = useState<string | undefined>();\r\n  const signal = useAbortSignal();\r\n  const parentIdRef = useRef<string | undefined>(parentId);\r\n\r\n  useEffect(() => {\r\n    if (parentId !== parentIdRef.current) {\r\n      setFiles([]);\r\n      parentIdRef.current = parentId;\r\n    }\r\n  }, [\r\n    parentId\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const run = async () => {\r\n      if (!parentId) {\r\n        return;\r\n      }\r\n      try {\r\n        const result = await listFiles({\r\n          parentId,\r\n          pageToken\r\n        });\r\n        if(!signal.aborted) {\r\n          setFiles(prevFiles => prevFiles.concat(result.files))\r\n          if (result.nextPageToken) {\r\n            setPageToken(result.nextPageToken);\r\n          }\r\n        }\r\n      }\r\n      catch(err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n\r\n    if (parentId) {\r\n      run();\r\n    }\r\n  }, [\r\n    pageToken,\r\n    parentId,\r\n    signal\r\n  ]);\r\n  \r\n  return files;\r\n};\r\n\r\nconst useDirectory = (parentId?: string) => {\r\n  const [ directory, setDirectory ] = useState<any | null>(null);\r\n  const signal = useAbortSignal();\r\n\r\n  useEffect(() => {\r\n    const run = async () => {\r\n      if (!parentId) {\r\n        return;\r\n      }\r\n      try {\r\n        const directory = await getParent(parentId);\r\n        if(!signal.aborted) {\r\n          setDirectory(directory);\r\n        }\r\n      }\r\n      catch(err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n\r\n    if (parentId) {\r\n      run();\r\n    }\r\n  }, [\r\n    parentId,\r\n    signal\r\n  ]);\r\n  \r\n  return directory;\r\n};\r\n\r\nconst useFullScreen = () => {\r\n  const [ isFullscreen, setFullscreen ] = useState(Screenfull.isFullscreen);\r\n  const [ isEnabled ] = useState(Screenfull.isEnabled);\r\n\r\n  useEffect(() => {\r\n    if (!Screenfull.isEnabled) {\r\n      return;\r\n    }\r\n    const run = () => {\r\n      const isFullscreen = Screenfull.isFullscreen;\r\n      setFullscreen(isFullscreen);\r\n    };\r\n    run();\r\n    Screenfull.on('change', run);\r\n    return () => {\r\n      Screenfull.off('change', run);\r\n    };\r\n  }, []);\r\n\r\n  const toggleFullScreen = useCallback((div?: HTMLDivElement | null) => {\r\n    const run = async () => {\r\n      if (!Screenfull.isEnabled) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        Screenfull.toggle(div || undefined);\r\n      }\r\n      catch (err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n    run();\r\n  }, []);\r\n\r\n  return {\r\n    isEnabled,\r\n    isFullscreen,\r\n    toggleFullScreen\r\n  };\r\n};\r\n\r\ninterface UseEdgeFileIdOptions {\r\n  parentId?: string;\r\n  edge: DirectoryEdge;\r\n};\r\n\r\nconst useEdgeFileId = (options: UseEdgeFileIdOptions) => {\r\n  const {\r\n    parentId,\r\n    edge\r\n  } = options;\r\n  const [ edgeFileId, setEdgeFileId ] = useState('');\r\n  const signal = useAbortSignal();\r\n\r\n  useEffect(() => {\r\n    const run = async () => {\r\n      if (!parentId) {\r\n        return;\r\n      }\r\n      try {\r\n        const edgeFiles = await getEdgeFiles({\r\n          parentId,\r\n          edge\r\n        });\r\n        if(!signal.aborted){\r\n          if (edgeFiles.length) {\r\n            setEdgeFileId(edgeFiles[0].id);\r\n          } else {\r\n            setEdgeFileId('');\r\n          }\r\n        }\r\n      }\r\n      catch(err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n\r\n    if (parentId) {\r\n      run();\r\n    } else {\r\n      setEdgeFileId('');\r\n    }\r\n  }, [\r\n    parentId,\r\n    edge,\r\n    signal\r\n  ]);\r\n  \r\n  return edgeFileId;\r\n};\r\n\r\nconst useDirectories = (grandParentId?: string) => {\r\n  const [ directories, setDirectories ] = useState<any[]>([]);\r\n  const signal = useAbortSignal();\r\n\r\n  useEffect(() => {\r\n    const run = async () => {\r\n      if (!grandParentId) {\r\n        return;\r\n      }\r\n      try {\r\n        const result = await listDirectories(grandParentId);\r\n        if(!signal.aborted) {\r\n          setDirectories(result.files)\r\n        }\r\n      }\r\n      catch(err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n\r\n    if (grandParentId) {\r\n      run();\r\n    }\r\n  }, [\r\n    grandParentId,\r\n    signal\r\n  ]);\r\n  \r\n  return directories;\r\n};\r\n\r\nconst useDrive = (parentId?: string) => {\r\n  const [ prevDirId, setPrevDirId ] = useState('');\r\n  const [ nextDirId, setNextDirId ] = useState('');\r\n  \r\n  const prevDirFileId = useEdgeFileId({\r\n    parentId: prevDirId,\r\n    edge: DirectoryEdge.End\r\n  });\r\n  const files = useFiles(parentId);\r\n  const nextDirFileId = useEdgeFileId({\r\n    parentId: nextDirId,\r\n    edge: DirectoryEdge.Begin\r\n  });\r\n  const directory = useDirectory(parentId);\r\n  const directories = useDirectories(\r\n    directory ?\r\n      directory.parents[0] :\r\n      ''\r\n  );\r\n  const directoryIndex = useMemo(() => {\r\n    return directories.findIndex(sibling => sibling.id === parentId);\r\n  }, [\r\n    parentId,\r\n    directories\r\n  ]);\r\n  const directoryId = useMemo(() => {\r\n    return directory ? (directory.id as string || '') : '';\r\n  }, [\r\n    directory\r\n  ]);\r\n  const directoryName = useMemo(() => {\r\n    return directory ? (directory.name as string || '') : '';\r\n  }, [\r\n    directory\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (directoryIndex >= 0) {\r\n      const prev = directories[directoryIndex - 1];\r\n      setPrevDirId(prev ? prev.id : '');\r\n      const next = directories[directoryIndex + 1];\r\n      setNextDirId(next ? next.id : '');\r\n    }\r\n  }, [\r\n    directories,\r\n    directoryIndex\r\n  ]);\r\n\r\n  return {\r\n    files,\r\n    directoryId,\r\n    directoryName,\r\n    prevDirId,\r\n    prevDirFileId,\r\n    nextDirId,\r\n    nextDirFileId\r\n  }\r\n};\r\n\r\n\r\nexport interface RecentFile {\r\n  id: string;\r\n  parentId: string;\r\n  title: string;\r\n};\r\n\r\nconst useRecentFiles = () => {\r\n  const [ recentFiles, setRecentFiles ] = useState<RecentFile[]>([]);\r\n  const recentJsonRef = useRef<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const recentJson = localStorage.getItem(localStorageKey);\r\n    recentJsonRef.current = recentJson;\r\n\r\n    if (recentJson) {\r\n      setRecentFiles(JSON.parse(recentJson));\r\n    }\r\n  }, []);\r\n\r\n  const replace = useCallback((file: RecentFile) => {\r\n    setRecentFiles(\r\n      current => [file].concat(current.slice(1))\r\n    );\r\n  }, []);\r\n  const shift = useCallback((file: RecentFile) => {\r\n    setRecentFiles(\r\n      current => [file].concat(current.slice(0, recentLength - 1))\r\n    );\r\n  }, []);\r\n  const clear = useCallback(() => {\r\n    setRecentFiles([]);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (recentFiles.length > 0) {\r\n      const recentJson = JSON.stringify(recentFiles);\r\n  \r\n      if (recentJson !== recentJsonRef.current) {\r\n        localStorage.setItem(localStorageKey, recentJson);\r\n        recentJsonRef.current = recentJson;\r\n      }\r\n    } else {\r\n      if (localStorage.getItem(localStorageKey)) {\r\n        localStorage.removeItem(localStorageKey);\r\n        recentJsonRef.current = null\r\n      }\r\n    }\r\n  }, [\r\n    recentFiles\r\n  ]);\r\n\r\n  return {\r\n    recentFiles,\r\n    replace,\r\n    shift,\r\n    clear\r\n  };\r\n};\r\n\r\nconst useIsSmallScreen = () => {\r\n  const theme = useTheme();\r\n  const isSmallScreen = useMediaQuery(theme.breakpoints.down('md'));\r\n  return isSmallScreen;\r\n};\r\n\r\nexport {\r\n  useAbortSignal,\r\n  useIsSignedIn,\r\n  useFiles,\r\n  useDirectory,\r\n  useFullScreen,\r\n  useDrive,\r\n  useRecentFiles,\r\n  useIsSmallScreen\r\n};\r\n","import {\r\n  useState,\r\n  useEffect,\r\n  useRef,\r\n  useCallback\r\n} from 'react';\r\nimport { useAbortSignal } from '../../lib/hooks';\r\n\r\nconst useDebounce = <T>(value: T, delay: number) => {\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n\r\n  useEffect(\r\n    () => {\r\n      const timeout = setTimeout(() => {\r\n        setDebouncedValue(value);\r\n      }, delay);\r\n      return () => {\r\n        clearTimeout(timeout);\r\n      };\r\n    },\r\n    [value, delay]\r\n  );\r\n\r\n  return debouncedValue;\r\n};\r\n\r\nconst useScrollAware = () => {\r\n  const [scrollTop, setScrollTop] = useState(0);\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  const signal = useAbortSignal();\r\n\r\n  useEffect(() => {\r\n    const scrollContainer = ref.current;\r\n    if (!scrollContainer) {\r\n      return;\r\n    }\r\n\r\n    const onScroll = (e: Event) => {\r\n      requestAnimationFrame(() => {\r\n        const div = e.target as HTMLDivElement;\r\n        if (div && !signal.aborted) {\r\n          setScrollTop(+div.scrollTop);\r\n        }\r\n      });\r\n    };\r\n\r\n    setScrollTop(scrollContainer.scrollTop);\r\n    scrollContainer.addEventListener('scroll', onScroll);\r\n    return () => scrollContainer.removeEventListener('scroll', onScroll);\r\n  }, [\r\n    signal\r\n  ]);\r\n\r\n  return {\r\n    scrollTop,\r\n    ref\r\n  };\r\n};\r\n\r\ninterface RectSize {\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nconst useRectSize = () => {\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  const [ rectSize, setRectSize ] = useState({\r\n    width: 0,\r\n    height: 0\r\n  } as RectSize);\r\n  const debouncedRectSize = useDebounce(rectSize, 150);\r\n  const signal = useAbortSignal();\r\n\r\n  const check = useCallback(async () => {\r\n    requestAnimationFrame(() => {\r\n      const div = ref.current;\r\n      if (div && !signal.aborted) {\r\n        setRectSize({\r\n          width: div.offsetWidth,\r\n          height: div.offsetHeight\r\n        } as RectSize)\r\n      }\r\n    });\r\n  }, [\r\n    signal\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    check();\r\n    window.addEventListener('resize', check);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', check);\r\n    };\r\n  }, [\r\n    check,\r\n    signal\r\n  ]);\r\n\r\n\r\n  return {\r\n    ref,\r\n    rectSize: debouncedRectSize\r\n  };\r\n};\r\n\r\nexport {\r\n  useScrollAware,\r\n  useRectSize\r\n}\r\n","import React from 'react';\r\n\r\nimport {\r\n  Box,\r\n  ImageListItemBar\r\n} from '@material-ui/core';\r\n\r\ninterface ThumbnailProps {\r\n  file: any;\r\n  counter: number,\r\n  isActive: boolean;\r\n  onClick: () => void;\r\n}\r\n\r\nconst Thumbnail: React.FC<ThumbnailProps> = (props: ThumbnailProps) => {\r\n  const {\r\n    file,\r\n    counter,\r\n    isActive,\r\n    onClick\r\n  } = props;\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        height: 220,\r\n        width: 220,\r\n        borderRadius: '6px',\r\n        boxSizing: 'border-box',\r\n        overflow: 'hidden',\r\n        display: 'grid',\r\n        alignContent: 'center',\r\n        justifyContent: 'center',\r\n        position: 'relative',\r\n        ...(isActive ?\r\n          {\r\n            bgcolor: 'common.black'\r\n          } :\r\n          {\r\n            border: '1px solid #dadce0'\r\n          }\r\n        )\r\n      }}\r\n      onClick={onClick}\r\n    >\r\n      <img\r\n        src={file.thumbnailLink}\r\n        alt={file.name}\r\n      />\r\n      <ImageListItemBar\r\n        title={file.name}\r\n        subtitle={`#${counter}`}\r\n        sx={{\r\n          ...(!isActive &&\r\n            {\r\n              background: 'rgba(255, 255, 255, 0.5)',\r\n              [`& .MuiImageListItemBar-titleWrap`]: {\r\n                color: 'common.black'\r\n              }\r\n            }\r\n          )\r\n        }}\r\n      />\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Thumbnail;\r\n","import React, {\r\n  useMemo,\r\n  useEffect,\r\n  useCallback,\r\n  forwardRef,\r\n  useImperativeHandle\r\n} from 'react';\r\nimport './VirtualGrid.css';\r\nimport { useScrollAware } from './hooks';\r\n\r\nexport interface ItemProps {\r\n  index: number;\r\n}\r\n\r\ntype ScrollToBlock = 'center' | 'smart';\r\n\r\nexport interface VirtualGridRef {\r\n  scrollToIndex: (index: number, block?:  ScrollToBlock) => void;\r\n}\r\n\r\ninterface VirtualGridProps {\r\n  Item: React.FC<ItemProps>;\r\n  itemsCount: number;\r\n  height: number;\r\n  itemHeight: number;\r\n  rowsAhead: number;\r\n  rowGap?: number;\r\n  columnGap?: number;\r\n  width?: number;\r\n  itemWidth?: number;\r\n  className?: string;\r\n  scrollBar?: 'right' | 'left' | 'none',\r\n  scrollToIndex?: number;\r\n  onVisibleRows?: (rows: number[]) => void;\r\n  center?: boolean;\r\n}\r\n\r\nconst scrollBarWidth = 19;\r\n\r\nconst VirtualGrid = forwardRef<VirtualGridRef, VirtualGridProps>(\r\n  (props, scrollRef) => {\r\n  const {\r\n    Item,\r\n    height,\r\n    itemHeight,\r\n    itemsCount,\r\n    rowsAhead,\r\n    rowGap = 0,\r\n    columnGap = 0,\r\n    width,\r\n    itemWidth,\r\n    scrollBar = 'right',\r\n    scrollToIndex,\r\n    onVisibleRows,\r\n    center = false\r\n  } = props;\r\n\r\n  const className = 'VirtualGrid '.concat(\r\n    props.className ? `${props.className} ` : '',\r\n    `VirtualGrid--${scrollBar}`\r\n  );\r\n\r\n  const itemsInRow = (width && itemWidth && width > itemWidth) ?\r\n    Math.floor((width + columnGap - scrollBarWidth) /\r\n    (itemWidth + columnGap)) : 1;\r\n  const rowsCount = Math.ceil(itemsCount / itemsInRow);\r\n\r\n  const {\r\n    ref,\r\n    scrollTop\r\n  } = useScrollAware();\r\n\r\n  const indexToOffset = useCallback((index: number, block: ScrollToBlock) => {\r\n    const scrollToRow = index &&\r\n      Math.floor(index / itemsInRow);\r\n    let scrollOffset = 0;\r\n    if (block === 'smart') {\r\n      const scrollToRowTop = scrollToRow &&\r\n        Math.ceil(scrollToRow * (itemHeight + rowGap));\r\n      const scrollToRowBottom = scrollToRowTop + itemHeight;\r\n      const scrollBottom = scrollTop + height;\r\n\r\n      // console.log({scrollToRowTop, scrollBottom, height, itemHeight});\r\n\r\n      if (scrollToRowTop >= scrollTop && scrollToRowBottom <= scrollBottom) {\r\n        return scrollTop;\r\n      } else if (scrollToRowBottom > scrollTop && scrollToRowTop < scrollTop) {\r\n        scrollOffset = 0\r\n      } else if (scrollToRowTop < scrollBottom && scrollToRowBottom > scrollBottom) {\r\n        scrollOffset = height - itemHeight;\r\n      }\r\n    } else {\r\n      scrollOffset = Math.ceil(height / 2 - itemHeight / 2);\r\n    }\r\n    const scrollTo = index && scrollToRow &&\r\n      Math.ceil(scrollToRow * (itemHeight + rowGap)) -\r\n        scrollOffset;\r\n    return scrollTo;\r\n  }, [\r\n    rowGap,\r\n    height,\r\n    itemHeight,\r\n    itemsInRow,\r\n    scrollTop\r\n  ]);\r\n\r\n  const totalHeight = rowsCount * itemHeight +\r\n    (rowsCount - 1) * rowGap;\r\n\r\n  useImperativeHandle(scrollRef, () => ({\r\n    scrollToIndex(index: number, block = 'center') {\r\n      const scrollTo = indexToOffset(index, block);\r\n      if (ref.current) {\r\n        const div = ref.current;\r\n        div.scroll(0, scrollTo);\r\n      }\r\n    }\r\n  }), [\r\n    indexToOffset,\r\n    ref\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (ref.current) {\r\n      if (scrollToIndex !== undefined) {\r\n        const scrollTo = indexToOffset(scrollToIndex, 'center');\r\n        const div = ref.current;\r\n        div.scroll(0, scrollTo);\r\n      }\r\n    }\r\n  }, [\r\n    indexToOffset,\r\n    ref,\r\n    scrollToIndex\r\n  ]);\r\n\r\n  const startRow = Math.max(\r\n    0,\r\n    Math.floor(scrollTop / (itemHeight + rowGap)) - rowsAhead\r\n  );\r\n  const startItem = startRow * itemsInRow;\r\n\r\n  const visibleItemsCount = Math.min(\r\n    itemsCount - startItem,\r\n    (Math.ceil(height / (itemHeight + rowGap)) + 2 * rowsAhead)\r\n      * itemsInRow\r\n  );\r\n\r\n  const offsetY = startRow * (itemHeight + rowGap);\r\n\r\n  const firstVisibleRow = Math.floor(\r\n    (scrollTop) / (itemHeight + rowGap)\r\n  );\r\n  const lastVisibleRow = Math.floor(\r\n    (scrollTop + height) / (itemHeight + rowGap)\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (onVisibleRows) {\r\n      const visibleRows = [] as number[];\r\n      for (let i = firstVisibleRow; i <= lastVisibleRow; i++) {\r\n        visibleRows.push(i);\r\n      }\r\n      onVisibleRows(visibleRows);\r\n    }\r\n  }, [\r\n    firstVisibleRow,\r\n    lastVisibleRow,\r\n    onVisibleRows\r\n  ]);\r\n\r\n  const visibleItems = useMemo(() =>\r\n    (visibleItemsCount > 0) ?\r\n      new Array(visibleItemsCount)\r\n        .fill(null)\r\n        .map((_ , index) => (\r\n          <Item\r\n            key={index + startItem}\r\n            index={index + startItem}\r\n          />\r\n        )) :\r\n      []\r\n  ,[startItem, visibleItemsCount, Item]);\r\n\r\n  const columnWidth = itemWidth ? `${itemWidth}px` : '1fr';\r\n  const gridTemplateColumns = `repeat(${itemsInRow}, ${columnWidth})`;\r\n  const rowWidth = itemWidth &&\r\n    itemsInRow > 1 ?\r\n      itemsInRow * itemWidth + (itemsInRow - 1) * columnGap :\r\n      undefined;\r\n  const totalWidth = (width && itemWidth && width < itemWidth) ?\r\n    Math.max(width, itemWidth) : rowWidth;\r\n\r\n  return (\r\n    <div\r\n      className={className}\r\n      ref={ref}\r\n      style={{\r\n        height,\r\n        width\r\n      }}\r\n    >\r\n      <div\r\n        className={'VirtualGrid-area'}\r\n        style={{\r\n          height: totalHeight,\r\n          width: totalWidth\r\n        }}\r\n      >\r\n        <div\r\n          className={'VirtualGrid-visible'}\r\n          style={{\r\n            top: `${offsetY}px`,\r\n            gap: `${rowGap}px ${columnGap}px`,\r\n            gridTemplateColumns,\r\n            ...(center && {\r\n              justifyContent: 'center',\r\n              justifyItems: 'center'\r\n            })\r\n          }}\r\n        >\r\n          {visibleItems}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default VirtualGrid;\r\n","import React, {useMemo, useRef, useEffect} from 'react';\r\nimport { Box } from '@material-ui/core';\r\nimport { useRectSize } from './hooks';\r\nimport Thumbnail from './Thumbnail';\r\nimport VirtualGrid, { ItemProps, VirtualGridRef } from './VirtualGrid';\r\nimport {\r\n  SystemStyleObject\r\n} from '@material-ui/system';\r\n\r\ninterface ThumbnailsProps {\r\n  files?: any[];\r\n  fileId?: string;\r\n  onSelect: (fileId: string) => void;\r\n  onVisibleFiles?: (indices: number[]) => void;\r\n  sx?: SystemStyleObject;\r\n};\r\n\r\nconst Thumbnails: React.FC<ThumbnailsProps> = (props) => {\r\n  const {\r\n    files = [],\r\n    fileId,\r\n    onSelect,\r\n    onVisibleFiles,\r\n    sx\r\n  } = props;\r\n\r\n  const virtualGridRef = useRef<VirtualGridRef>(null);\r\n  const scrollIndexRef = useRef(0);\r\n\r\n  const Item = useMemo(() => {\r\n    return ({index}: ItemProps) => {\r\n      const file = files[index];\r\n      const isActive = fileId === file.id;\r\n\r\n      return (\r\n        <Thumbnail\r\n          file={file}\r\n          counter={index + 1}\r\n          isActive={isActive}\r\n          onClick={() => {\r\n            if (virtualGridRef.current) {\r\n              scrollIndexRef.current = index;\r\n              virtualGridRef.current.scrollToIndex(index, 'smart');\r\n            }\r\n            onSelect(file.id);\r\n          }}\r\n        />\r\n      );\r\n    };\r\n  }, [\r\n    files,\r\n    fileId,\r\n    onSelect\r\n  ]);\r\n\r\n  const { ref, rectSize } = useRectSize();\r\n  const activeIndex = useMemo(() => {\r\n    if (fileId && files && files.length > 0) {\r\n      return files.findIndex(file => file.id === fileId);\r\n    } else {\r\n      return -1;\r\n    }\r\n  }, [\r\n    fileId,\r\n    files\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (virtualGridRef.current && activeIndex !== scrollIndexRef.current) {\r\n      scrollIndexRef.current = activeIndex;\r\n      virtualGridRef.current.scrollToIndex(activeIndex);\r\n    }\r\n  }, [\r\n    activeIndex\r\n  ]);\r\n\r\n  return (\r\n    <Box\r\n      ref={ref}\r\n      sx={{\r\n        ...sx,\r\n        overflow: 'hidden'\r\n      }}\r\n    >\r\n      {(files.length > 0 && rectSize.height > 0) &&\r\n        <VirtualGrid\r\n          Item={Item}\r\n          height={rectSize.height}\r\n          itemHeight={220}\r\n          itemsCount={files.length}\r\n          rowsAhead={3}\r\n          center\r\n          rowGap={4}\r\n          ref={virtualGridRef}\r\n          onVisibleRows={onVisibleFiles}\r\n        />\r\n      }\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Thumbnails;","import React, {\r\n  useMemo,\r\n  useEffect,\r\n  forwardRef,\r\n  useImperativeHandle,\r\n  useCallback,\r\n  useState\r\n} from 'react';\r\nimport {\r\n  SystemStyleObject,\r\n  styled\r\n} from '@material-ui/system';\r\nimport {\r\n  Box,\r\n  Menu,\r\n  MenuItem,\r\n  ListItemIcon,\r\n  ListItemText\r\n} from '@material-ui/core';\r\nimport { useScrollActions } from './hooks';\r\nimport { FitMode } from '../../App';\r\nimport { useFullScreen } from '../../lib/hooks';\r\nimport FullscreenEnterIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport FitBestIcon from '@material-ui/icons/CropDin';\r\nimport FitWidthIcon from '@material-ui/icons/CropPortrait';\r\nimport FitHeightIcon from '@material-ui/icons/CropLandscape';\r\nimport FitOriginalIcon from '@material-ui/icons/CropOriginal';\r\nimport StartSlideshowIcon from '@material-ui/icons/PlayArrow';\r\nimport EndSlideshowIcon from '@material-ui/icons/Pause';\r\n\r\nconst wheelCount = 3;\r\nconst slideShowInterval = 5000;\r\n\r\nexport interface ViewerRef {\r\n  toggleFullscreen: () => void;\r\n}\r\n\r\ninterface ViewerProps {\r\n  fitMode: FitMode;\r\n  files: any[];\r\n  onNextImage: () => void;\r\n  onPrevImage: () => void;\r\n  onFitModeChange: (fitMode: FitMode) => void;\r\n  sx?: SystemStyleObject;\r\n  isScrollToBottom?: boolean;\r\n  isSlideshowEnabled?: boolean;\r\n  isSlideshowPlaying?: boolean;\r\n  onToggleSlideshowPlaying: () => void;\r\n};\r\n\r\ninterface Point {\r\n  x: number;\r\n  y: number;\r\n};\r\n\r\nconst Img = styled('img')({});\r\n\r\nconst Viewer = forwardRef<ViewerRef, ViewerProps>(\r\n  (props, viewerRef) => {\r\n  const {\r\n    fitMode,\r\n    files,\r\n    onNextImage,\r\n    onPrevImage,\r\n    onFitModeChange,\r\n    sx,\r\n    isScrollToBottom,\r\n    isSlideshowEnabled,\r\n    isSlideshowPlaying,\r\n    onToggleSlideshowPlaying\r\n  } = props;\r\n\r\n  const [ contextMenu, setContextMenu ] = useState<Point | null>(null);\r\n\r\n  const {\r\n    ref,\r\n    scrollToTop,\r\n    scrollToBottom,\r\n    scrollNextSlide\r\n  } = useScrollActions({\r\n    wheelCount,\r\n    onScrollOverTop: onPrevImage,\r\n    onScrollBelowBottom: onNextImage\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (isSlideshowPlaying) {\r\n      const timer = setInterval(scrollNextSlide, slideShowInterval);\r\n      return () => {\r\n        clearInterval(timer);\r\n      };\r\n    }\r\n  }, [\r\n    isSlideshowPlaying,\r\n    scrollNextSlide\r\n  ]);\r\n\r\n  const activeFileId = useMemo(() => {\r\n    return (files.length > 0) ?\r\n      files[0].id as string :\r\n      '';\r\n  }, [\r\n    files\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (activeFileId && ref.current) {\r\n      if (isScrollToBottom) {\r\n        scrollToBottom();\r\n      } else {\r\n        scrollToTop()\r\n      }\r\n    }\r\n  }, [\r\n    activeFileId,\r\n    ref,\r\n    scrollToTop,\r\n    isScrollToBottom,\r\n    scrollToBottom\r\n  ]);\r\n  \r\n  const {\r\n    isEnabled,\r\n    isFullscreen,\r\n    toggleFullScreen\r\n  } = useFullScreen();\r\n  useImperativeHandle(viewerRef, () => ({\r\n    toggleFullscreen() {\r\n      if (isEnabled) {\r\n        toggleFullScreen(ref.current);\r\n      }\r\n    }\r\n  }), [\r\n    ref,\r\n    isEnabled,\r\n    toggleFullScreen\r\n  ]);\r\n\r\n  const onContextMenu = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\r\n    e.preventDefault();\r\n    setContextMenu(\r\n      prev => !prev ?\r\n        {\r\n          x: e.clientX - 2,\r\n          y: e.clientY - 4\r\n        } :\r\n        null\r\n    );\r\n  }, []);\r\n\r\n  const onClose = useCallback(() => {\r\n    setContextMenu(null);\r\n  }, []);\r\n\r\n  const onClickFullscreen = useCallback(() => {\r\n    if (isEnabled) {\r\n      toggleFullScreen(ref.current);\r\n    }\r\n    onClose();\r\n  }, [\r\n    isEnabled,\r\n    ref,\r\n    toggleFullScreen,\r\n    onClose\r\n  ]);\r\n\r\n  const onClickFitBest = useCallback(() => {\r\n    onFitModeChange(FitMode.Best);\r\n    onClose();\r\n  }, [\r\n    onFitModeChange,\r\n    onClose\r\n  ]);\r\n  const onClickFitWidth = useCallback(() => {\r\n    onFitModeChange(FitMode.Width);\r\n    onClose();\r\n  }, [\r\n    onFitModeChange,\r\n    onClose\r\n  ]);\r\n  const onClickFitHeight = useCallback(() => {\r\n    onFitModeChange(FitMode.Height);\r\n    onClose();\r\n  }, [\r\n    onFitModeChange,\r\n    onClose\r\n  ]);\r\n  const onClickFitOriginal = useCallback(() => {\r\n    onFitModeChange(FitMode.Original);\r\n    onClose();\r\n  }, [\r\n    onFitModeChange,\r\n    onClose\r\n  ]);\r\n  const onClickSlideshow = useCallback(() => {\r\n    onToggleSlideshowPlaying();\r\n    onClose();\r\n  }, [\r\n    onToggleSlideshowPlaying,\r\n    onClose\r\n  ]);\r\n\r\n  return (\r\n    <Box sx={{\r\n      ...sx,\r\n      position: 'relative'\r\n    }}>\r\n      <Box\r\n        component='div'\r\n        onContextMenu={onContextMenu}\r\n        sx={{\r\n          textAlign: 'center',\r\n          position: 'absolute',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          overflow: 'auto',\r\n          whiteSpace: 'nowrap',\r\n          ...(files.length > 0 && {\r\n            bgcolor: 'common.black'\r\n          })\r\n        }}\r\n        ref={ref}\r\n      >\r\n        <Box\r\n          component='span'\r\n          sx={{\r\n            height: '100%',\r\n            verticalAlign: 'middle',\r\n            display: 'inline-block'\r\n          }}\r\n        />\r\n        {files.map((file, i) => (\r\n          <Img\r\n            key={file.id}\r\n            src={file.webContentLink}\r\n            alt={file.name}\r\n            sx={i === 0 ?\r\n              {\r\n                verticalAlign: 'middle',\r\n                ...(fitMode === FitMode.Best && {\r\n                  maxWidth: '100%',\r\n                  maxHeight: '100%'\r\n                }),\r\n                ...(fitMode === FitMode.Width && {\r\n                  maxWidth: '100%'\r\n                }),\r\n                ...(fitMode === FitMode.Height && {\r\n                  maxHeight: '100%'\r\n                })\r\n              } : {\r\n                display: 'none'\r\n              }\r\n            }\r\n            onClick={onNextImage}\r\n            // onLoad={i === 0 ? onImageLoad : undefined}\r\n          />\r\n        ))}\r\n        <Menu\r\n          container={ref.current}\r\n          disableScrollLock={true}\r\n          open={!!contextMenu}\r\n          onClose={onClose}\r\n          anchorReference='anchorPosition'\r\n          anchorPosition={!!contextMenu ?\r\n            {\r\n              top: contextMenu.y,\r\n              left: contextMenu.x\r\n            } :\r\n            undefined\r\n          }\r\n        >\r\n          {isEnabled &&\r\n            <MenuItem\r\n              onClick={onClickFullscreen}\r\n            >\r\n              <ListItemIcon>\r\n                {isFullscreen ?\r\n                  <FullscreenExitIcon /> :\r\n                  <FullscreenEnterIcon />\r\n                }\r\n              </ListItemIcon>\r\n              <ListItemText>\r\n                {isFullscreen ?\r\n                  'Exit Fullscreen' :\r\n                  'Enter Fullscreen'\r\n                }\r\n              </ListItemText>\r\n            </MenuItem>\r\n          }\r\n          {isSlideshowEnabled &&\r\n            <MenuItem\r\n              onClick={onClickSlideshow}\r\n            >\r\n              <ListItemIcon>\r\n                {isSlideshowPlaying ?\r\n                  <EndSlideshowIcon/> :\r\n                  <StartSlideshowIcon/>\r\n                }\r\n              </ListItemIcon>\r\n              <ListItemText>\r\n                {isSlideshowPlaying ?\r\n                  'End Slideshow' :\r\n                  'Start Slideshow'\r\n                }\r\n              </ListItemText>\r\n            </MenuItem>\r\n          }\r\n          <MenuItem\r\n            onClick={onClickFitBest}\r\n          >\r\n            <ListItemIcon>\r\n              <FitBestIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Best Fit'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n          <MenuItem\r\n            onClick={onClickFitWidth}\r\n          >\r\n            <ListItemIcon>\r\n              <FitWidthIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Fit Width'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n          <MenuItem\r\n            onClick={onClickFitHeight}\r\n          >\r\n            <ListItemIcon>\r\n              <FitHeightIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Fit Height'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n          <MenuItem\r\n            onClick={onClickFitOriginal}\r\n          >\r\n            <ListItemIcon>\r\n              <FitOriginalIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Original Size'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        </Menu>\r\n      </Box>\r\n    </Box>\r\n  );\r\n});\r\n\r\nexport default Viewer;\r\n","import {\r\n  useEffect,\r\n  useRef,\r\n  useCallback\r\n} from 'react';\r\n\r\ninterface ScrollActionsOptions {\r\n  wheelCount?: number;\r\n  onScrollOverTop?: () => void;\r\n  onScrollBelowBottom?: () => void;\r\n};\r\n\r\nconst useScrollActions = (options: ScrollActionsOptions) => {\r\n  const {\r\n    wheelCount = 3,\r\n    onScrollOverTop,\r\n    onScrollBelowBottom\r\n  } = options;\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  const scrollTopRef = useRef(0);\r\n  const scrollOverTopCountRef = useRef(0);\r\n  const scrollBelowBottomCountRef = useRef(0);\r\n\r\n  const scrollToTop = useCallback(() => {\r\n    if (ref.current) {\r\n      const div = ref.current;\r\n      div.scroll(0, 0);\r\n    }\r\n  }, []);\r\n\r\n  const scrollToBottom = useCallback(() => {\r\n    if (ref.current) {\r\n      const div = ref.current;\r\n      div.scroll(0, div.scrollHeight);\r\n    }\r\n  }, []);\r\n\r\n  const scrollNextSlide = useCallback(() => {\r\n    if (ref.current) {\r\n      const div = ref.current;\r\n      const scrollHeight = div.scrollHeight - div.offsetHeight;\r\n      if (scrollTopRef.current >= scrollHeight && onScrollBelowBottom) {\r\n        onScrollBelowBottom();\r\n      } else {\r\n        const slideSize = Math.max(div.offsetHeight - 50, 50);\r\n        div.scroll(0, scrollTopRef.current + slideSize);\r\n      }\r\n    }\r\n  }, [\r\n    onScrollBelowBottom\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const scrollContainer = ref.current;\r\n    if (!scrollContainer) {\r\n      return;\r\n    }\r\n\r\n    const onScroll = (e: Event) => {\r\n      requestAnimationFrame(() => {\r\n        const div = e.target as HTMLDivElement;\r\n        if (div) {\r\n          scrollTopRef.current = +div.scrollTop;\r\n        }\r\n      });\r\n    };\r\n\r\n    scrollContainer.addEventListener('scroll', onScroll);\r\n    return () => scrollContainer.removeEventListener('scroll', onScroll);\r\n  }, [\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const scrollContainer = ref.current;\r\n    if (!scrollContainer) {\r\n      return;\r\n    }\r\n\r\n    const onWheel = (e: WheelEvent) => {\r\n      const div = ref.current;\r\n      if (div) {\r\n        const scrollHeight = div.scrollHeight - div.offsetHeight;\r\n        if (e.deltaY < 0) {\r\n          scrollBelowBottomCountRef.current = 0;\r\n          if (scrollTopRef.current <= 0) {\r\n            scrollOverTopCountRef.current += 1;\r\n          }\r\n          if (onScrollOverTop) {\r\n            if (\r\n              scrollHeight <= 0 ||\r\n              scrollOverTopCountRef.current >= wheelCount\r\n            ) {\r\n              scrollOverTopCountRef.current = 0;\r\n              onScrollOverTop();\r\n            }\r\n          }\r\n        }\r\n        if (e.deltaY > 0) {\r\n          scrollOverTopCountRef.current = 0;\r\n          if (scrollTopRef.current >= scrollHeight) {\r\n            scrollBelowBottomCountRef.current += 1;\r\n          }\r\n          if (onScrollBelowBottom) {\r\n            if (\r\n              scrollHeight <= 0 ||\r\n              scrollBelowBottomCountRef.current >= wheelCount\r\n            ) {\r\n              scrollBelowBottomCountRef.current = 0;\r\n              onScrollBelowBottom();\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    scrollContainer.addEventListener('wheel', onWheel);\r\n    return () => scrollContainer.removeEventListener('wheel', onWheel);\r\n  }, [\r\n    wheelCount,\r\n    onScrollOverTop,\r\n    onScrollBelowBottom\r\n  ]);\r\n\r\n  return {\r\n    ref,\r\n    scrollToTop,\r\n    scrollToBottom,\r\n    scrollNextSlide\r\n  };\r\n};\r\n\r\nexport {\r\n  useScrollActions\r\n}\r\n","import { SvgIcon } from '@material-ui/core';\r\nimport React from 'react';\r\n\r\nconst GoogleIcon: React.FC = () => {\r\n  return (\r\n    <SvgIcon\r\n      fontSize={'small'}\r\n    >\r\n      <g transform=\"matrix(1, 0, 0, 1, 27.009001, -39.238998)\">\r\n        <path fill=\"#4285F4\" d=\"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z\"/>\r\n        <path fill=\"#34A853\" d=\"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z\"/>\r\n        <path fill=\"#FBBC05\" d=\"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.724 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z\"/>\r\n        <path fill=\"#EA4335\" d=\"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.789 L -6.734 42.369 C -8.804 40.429 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z\"/>\r\n      </g>\r\n    </SvgIcon>\r\n  );\r\n};\r\n\r\nexport default GoogleIcon;\r\n","import React, {\r\n  useRef,\r\n  useEffect,\r\n  useState\r\n} from 'react';\r\nimport {\r\n  Tooltip,\r\n  Typography\r\n} from '@material-ui/core';\r\nimport {\r\n  SystemStyleObject\r\n} from '@material-ui/system'\r\n\r\ninterface TitleTooltipProps {\r\n  text: string;\r\n  sx?: SystemStyleObject;\r\n};\r\n\r\nconst TitleTooltip: React.FC<TitleTooltipProps> = (props) => {\r\n  const {\r\n    text,\r\n    sx\r\n  } = props;\r\n\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  const [ isOverflow, setOverflow ] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const div = ref.current;\r\n    const check = () => {\r\n      if (div) {\r\n        const isOverflow = div.scrollWidth > div.offsetWidth;\r\n        setOverflow(isOverflow);\r\n      }\r\n    };\r\n    if (div && text) {\r\n      check();\r\n    } else {\r\n      setOverflow(false);\r\n    }\r\n  }, [\r\n    text\r\n  ]);\r\n\r\n  return (\r\n    <Tooltip\r\n      title={text}\r\n      disableHoverListener={!isOverflow}\r\n    >\r\n      <Typography\r\n        variant='h6'\r\n        component='div'\r\n        noWrap\r\n        sx={sx}\r\n        ref={ref}\r\n      >\r\n        <span>\r\n          {text}\r\n        </span>\r\n      </Typography>\r\n    </Tooltip>\r\n  );\r\n};\r\n\r\nexport default TitleTooltip;","import React, {\r\n  useState,\r\n  useRef,\r\n  useCallback,\r\n} from 'react';\r\nimport {\r\n  Box,\r\n  Toolbar,\r\n  Typography,\r\n  IconButton,\r\n  Menu,\r\n  MenuItem,\r\n  ToggleButtonGroup,\r\n  Tooltip,\r\n  ToggleButton,\r\n  ListItemIcon,\r\n  ListItemText,\r\n  Avatar,\r\n  Divider,\r\n} from '@material-ui/core';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport FitBestIcon from '@material-ui/icons/CropDin';\r\nimport FitWidthIcon from '@material-ui/icons/CropPortrait';\r\nimport FitHeightIcon from '@material-ui/icons/CropLandscape';\r\nimport FitOriginalIcon from '@material-ui/icons/CropOriginal';\r\nimport FullscreenEnterIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport FirstImageIcon from '@material-ui/icons/FirstPage';\r\nimport LastImageIcon from '@material-ui/icons/LastPage';\r\nimport PrevImageIcon from '@material-ui/icons/NavigateBefore';\r\nimport NextImageIcon from '@material-ui/icons/NavigateNext';\r\nimport StartSlideshowIcon from '@material-ui/icons/PlayArrow';\r\nimport EndSlideshowIcon from '@material-ui/icons/Pause';\r\nimport OpenFileIcon from '@material-ui/icons/InsertDriveFile';\r\nimport RecentFilesIcon from '@material-ui/icons/History';\r\nimport DownloadFileIcon from '@material-ui/icons/FileDownload';\r\nimport CloseFileIcon from '@material-ui/icons/Close';\r\nimport HelpIcon from '@material-ui/icons/HelpOutline';\r\nimport PolicyIcon from '@material-ui/icons/Policy';\r\nimport TermsIcon from '@material-ui/icons/Gavel';\r\nimport SignOutIcon from '@material-ui/icons/Logout';\r\nimport GoogleIcon from './GoogleIcon';\r\nimport CookiesErrorIcon from '@material-ui/icons/VisibilityOff';\r\nimport HideDrawerIcon from '@material-ui/icons/ArrowLeft';\r\nimport ShowDrawerIcon from '@material-ui/icons/ArrowRight';\r\nimport { FitMode } from '../../App';\r\nimport { RecentFile, useFullScreen, useIsSignedIn } from '../../lib/hooks';\r\nimport {\r\n  pickFile\r\n} from '../../lib/api';\r\nimport TitleTooltip from './TitleTooltip';\r\n\r\ninterface TopbarProps {\r\n  title: string;\r\n  counterTitle: string;\r\n  fitMode: FitMode;\r\n  onFitModeChange: (fitMode: FitMode) => void;\r\n  onOpenFile: (file: any) => void;\r\n  fullscreenButtonActive?: boolean;\r\n  onToggleFullscreen: () => void;\r\n  isFirstImageEnabled?: boolean;\r\n  isPrevImageEnabled?: boolean;\r\n  isNextImageEnabled?: boolean;\r\n  isLastImageEnabled?: boolean;\r\n  isSlideshowEnabled?: boolean;\r\n  isSlideshowPlaying?: boolean;\r\n  onToggleSlideshowPlaying: () => void;\r\n  onFirstImage: () => void;\r\n  onPrevImage: () => void;\r\n  onNextImage: () => void;\r\n  onLastImage: () => void;\r\n  recentFiles: RecentFile[];\r\n  onDownloadFile: () => void;\r\n  onCloseFile: () => void;\r\n  onSignOut: () => void;\r\n  isMobileDrawerOpen: boolean;\r\n  toggleMobileDrawer: () => void;\r\n};\r\n\r\nconst Topbar: React.FC<TopbarProps> = (props) => {\r\n  const {\r\n    title,\r\n    counterTitle,\r\n    fitMode,\r\n    onFitModeChange,\r\n    onOpenFile,\r\n    fullscreenButtonActive,\r\n    onToggleFullscreen,\r\n    isFirstImageEnabled,\r\n    isPrevImageEnabled,\r\n    isNextImageEnabled,\r\n    isLastImageEnabled,\r\n    isSlideshowEnabled,\r\n    isSlideshowPlaying,\r\n    onToggleSlideshowPlaying,\r\n    onFirstImage,\r\n    onPrevImage,\r\n    onNextImage,\r\n    onLastImage,\r\n    recentFiles,\r\n    onDownloadFile,\r\n    onCloseFile,\r\n    onSignOut,\r\n    isMobileDrawerOpen,\r\n    toggleMobileDrawer\r\n  } = props;\r\n  const [ isMenuOpen, setMenuOpen ] = useState(false);\r\n  const menuRef = useRef<HTMLButtonElement>(null);\r\n  const [ isRecentMenuOpen, setRecentMenuOpen ] = useState(false);\r\n  const recentMenuRef = useRef<HTMLLIElement>(null);\r\n  const [ isHelpMenuOpen, setHelpMenuOpen ] = useState(false);\r\n  const helpMenuRef = useRef<HTMLButtonElement>(null);\r\n  const [ isProfileMenuOpen, setProfileMenuOpen ] = useState(false);\r\n  const profileMenuRef = useRef<HTMLButtonElement>(null);\r\n  const {\r\n    isEnabled: isFullscreenEnabled,\r\n    isFullscreen\r\n  } = useFullScreen();\r\n\r\n  const {\r\n    isSignedIn,\r\n    toggleSignedIn,\r\n    profile,\r\n    isCookiesError\r\n  } = useIsSignedIn(onSignOut);\r\n\r\n  const handleMenuClose = useCallback(() => {\r\n    setMenuOpen(false);\r\n  }, []);\r\n  const handleMenuClick = useCallback(() => {\r\n    setMenuOpen(current => !current);\r\n  }, []);\r\n  const onOpenClick = useCallback(async () => {\r\n    handleMenuClose();\r\n    const doc = await pickFile();\r\n    if (doc) {\r\n      onOpenFile(doc);\r\n    }\r\n  }, [\r\n    handleMenuClose,\r\n    onOpenFile\r\n  ]);\r\n  const onDrawerClick = useCallback(() => {\r\n    toggleMobileDrawer();\r\n    handleMenuClose();\r\n  }, [\r\n    toggleMobileDrawer,\r\n    handleMenuClose\r\n  ]);\r\n  const onDownloadClick = useCallback(() => {\r\n    onDownloadFile();\r\n    handleMenuClose();\r\n  }, [\r\n    handleMenuClose,\r\n    onDownloadFile\r\n  ]);\r\n  const onCloseClick = useCallback(() => {\r\n    onCloseFile();\r\n    handleMenuClose();\r\n  }, [\r\n    onCloseFile,\r\n    handleMenuClose\r\n  ]);\r\n  const handleRecentMenuClose = useCallback(() => {\r\n    setRecentMenuOpen(false);\r\n  }, []);\r\n  const handleRecentMenuClick = useCallback(() => {\r\n    setRecentMenuOpen(current => !current);\r\n  }, []);\r\n  const onRecentFileClick = useCallback((recentFile: RecentFile) => {\r\n    handleRecentMenuClose();\r\n    handleMenuClose();\r\n    onOpenFile(recentFile);\r\n  }, [\r\n    handleRecentMenuClose,\r\n    handleMenuClose,\r\n    onOpenFile\r\n  ]);\r\n  const handleHelpMenuClose = useCallback(() => {\r\n    setHelpMenuOpen(false);\r\n  }, []);\r\n  const handleHelpMenuClick = useCallback(() => {\r\n    setHelpMenuOpen(current => !current);\r\n  }, []);\r\n  const handleProfileMenuClose = useCallback(() => {\r\n    setProfileMenuOpen(false);\r\n  }, []);\r\n  const handleProfileMenuClick = useCallback(() => {\r\n    setProfileMenuOpen(current => !current);\r\n  }, []);\r\n  const onSignOutClick = useCallback(() => {\r\n    handleProfileMenuClose();\r\n    toggleSignedIn();\r\n  }, [\r\n    handleProfileMenuClose,\r\n    toggleSignedIn\r\n  ]);\r\n\r\n  return (\r\n    <Toolbar>\r\n      <IconButton\r\n        size='large'\r\n        edge='start'\r\n        color='inherit'\r\n        aria-label='menu'\r\n        sx={{ mr: 2 }}\r\n        ref={menuRef}\r\n        onClick={handleMenuClick}\r\n      >\r\n        <MenuIcon />\r\n      </IconButton>\r\n      <Menu\r\n        anchorEl={menuRef.current}\r\n        open={isMenuOpen}\r\n        onClose={handleMenuClose}\r\n      >\r\n        <MenuItem\r\n          onClick={onDrawerClick}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            {isMobileDrawerOpen ?\r\n              <HideDrawerIcon/> :\r\n              <ShowDrawerIcon/>\r\n            }\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {isMobileDrawerOpen ?\r\n              'Hide Thumbnails' :\r\n              'Show Thumbnails'\r\n            }\r\n          </ListItemText>\r\n        </MenuItem>\r\n        {!isSignedIn &&\r\n          <MenuItem\r\n            onClick={toggleSignedIn}\r\n          >\r\n            <ListItemIcon>\r\n              <GoogleIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Sign in with Google'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        }\r\n        {isSignedIn &&\r\n          <MenuItem\r\n            onClick={onOpenClick}\r\n          >\r\n            <ListItemIcon>\r\n              <OpenFileIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Open File'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        }\r\n        {isSignedIn &&\r\n          <MenuItem\r\n            onClick={handleRecentMenuClick}\r\n            disabled={recentFiles.length === 0}\r\n            ref={recentMenuRef}\r\n          >\r\n            <ListItemIcon>\r\n              <RecentFilesIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Recent Files'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        }\r\n        {fullscreenButtonActive &&\r\n          <MenuItem\r\n            onClick={onDownloadClick}\r\n          >\r\n            <ListItemIcon>\r\n              <DownloadFileIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Download File'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        }\r\n        {fullscreenButtonActive &&\r\n          <MenuItem\r\n            onClick={onCloseClick}\r\n          >\r\n            <ListItemIcon>\r\n              <CloseFileIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Close File'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        }\r\n        <Divider\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        />\r\n        <MenuItem\r\n          disabled={!fullscreenButtonActive}\r\n          onClick={() => {\r\n            onFirstImage();\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <FirstImageIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'First Image'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          disabled={!fullscreenButtonActive}\r\n          onClick={() => {\r\n            onToggleSlideshowPlaying();\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            {isSlideshowPlaying ?\r\n              <EndSlideshowIcon/> :\r\n              <StartSlideshowIcon/>\r\n            }\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {isSlideshowPlaying ?\r\n              'End Slideshow' :\r\n              'Start Slideshow'\r\n            }\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          disabled={!fullscreenButtonActive}\r\n          onClick={() => {\r\n            onLastImage();\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <LastImageIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Last Image'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <Divider\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        />\r\n        <MenuItem\r\n          onClick={() => {\r\n            onFitModeChange(FitMode.Best);\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' },\r\n            backgroundColor: fitMode === FitMode.Best ?\r\n              'rgba(0, 0, 0, 0.08)' : undefined\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <FitBestIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Best Fit'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          onClick={() => {\r\n            onFitModeChange(FitMode.Width);\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' },\r\n            backgroundColor: fitMode === FitMode.Width ?\r\n              'rgba(0, 0, 0, 0.08)' : undefined\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <FitWidthIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Fit Width'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          onClick={() => {\r\n            onFitModeChange(FitMode.Height);\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' },\r\n            backgroundColor: fitMode === FitMode.Height ?\r\n              'rgba(0, 0, 0, 0.08)' : undefined\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <FitHeightIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Fit Height'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          onClick={() => {\r\n            onFitModeChange(FitMode.Original);\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' },\r\n            backgroundColor: fitMode === FitMode.Original ?\r\n              'rgba(0, 0, 0, 0.08)' : undefined\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <FitOriginalIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Original Size'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <Divider\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        />\r\n        <MenuItem\r\n          disabled={!fullscreenButtonActive}\r\n          onClick={() => {\r\n            onToggleFullscreen();\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            {isFullscreen ?\r\n              <FullscreenExitIcon /> :\r\n              <FullscreenEnterIcon/>\r\n            }\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {isFullscreen ?\r\n              'Exit Fullscreen' :\r\n              'Enter Fullscreen'\r\n            }\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </Menu>\r\n      <Menu\r\n        anchorEl={recentMenuRef.current}\r\n        open={isRecentMenuOpen}\r\n        onClose={handleRecentMenuClose}\r\n        PaperProps={{\r\n          sx: {\r\n            maxWidth: '400px'\r\n          }\r\n        }}\r\n        anchorOrigin={{\r\n          vertical: 'top',\r\n          horizontal: 'right'\r\n        }}\r\n      >\r\n        {recentFiles.map((recentFile, i) => (\r\n          <MenuItem\r\n            key={i}\r\n            onClick={() => onRecentFileClick(recentFile)}\r\n          >\r\n            <Typography\r\n              noWrap\r\n            >\r\n              {recentFile.title}\r\n            </Typography>\r\n          </MenuItem>\r\n        ))}\r\n      </Menu>\r\n      <TitleTooltip\r\n        text={title}\r\n        sx={{\r\n          flexGrow: 1\r\n        }}\r\n      />\r\n      {!!counterTitle &&\r\n        <Box\r\n          sx={{\r\n            m: 1\r\n          }}\r\n        >\r\n          <Typography variant='body1' noWrap>\r\n            {counterTitle}\r\n          </Typography>\r\n        </Box>\r\n      }\r\n      <Tooltip\r\n        title='First Image (Home)'\r\n      >\r\n        <Box\r\n          sx={{\r\n            display: { xs: 'none', md: 'block' }\r\n          }}\r\n        >\r\n          <IconButton\r\n            size='large'\r\n            color='inherit'\r\n            aria-label='first-image'\r\n            disabled={!isFirstImageEnabled}\r\n            onClick={onFirstImage}\r\n          >\r\n            <FirstImageIcon/>\r\n          </IconButton>\r\n        </Box>\r\n      </Tooltip>\r\n      <Tooltip\r\n        title='Previous Image (Left Arrow)'\r\n      >\r\n        <Box>\r\n          <IconButton\r\n            size='large'\r\n            color='inherit'\r\n            aria-label='prev-image'\r\n            disabled={!isPrevImageEnabled}\r\n            onClick={onPrevImage}\r\n            sx={{\r\n              p: { xs: '6px', md: '12px'}\r\n            }}\r\n          >\r\n            <PrevImageIcon/>\r\n          </IconButton>\r\n        </Box>\r\n      </Tooltip>\r\n      <Tooltip\r\n        title={isSlideshowPlaying ?\r\n          'End Slideshow (Space)' :\r\n          'Start Slideshow (Space)'\r\n        }\r\n      >\r\n        <Box\r\n          sx={{\r\n            display: { xs: 'none', md: 'block' }\r\n          }}\r\n        >\r\n          <IconButton\r\n            size='large'\r\n            color='inherit'\r\n            aria-label='next-image'\r\n            disabled={!isSlideshowEnabled}\r\n            onClick={onToggleSlideshowPlaying}\r\n          >\r\n            {isSlideshowPlaying ?\r\n              <EndSlideshowIcon/> :\r\n              <StartSlideshowIcon/>\r\n            }\r\n          </IconButton>\r\n        </Box>\r\n      </Tooltip>\r\n      <Tooltip\r\n        title='Next Image (Right Arrow, Scroll Below, Click)'\r\n      >\r\n        <Box>\r\n          <IconButton\r\n            size='large'\r\n            color='inherit'\r\n            aria-label='next-image'\r\n            disabled={!isNextImageEnabled}\r\n            onClick={onNextImage}\r\n            sx={{\r\n              p: { xs: '6px', md: '12px'}\r\n            }}\r\n          >\r\n            <NextImageIcon/>\r\n          </IconButton>\r\n        </Box>\r\n      </Tooltip>\r\n      <Tooltip\r\n        title='Last Image (End)'\r\n      >\r\n        <Box\r\n          sx={{\r\n            display: { xs: 'none', md: 'block' }\r\n          }}\r\n        >\r\n          <IconButton\r\n            size='large'\r\n            color='inherit'\r\n            aria-label='last-image'\r\n            disabled={!isLastImageEnabled}\r\n            onClick={onLastImage}\r\n          >\r\n            <LastImageIcon/>\r\n          </IconButton>\r\n        </Box>\r\n      </Tooltip>\r\n      <ToggleButtonGroup\r\n        value={fitMode}\r\n        exclusive\r\n        onChange={(e, value) => onFitModeChange(value)}\r\n        sx={{\r\n          display: { xs: 'none', md: 'flex' }\r\n        }}\r\n      >\r\n        <ToggleButton\r\n          value={FitMode.Best}\r\n          aria-label='best-fit'\r\n          sx={{\r\n            p: 0\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title='Best Fit'\r\n          >\r\n            <Box\r\n              sx={{\r\n                height: 'min-content',\r\n                width: 'min-content',\r\n                p: '11px',\r\n                display: 'grid',\r\n                alignContent: 'center',\r\n                justifyContent: 'center'\r\n              }}\r\n            >\r\n              <FitBestIcon/>\r\n            </Box>\r\n          </Tooltip>\r\n        </ToggleButton>\r\n        <ToggleButton\r\n          value={FitMode.Width}\r\n          aria-label='fit-width'\r\n          sx={{\r\n            p: 0\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title='Fit Width'\r\n          >\r\n            <Box\r\n              sx={{\r\n                height: 'min-content',\r\n                width: 'min-content',\r\n                p: '11px',\r\n                display: 'grid',\r\n                alignContent: 'center',\r\n                justifyContent: 'center'\r\n              }}\r\n            >\r\n              <FitWidthIcon/>\r\n            </Box>\r\n          </Tooltip>\r\n        </ToggleButton>\r\n        <ToggleButton\r\n          value={FitMode.Height}\r\n          aria-label='fit-height'\r\n          sx={{\r\n            p: 0\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title='Fit Height'\r\n          >\r\n            <Box\r\n              sx={{\r\n                height: 'min-content',\r\n                width: 'min-content',\r\n                p: '11px',\r\n                display: 'grid',\r\n                alignContent: 'center',\r\n                justifyContent: 'center'\r\n              }}\r\n            >\r\n              <FitHeightIcon/>\r\n            </Box>\r\n          </Tooltip>\r\n        </ToggleButton>\r\n        <ToggleButton\r\n          value={FitMode.Original}\r\n          aria-label='fit-original'\r\n          sx={{\r\n            p: 0\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title='Original Size'\r\n          >\r\n            <Box\r\n              sx={{\r\n                height: 'min-content',\r\n                width: 'min-content',\r\n                p: '11px',\r\n                display: 'grid',\r\n                alignContent: 'center',\r\n                justifyContent: 'center'\r\n              }}\r\n            >\r\n              <FitOriginalIcon/>\r\n            </Box>\r\n          </Tooltip>\r\n        </ToggleButton>\r\n      </ToggleButtonGroup>\r\n      {isFullscreenEnabled &&\r\n        <Tooltip\r\n          title={isFullscreen ?\r\n            'Exit Fullscreen' :\r\n            'Enter Fullscreen'\r\n          }\r\n        >\r\n          <Box\r\n            sx={{\r\n              display: { xs: 'none', md: 'block' }\r\n            }}\r\n          >\r\n            <IconButton\r\n              size='large'\r\n              color='inherit'\r\n              aria-label='fullscreen'\r\n              disabled={!fullscreenButtonActive}\r\n              onClick={onToggleFullscreen}\r\n            >\r\n              {isFullscreen ?\r\n                <FullscreenExitIcon /> :\r\n                <FullscreenEnterIcon/>\r\n              }\r\n            </IconButton>\r\n          </Box>\r\n        </Tooltip>\r\n      }\r\n      <Tooltip\r\n        title='Terms And Conditions'\r\n      >\r\n        <IconButton\r\n          size='large'\r\n          color='inherit'\r\n          aria-label='terms-and-policy'\r\n          edge={isSignedIn ? undefined : 'end'}\r\n          ref={helpMenuRef}\r\n          onClick={handleHelpMenuClick}\r\n          sx={{\r\n            p: { xs: '6px', md: '12px'}\r\n          }}\r\n        >\r\n          <HelpIcon/>\r\n        </IconButton>\r\n      </Tooltip>\r\n      <Menu\r\n        anchorEl={helpMenuRef.current}\r\n        open={isHelpMenuOpen}\r\n        onClose={handleHelpMenuClose}\r\n        MenuListProps={{\r\n          'aria-labelledby': 'basic-button',\r\n        }}\r\n      >\r\n        <MenuItem\r\n          component='a'\r\n          href={`${process.env.PUBLIC_URL}/privacy.html`}\r\n        >\r\n          <ListItemIcon>\r\n            <PolicyIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Privacy Policy'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          component='a'\r\n          href={`${process.env.PUBLIC_URL}/terms.html`}\r\n        >\r\n          <ListItemIcon>\r\n            <TermsIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Terms And Conditions'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </Menu>\r\n      {isSignedIn && profile &&\r\n        <IconButton\r\n          size='large'\r\n          edge='end'\r\n          color='inherit'\r\n          aria-label='terms-and-policy'\r\n          ref={profileMenuRef}\r\n          onClick={handleProfileMenuClick}\r\n          sx={{\r\n            p: '6px'\r\n          }}\r\n        >\r\n          <Avatar\r\n            src={profile.imageUrl}\r\n            sx={{\r\n              width: 32,\r\n              height: 32\r\n            }}\r\n          />\r\n        </IconButton>\r\n      }\r\n      <Menu\r\n        anchorEl={profileMenuRef.current}\r\n        open={isProfileMenuOpen}\r\n        onClose={handleProfileMenuClose}\r\n        MenuListProps={{\r\n          'aria-labelledby': 'basic-button',\r\n        }}\r\n      >\r\n        <MenuItem\r\n          onClick={onSignOutClick}\r\n        >\r\n          <ListItemIcon>\r\n            <SignOutIcon/> \r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Sign Out'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </Menu>\r\n      {!isSignedIn && isCookiesError &&\r\n        <Tooltip\r\n          title={`You need to enable 3rd party cookies.\r\n            Click \"eye\" icon at the end of address bar`}\r\n        >\r\n          <CookiesErrorIcon\r\n            color='error'\r\n            sx={{\r\n              ml: '12px',\r\n              mr: '-6px'\r\n            }}\r\n          />\r\n        </Tooltip>\r\n      }\r\n    </Toolbar>\r\n  );\r\n};\r\n\r\nexport default Topbar;","import { createTheme } from '@material-ui/core/styles';\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      main: '#ffffff',\r\n      contrastText: '#595959'\r\n    },\r\n  },\r\n  components: {\r\n    MuiTooltip: {\r\n      styleOverrides: {\r\n        tooltip: {\r\n          backgroundColor: 'rgba(0, 0, 0, 0.5)'\r\n        }\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\nexport default theme;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport { ThemeProvider } from '@material-ui/core/styles';\r\nimport theme from './theme';\r\n\r\nReactDOM.render(\r\n  <ThemeProvider theme={theme}>\r\n    <React.StrictMode>\r\n      <CssBaseline />\r\n      <App />\r\n    </React.StrictMode>\r\n  </ThemeProvider>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}