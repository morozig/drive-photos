{"version":3,"sources":["lib/api.ts","containers/home/components/topbar/index.tsx","containers/home/components/landing/speech-bubble/speech-bubble.svg","containers/home/components/landing/speech-bubble/speech-bubble-wide.svg","containers/home/components/landing/speech-bubble/index.tsx","containers/home/components/landing/comix/index.tsx","lib/observable.ts","lib/screenfull.ts","containers/view/index.tsx","lib/hooks.ts","containers/view/components/thumbnails/hooks.ts","containers/home/components/landing/space/helpers.ts","containers/home/components/landing/space/index.tsx","containers/home/components/landing/index.tsx","containers/home/components/landing/hooks.ts","containers/home/index.tsx","containers/view/components/thumbnails/Thumbnail.tsx","containers/view/components/thumbnails/VirtualGrid.tsx","containers/view/components/thumbnails/index.tsx","containers/view/components/viewer/index.tsx","containers/view/components/viewer/hooks.ts","containers/view/components/topbar/GoogleIcon.tsx","containers/view/components/topbar/TitleTooltip.tsx","containers/view/components/topbar/index.tsx","App.tsx","theme.ts","index.tsx"],"names":["GoogleAuth","picker","DirectoryEdge","Topbar","useState","isMenuOpen","setMenuOpen","menuRef","useRef","isHelpMenuOpen","setHelpMenuOpen","helpMenuRef","handleMenuClose","useCallback","handleMenuClick","current","handleHelpMenuClose","handleHelpMenuClick","Toolbar","IconButton","size","edge","color","sx","mr","ref","onClick","Menu","anchorEl","open","onClose","MenuItem","component","Link","to","ListItemIcon","ListItemText","Box","flexGrow","overflow","Typography","variant","noWrap","textOverflow","Tooltip","title","p","xs","md","MenuListProps","href","process","SpeechBubble","props","background","speechBubble","speechBubbleWide","backgroundPosition","backgroundSize","backgroundRepeat","textAlign","fontFamily","padding","maxWidth","marginRight","fontSize","lineHeight","children","OpenView","Button","RouterLink","startIcon","slides","Paper","height","width","position","backgroundColor","border","boxSizing","src","bottom","left","maxHeight","undefined","top","right","marginTop","display","flexDirection","justifyContent","alignContent","justifySelf","margin","underline","marginLeft","Comix","map","slide","i","length","Observable","observers","observer","this","push","subscribe","onceObserver","message","unsubscribe","splice","indexOf","forEach","scope","join","discoveryDocs","apiKey","signedInObservable","gapiErrorsObservable","gapiReadyObservable","pickObservable","pickerReadyObservable","gapiError","onSignedInChanged","isSignedIn","createPicker","onPick","onGapiLoaded","a","gapi","client","init","clientId","auth2","getAuthInstance","get","listen","console","log","response","Error","accessToken","currentUser","getAuthResponse","access_token","view","google","DocsView","ViewId","DOCS_IMAGES","setMimeTypes","setIncludeFolders","setParent","PickerBuilder","enableFeature","Feature","NAV_HIDDEN","addView","setOAuthToken","setDeveloperKey","setCallback","build","listFiles","options","parentId","pageToken","drive","files","list","q","fields","pageSize","orderBy","result","getEdgeFiles","Begin","getParent","fileId","listDirectories","grandParentId","load","FitMode","document","window","fn","val","fnMap","l","ret","Screenfull","Boolean","fullscreenElement","event","callback","eventName","fullscreenerror","fullscreenchange","addEventListener","removeEventListener","element","Promise","resolve","reject","onFullScreenEntered","off","on","returnPromise","documentElement","requestFullscreen","then","catch","isFullscreen","onFullScreenExit","exitFullscreen","exit","request","fullscreenEnabled","recentLocalStorageKey","useAbortSignal","abortControllerRef","AbortController","useEffect","abortController","abort","signal","useIsSignedIn","onSignOut","signedIn","setSignedIn","profile","setProfile","setGapiError","isCookiesError","setCookiesError","onChange","onError","toggleSignedIn","signOut","signIn","once","imageUrl","getBasicProfile","getImageUrl","details","useFullScreen","setFullscreen","isEnabled","run","toggleFullScreen","div","toggle","err","useEdgeFileId","edgeFileId","setEdgeFileId","edgeFiles","aborted","id","useDrive","prevDirId","setPrevDirId","nextDirId","setNextDirId","prevDirFileId","End","setFiles","setPageToken","parentIdRef","prevFiles","concat","nextPageToken","useFiles","nextDirFileId","directory","setDirectory","useDirectory","directories","setDirectories","useDirectories","parents","directoryIndex","useMemo","findIndex","sibling","directoryId","directoryName","name","prev","next","useDebounce","value","delay","debouncedValue","setDebouncedValue","timeout","setTimeout","clearTimeout","useRectSize","rectSize","setRectSize","debouncedRectSize","check","requestAnimationFrame","offsetWidth","offsetHeight","easeInOutSine","time","timeFrom","timeTo","valFrom","valTo","Math","cos","PI","Space","slideHeight","jumpHeight","scrollTop","isJumping","setJumping","cellSize","randomShift","random","slidesWithCoordinates","hash","Map","row","column","floor","key","slideWithCoordinates","shift","set","cells","numRows","j","dx","dy","dz","transform","loading","planeShift","scrollMax","slideIndex","scroll","scrollJump","curr","prevX","prevY","prevZ","nextX","nextY","nextZ","timeCapFraction","valCap","timeCap","easeInOutCap","calculateShift","debouncedSrollTop","perspective","willChange","transformStyle","transition","Landing","setScrollTop","onScroll","useScrollAware","round","clientHeight","zIndex","visibility","Home","AppBar","theme","drawer","Thumbnail","file","counter","isActive","borderRadius","bgcolor","thumbnailLink","alt","ImageListItemBar","subtitle","VirtualGrid","forwardRef","scrollRef","Item","itemHeight","itemsCount","rowsAhead","rowGap","columnGap","itemWidth","scrollBar","scrollToIndex","onVisibleRows","center","className","itemsInRow","rowsCount","ceil","scrollContainer","e","target","indexToOffset","index","block","scrollToRow","scrollOffset","scrollToRowTop","scrollToRowBottom","scrollBottom","totalHeight","useImperativeHandle","scrollTo","startRow","max","startItem","visibleItemsCount","min","offsetY","firstVisibleRow","lastVisibleRow","visibleRows","visibleItems","Array","fill","_","columnWidth","gridTemplateColumns","rowWidth","totalWidth","style","gap","justifyItems","Thumbnails","onSelect","onVisibleFiles","virtualGridRef","scrollIndexRef","activeIndex","Img","styled","Viewer","viewerRef","fitMode","onNextImage","onPrevImage","onFitModeChange","isScrollToBottom","isSlideshowEnabled","isSlideshowPlaying","onToggleSlideshowPlaying","contextMenu","setContextMenu","wheelCount","onScrollOverTop","onScrollBelowBottom","scrollTopRef","scrollOverTopCountRef","scrollBelowBottomCountRef","scrollToTop","scrollToBottom","scrollHeight","scrollNextSlide","slideSize","onWheel","deltaY","useScrollActions","timer","setInterval","clearInterval","activeFileId","toggleFullscreen","onContextMenu","preventDefault","x","clientX","y","clientY","onClickFullscreen","onClickFitBest","Best","onClickFitWidth","Width","onClickFitHeight","Height","onClickFitOriginal","Original","onClickSlideshow","whiteSpace","verticalAlign","webContentLink","container","disableScrollLock","anchorReference","anchorPosition","GoogleIcon","SvgIcon","d","TitleTooltip","text","isOverflow","setOverflow","scrollWidth","disableHoverListener","counterTitle","onOpenFile","onRecentFile","fullscreenButtonActive","onToggleFullscreen","isFirstImageEnabled","isPrevImageEnabled","isNextImageEnabled","isLastImageEnabled","onFirstImage","onLastImage","recentFiles","onDownloadFile","onCloseFile","isMobileDrawerOpen","toggleMobileDrawer","isRecentMenuOpen","setRecentMenuOpen","recentMenuRef","isProfileMenuOpen","setProfileMenuOpen","profileMenuRef","isFullscreenEnabled","onOpenClick","setVisible","onThisPick","action","doc","docs","onDrawerClick","onDownloadClick","onCloseClick","handleRecentMenuClose","handleRecentMenuClick","onRecentFileClick","recentFile","handleProfileMenuClose","handleProfileMenuClick","onSignOutClick","disabled","Divider","defaultTitle","PaperProps","anchorOrigin","vertical","horizontal","m","ToggleButtonGroup","exclusive","ToggleButton","Avatar","ml","drawerWidth","View","setFitMode","setParentId","setFileId","setIsScrollToBottom","setTitle","setSlideshowPlaying","visibleThumbnails","setVisibleThumbnails","setMobileDrawerOpen","isSmallScreen","useTheme","useMediaQuery","breakpoints","down","useIsSmallScreen","setRecentFiles","recentJsonRef","recentJson","localStorage","getItem","JSON","parse","replace","slice","recentLength","clear","stringify","setItem","removeItem","useRecentFiles","fileJustOpenedRef","activeFile","fileName","documentTitle","newIndex","url","createElement","download","body","appendChild","click","removeChild","viewFiles","preloadFiles","Set","add","delete","from","onKeyDown","SwipeableDrawer","anchor","onOpen","flexShrink","ModalProps","keepMounted","Drawer","App","path","createTheme","palette","primary","main","contrastText","secondary","components","MuiTooltip","styleOverrides","tooltip","ReactDOM","render","ThemeProvider","StrictMode","CssBaseline","getElementById"],"mappings":"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","file":"static/js/main.bdb9bc74.chunk.js","sourcesContent":["import Observable from './observable';\r\nimport './Picker.css';\r\n\r\nconst scope = [\r\n  'https://www.googleapis.com/auth/drive.metadata.readonly',\r\n  'https://www.googleapis.com/auth/drive.readonly'\r\n].join(' ');\r\nconst discoveryDocs = [\r\n  'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'\r\n];\r\nconst apiKey = process.env.NODE_ENV === 'production' ?\r\n  'AIzaSyDAXtOKqc3gYjmuoxZAqQHnBm-xTQi1-Mw' :\r\n    process.env.REACT_APP_GAPI_KEY;\r\nconst clientId = '321539141956-kn4i96a10682t0l8agfo5158fln9ai5d.apps.googleusercontent.com';\r\n\r\nconst signedInObservable = new Observable<boolean>();\r\nconst gapiErrorsObservable = new Observable<any>();\r\nlet GoogleAuth: gapi.auth2.GoogleAuth | undefined;\r\nconst gapiReadyObservable = new Observable<void>();\r\nlet picker: google.picker.Picker | undefined;\r\nconst pickObservable = new Observable<google.picker.ResponseObject>();\r\nconst pickerReadyObservable = new Observable<void>();\r\nlet gapiError = null as null | any;\r\n\r\nexport interface Profile {\r\n  imageUrl: string;\r\n}\r\n\r\nconst onSignedInChanged = (isSignedIn: boolean) => {\r\n  // console.log('onSignedInChanged', isSignedIn);\r\n  signedInObservable.push(isSignedIn);\r\n  if (isSignedIn) {\r\n    createPicker();\r\n    pickerReadyObservable.push();\r\n  } else {\r\n    picker = undefined;\r\n    pickObservable.unsubscribe(onPick);\r\n  }\r\n};\r\n\r\nconst onGapiLoaded = async () => {\r\n  try {\r\n    await gapi.client.init({\r\n      apiKey,\r\n      clientId,\r\n      scope,\r\n      discoveryDocs\r\n    });\r\n    GoogleAuth = gapi.auth2.getAuthInstance();\r\n    // console.log(gapi.auth2, GoogleAuth, GoogleAuth.isSignedIn, google);\r\n    onSignedInChanged(GoogleAuth.isSignedIn.get());\r\n    GoogleAuth.isSignedIn.listen(onSignedInChanged);\r\n    gapiReadyObservable.push();\r\n  }\r\n  catch (err) {\r\n    console.log(err);\r\n    gapiErrorsObservable.push(err);\r\n    gapiError = err;\r\n  }\r\n};\r\n\r\nconst onPick = (response: google.picker.ResponseObject) => {\r\n  // console.log('onPick', response);\r\n  pickObservable.push(response);\r\n};\r\n\r\nconst createPicker = () => {\r\n  if (!GoogleAuth || !apiKey) {\r\n    throw new Error('not authed');\r\n  }\r\n  const user = GoogleAuth.currentUser.get();\r\n  const authResponse = user.getAuthResponse(true);\r\n  const accessToken = authResponse.access_token;\r\n\r\n  const view = new google.picker.DocsView(google.picker.ViewId.DOCS_IMAGES)\r\n    .setMimeTypes('image/apng,image/avif,image/gif,image/jpeg,image/png,image/svg+xml,image/webp')\r\n    .setIncludeFolders(true)\r\n    .setParent('root');\r\n  \r\n  picker = new google.picker.PickerBuilder()\r\n    .enableFeature(google.picker.Feature.NAV_HIDDEN)\r\n    .addView(view)\r\n    .setOAuthToken(accessToken)\r\n    .setDeveloperKey(apiKey)\r\n    .setCallback(onPick)\r\n    .build();\r\n  // console.log({picker});\r\n};\r\n\r\n// console.log(gapi);\r\n\r\nconst isSignedIn = () => {\r\n  return !!GoogleAuth &&\r\n    GoogleAuth.isSignedIn.get() as boolean;\r\n};\r\nexport type SignedInChangeHandler = (isSignedIn: boolean) => void;\r\n\r\nconst subscribeToSignedInChange = (onChange: SignedInChangeHandler) => {\r\n  signedInObservable.subscribe(onChange);\r\n  return () => signedInObservable.unsubscribe(onChange);\r\n};\r\n\r\nconst signIn = () => {\r\n  if (GoogleAuth) {\r\n    GoogleAuth.signIn();\r\n  } else {\r\n    gapiReadyObservable.once(\r\n      () => {\r\n        if (GoogleAuth) {\r\n          GoogleAuth.signIn();\r\n        }\r\n      }\r\n    );\r\n  }\r\n};\r\nconst signOut = () => {\r\n  if (GoogleAuth) {\r\n    GoogleAuth.signOut();\r\n  }\r\n};\r\nconst pickFile = () => new Promise<google.picker.DocumentObject | null>(\r\n  (resolve, reject) => {\r\n    const onThisPick = (response: google.picker.ResponseObject) => {\r\n      if (response.action === 'picked') {\r\n        const doc = response.docs[0];\r\n        pickObservable.unsubscribe(onThisPick);\r\n        resolve(doc);\r\n      } else if (response.action === 'cancel') {\r\n        pickObservable.unsubscribe(onThisPick);\r\n        resolve(null);\r\n      }\r\n    };\r\n\r\n    if (picker) {\r\n      picker.setVisible(true);\r\n    } else {\r\n      pickerReadyObservable.once(() => {\r\n        if (picker) {\r\n          picker.setVisible(true);\r\n        } else {\r\n          reject(new Error('No Picker'));\r\n        }\r\n      });\r\n    }\r\n\r\n    pickObservable.subscribe(onThisPick);\r\n  }\r\n);\r\n\r\nconst getFile = async (fileId: string) => {\r\n  try {\r\n    const result = await gapi.client.drive.files.get({\r\n      fileId,\r\n      fields: '*'\r\n    });\r\n    return result.result;\r\n  }\r\n  catch(err) {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\nexport interface ListFilesOptions {\r\n  parentId: string;\r\n  pageToken?: string;\r\n};\r\n\r\nconst listFiles = async (options: ListFilesOptions) => {\r\n  const {\r\n    parentId,\r\n    pageToken\r\n  } = options;\r\n  try {\r\n    const result = await gapi.client.drive.files.list({\r\n      q: `'${parentId}' in parents and mimeType contains 'image/'`,\r\n      fields: 'files(id, name, thumbnailLink, webContentLink, imageMediaMetadata/*)',\r\n      // fields: '*',\r\n      pageSize: 1000,\r\n      orderBy: 'name_natural',\r\n      pageToken\r\n    });\r\n    // console.log({result});\r\n    return result.result;\r\n  }\r\n  catch(err) {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\nexport enum DirectoryEdge {\r\n  Begin = 1,\r\n  End\r\n};\r\ninterface GetEdgeFileOptions {\r\n  parentId: string;\r\n  edge: DirectoryEdge;\r\n};\r\n\r\nconst getEdgeFiles = async (options: GetEdgeFileOptions) => {\r\n  const {\r\n    parentId,\r\n    edge\r\n  } = options;\r\n  try {\r\n    const result = await gapi.client.drive.files.list({\r\n      q: `'${parentId}' in parents and mimeType contains 'image/'`,\r\n      fields: 'files(id, name)',\r\n      pageSize: 1,\r\n      orderBy: edge === DirectoryEdge.Begin ?\r\n        'name_natural' : 'name_natural desc'\r\n    });\r\n    return (\r\n      result.result ?\r\n        result.result.files : []\r\n    );\r\n  }\r\n  catch(err) {\r\n    console.log(err);\r\n    return [];\r\n  }\r\n};\r\n\r\nconst getParent = async (parentId: string) => {\r\n  try {\r\n    const result = await gapi.client.drive.files.get({\r\n      fileId: parentId,\r\n      fields: '*'\r\n    });\r\n    return result.result;\r\n  }\r\n  catch(err) {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\nconst listDirectories = async (grandParentId: string) => {\r\n  try {\r\n    const result = await gapi.client.drive.files.list({\r\n      q: `'${grandParentId}' in parents and mimeType = 'application/vnd.google-apps.folder'`,\r\n      // fields: 'files(id, name, thumbnailLink, webContentLink, imageMediaMetadata/*)',\r\n      fields: '*',\r\n      pageSize: 1000,\r\n      orderBy: 'name_natural'\r\n    });\r\n    // console.log({result});\r\n    return result.result;\r\n  }\r\n  catch(err) {\r\n    console.log(err);\r\n  }\r\n};\r\n\r\nconst getProfile = () => {\r\n  if (!GoogleAuth) {\r\n    return null;\r\n  }\r\n  const user = GoogleAuth.currentUser.get();\r\n  const profile = user.getBasicProfile();\r\n  const imageUrl = profile.getImageUrl();\r\n  return {\r\n    imageUrl\r\n  } as Profile;\r\n};\r\n\r\nexport type GapiErrorHandler = (error: any) => void;\r\nconst subscribeToGapiErrors = (onError: GapiErrorHandler) => {\r\n  gapiErrorsObservable.subscribe(onError);\r\n  return () => gapiErrorsObservable.unsubscribe(onError);\r\n};\r\nconst getGapiError = () => gapiError;\r\n\r\ngapi.load('client:auth2:picker', onGapiLoaded);\r\n\r\nexport {\r\n  isSignedIn,\r\n  signIn,\r\n  signOut,\r\n  subscribeToSignedInChange,\r\n  pickFile,\r\n  getFile,\r\n  listFiles,\r\n  getParent,\r\n  getEdgeFiles,\r\n  listDirectories,\r\n  getProfile,\r\n  subscribeToGapiErrors,\r\n  getGapiError\r\n};\r\n","import React, {\r\n  useState,\r\n  useRef,\r\n  useCallback,\r\n} from 'react';\r\nimport {\r\n  Box,\r\n  Toolbar,\r\n  Typography,\r\n  IconButton,\r\n  Menu,\r\n  MenuItem,\r\n  Tooltip,\r\n  ListItemIcon,\r\n  ListItemText\r\n} from '@material-ui/core';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport HelpIcon from '@material-ui/icons/HelpOutline';\r\nimport PolicyIcon from '@material-ui/icons/Policy';\r\nimport TermsIcon from '@material-ui/icons/Gavel';\r\nimport { Link } from 'react-router-dom';\r\nimport OpenViewIcon from '@material-ui/icons/OpenInBrowser';\r\n\r\nconst Topbar: React.FC = () => {\r\n  const [ isMenuOpen, setMenuOpen ] = useState(false);\r\n  const menuRef = useRef<HTMLButtonElement>(null);\r\n  const [ isHelpMenuOpen, setHelpMenuOpen ] = useState(false);\r\n  const helpMenuRef = useRef<HTMLButtonElement>(null);\r\n\r\n  const handleMenuClose = useCallback(() => {\r\n    setMenuOpen(false);\r\n  }, []);\r\n  const handleMenuClick = useCallback(() => {\r\n    setMenuOpen(current => !current);\r\n  }, []);\r\n  const handleHelpMenuClose = useCallback(() => {\r\n    setHelpMenuOpen(false);\r\n  }, []);\r\n  const handleHelpMenuClick = useCallback(() => {\r\n    setHelpMenuOpen(current => !current);\r\n  }, []);\r\n\r\n  return (\r\n    <Toolbar>\r\n      <IconButton\r\n        size='large'\r\n        edge='start'\r\n        color='inherit'\r\n        aria-label='menu'\r\n        sx={{ mr: 2 }}\r\n        ref={menuRef}\r\n        onClick={handleMenuClick}\r\n      >\r\n        <MenuIcon />\r\n      </IconButton>\r\n      <Menu\r\n        anchorEl={menuRef.current}\r\n        open={isMenuOpen}\r\n        onClose={handleMenuClose}\r\n      >\r\n        <MenuItem\r\n          component={Link}\r\n          to={'/view'}\r\n        >\r\n          <ListItemIcon>\r\n            <OpenViewIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Open View'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </Menu>\r\n      <Box\r\n        sx={{\r\n          flexGrow: 1,\r\n          overflow: 'hidden'\r\n        }}\r\n      >\r\n        <Typography\r\n          variant='h6'\r\n          noWrap\r\n          sx={{\r\n            textOverflow: 'ellipsis'\r\n          }}\r\n        >\r\n          {'Drive Photos'}\r\n        </Typography>\r\n      </Box>\r\n      <Tooltip\r\n        title='Terms And Conditions'\r\n      >\r\n        <IconButton\r\n          size='large'\r\n          color='inherit'\r\n          aria-label='terms-and-policy'\r\n          edge={'end'}\r\n          ref={helpMenuRef}\r\n          onClick={handleHelpMenuClick}\r\n          sx={{\r\n            p: { xs: '6px', md: '12px'}\r\n          }}\r\n        >\r\n          <HelpIcon/>\r\n        </IconButton>\r\n      </Tooltip>\r\n      <Menu\r\n        anchorEl={helpMenuRef.current}\r\n        open={isHelpMenuOpen}\r\n        onClose={handleHelpMenuClose}\r\n        MenuListProps={{\r\n          'aria-labelledby': 'basic-button',\r\n        }}\r\n      >\r\n        <MenuItem\r\n          component='a'\r\n          href={`${process.env.PUBLIC_URL}/privacy.html`}\r\n        >\r\n          <ListItemIcon>\r\n            <PolicyIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Privacy Policy'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          component='a'\r\n          href={`${process.env.PUBLIC_URL}/terms.html`}\r\n        >\r\n          <ListItemIcon>\r\n            <TermsIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Terms And Conditions'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </Menu>\r\n    </Toolbar>\r\n  );\r\n};\r\n\r\nexport default Topbar;\r\n","export default __webpack_public_path__ + \"static/media/speech-bubble.52063f50.svg\";","export default __webpack_public_path__ + \"static/media/speech-bubble-wide.07d56428.svg\";","import React, {\r\n} from 'react';\r\nimport {\r\n  Typography,\r\n  Box\r\n} from '@material-ui/core';\r\nimport './ComicFont.css';\r\nimport {\r\n  SystemStyleObject\r\n} from '@material-ui/system';\r\nimport speechBubble from './speech-bubble.svg';\r\nimport speechBubbleWide from './speech-bubble-wide.svg';\r\n\r\ninterface SpeechBubbleProps {\r\n  sx?: SystemStyleObject;\r\n}\r\n\r\nconst SpeechBubble: React.FC<SpeechBubbleProps> = (props) => {\r\n  const {\r\n    sx\r\n  } = props;\r\n  return (\r\n    <Box\r\n      sx={{\r\n        ...sx,\r\n        background: {\r\n          xs: `url(${speechBubble})`,\r\n          md: `url(${speechBubbleWide})`,\r\n        },\r\n        backgroundPosition: 'center',\r\n        backgroundSize: '100% 100%',\r\n        backgroundRepeat: 'no-repeat',\r\n        textAlign: 'center',\r\n        fontFamily: 'Comic Sans MS',\r\n        padding: {\r\n          xs: '10vmin 5vmin 30vmin 5vmin',\r\n          md: '15vmin 15vmin 15vmin 15vmin',\r\n        },\r\n        maxWidth: {\r\n          xs: '60vmin',\r\n          md: '100vmin',\r\n        },\r\n        marginRight: {\r\n          xs: '0',\r\n          md: '-5vmin',\r\n        },\r\n      }}\r\n    >\r\n      {/* {props.children} */}\r\n      <Typography\r\n        fontFamily={'Comic Sans MS'}\r\n        fontSize={'7vmin'}\r\n        lineHeight={'7vmin'}\r\n      >\r\n        {props.children}\r\n      </Typography>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default SpeechBubble;\r\n","import React, { Fragment } from 'react';\r\nimport {\r\n  Box,\r\n  Link,\r\n  Paper,\r\n  Toolbar,\r\n  Button\r\n} from '@material-ui/core';\r\nimport SpeechBubble from '../speech-bubble';\r\nimport {\r\n  SystemStyleObject\r\n} from '@material-ui/system';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\nimport OpenViewIcon from '@material-ui/icons/OpenInBrowser';\r\n\r\ninterface ComixProps {\r\n  sx?: SystemStyleObject;\r\n}\r\n\r\nexport const jumpHeight = 2500;\r\n\r\nconst OpenView: React.FC = () => {\r\n  return (\r\n    <Button\r\n      component={RouterLink}\r\n      to={'/view'}\r\n      variant={'contained'}\r\n      color='secondary'\r\n      startIcon={<OpenViewIcon/>}\r\n    >\r\n      {'Open View'}\r\n    </Button>\r\n  );\r\n};\r\n\r\nexport const slides = [\r\n  <Paper>\r\n    <Box\r\n      sx={{\r\n        height: '100vh',\r\n        width: '100%',\r\n        position: 'relative',\r\n        backgroundColor: '#6df3db',\r\n        border: 'solid black 0.8vmin',\r\n        boxSizing: 'border-box',\r\n        overflow: 'hidden'\r\n      }}\r\n    >\r\n      <Box\r\n        component='img'\r\n        src={`${process.env.PUBLIC_URL}/assets/girl1.jpg`}\r\n        sx={{\r\n          position: 'absolute',\r\n          bottom: 0,\r\n          left: {\r\n            xs: '-5%',\r\n            md: '0',\r\n          },\r\n          maxHeight: {\r\n            xs: '60vh',\r\n            md: '100%',\r\n          },\r\n          maxWidth: {\r\n            xs: undefined,\r\n            md: '70vw',\r\n          },\r\n        }}\r\n      />\r\n      <SpeechBubble\r\n        sx={{\r\n          position: 'absolute',\r\n          top: {\r\n            xs: '10%',\r\n            md: '0',\r\n          },\r\n          right: 0,\r\n        }}\r\n      >\r\n        {'Drive Photos'}\r\n      </SpeechBubble>\r\n    </Box>\r\n    <Box\r\n      sx={{\r\n        height: '100vh',\r\n        width: '100%',\r\n        position: 'relative',\r\n        backgroundColor: '#ffdc2e',\r\n        border: 'solid black 0.8vmin',\r\n        marginTop: '3vh',\r\n        boxSizing: 'border-box',\r\n        overflow: 'hidden'\r\n      }}\r\n    >\r\n      <Box\r\n        component='img'\r\n        src={`${process.env.PUBLIC_URL}/assets/girl2.jpg`}\r\n        sx={{\r\n          position: 'absolute',\r\n          bottom: 0,\r\n          left: {\r\n            xs: '-5%',\r\n            md: '0',\r\n          },\r\n          maxHeight: {\r\n            xs: '60vh',\r\n            md: '100%',\r\n          },\r\n          maxWidth: {\r\n            xs: undefined,\r\n            md: '70vw',\r\n          },\r\n        }}\r\n      />\r\n      <SpeechBubble\r\n        sx={{\r\n          position: 'absolute',\r\n          top: {\r\n            xs: '10%',\r\n            md: '0',\r\n          },\r\n          right: 0\r\n        }}\r\n      >\r\n        {'Online image viewer for Google Drive.'}\r\n      </SpeechBubble>\r\n    </Box>\r\n  </Paper>,\r\n  <Paper>\r\n    <Box\r\n      sx={{\r\n        height: '100vh',\r\n        width: '100%',\r\n        position: 'relative',\r\n        backgroundColor: '#f31872',\r\n        border: 'solid black 0.8vmin',\r\n        boxSizing: 'border-box',\r\n        overflow: 'hidden'\r\n      }}\r\n    >\r\n      <Box\r\n        component='img'\r\n        src={`${process.env.PUBLIC_URL}/assets/girl3.jpg`}\r\n        sx={{\r\n          position: 'absolute',\r\n          bottom: 0,\r\n          left: {\r\n            xs: '-5%',\r\n            md: '0',\r\n          },\r\n          maxHeight: {\r\n            xs: '60vh',\r\n            md: '100%',\r\n          },\r\n          maxWidth: {\r\n            xs: undefined,\r\n            md: '70vw',\r\n          },\r\n        }}\r\n      />\r\n      <SpeechBubble\r\n        sx={{\r\n          position: 'absolute',\r\n          top: {\r\n            xs: '10%',\r\n            md: '0',\r\n          },\r\n          right: 0\r\n        }}\r\n      >\r\n        {'Access your photos anywhere.'}\r\n      </SpeechBubble>\r\n    </Box>\r\n    <Box\r\n      sx={{\r\n        height: '100vh',\r\n        width: '100%',\r\n        position: 'relative',\r\n        backgroundColor: '#02c7fc',\r\n        border: 'solid black 0.8vmin',\r\n        marginTop: '3vh',\r\n        boxSizing: 'border-box',\r\n        overflow: 'hidden'\r\n      }}\r\n    >\r\n      <Box\r\n        component='img'\r\n        src={`${process.env.PUBLIC_URL}/assets/girl4.jpg`}\r\n        sx={{\r\n          position: 'absolute',\r\n          bottom: 0,\r\n          left: {\r\n            xs: '-5%',\r\n            md: '0',\r\n          },\r\n          maxHeight: {\r\n            xs: '60vh',\r\n            md: '100%',\r\n          },\r\n          maxWidth: {\r\n            xs: undefined,\r\n            md: '70vw',\r\n          },\r\n        }}\r\n      />\r\n      <SpeechBubble\r\n        sx={{\r\n          position: 'absolute',\r\n          top: {\r\n            xs: '10%',\r\n            md: '0',\r\n          },\r\n          right: 0\r\n        }}\r\n      >\r\n        {'All devices are supported.'}\r\n      </SpeechBubble>\r\n    </Box>\r\n  </Paper>,\r\n  <Paper>\r\n    <Box\r\n      sx={{\r\n        height: '100vh',\r\n        width: '100%',\r\n        position: 'relative',\r\n        backgroundColor: '#fe0000',\r\n        border: 'solid black 0.8vmin',\r\n        boxSizing: 'border-box',\r\n        overflow: 'hidden'\r\n      }}\r\n    >\r\n      <Box\r\n        component='img'\r\n        src={`${process.env.PUBLIC_URL}/assets/girl5.jpg`}\r\n        sx={{\r\n          position: 'absolute',\r\n          bottom: 0,\r\n          left: {\r\n            xs: '-5%',\r\n            md: '0',\r\n          },\r\n          maxHeight: {\r\n            xs: '60vh',\r\n            md: '100%',\r\n          },\r\n          maxWidth: {\r\n            xs: undefined,\r\n            md: '70vw',\r\n          },\r\n        }}\r\n      />\r\n      <SpeechBubble\r\n        sx={{\r\n          position: 'absolute',\r\n          top: {\r\n            xs: '10%',\r\n            md: '0',\r\n          },\r\n          right: 0\r\n        }}\r\n      >\r\n        {'Free and open source.'}\r\n      </SpeechBubble>\r\n    </Box>\r\n    <Box\r\n      sx={{\r\n        height: '100vh',\r\n        width: '100%',\r\n        position: 'relative',\r\n        backgroundColor: '#fe3989',\r\n        border: 'solid black 0.8vmin',\r\n        marginTop: '3vh',\r\n        boxSizing: 'border-box',\r\n        overflow: 'hidden'\r\n      }}\r\n    >\r\n      <Box\r\n        component='img'\r\n        src={`${process.env.PUBLIC_URL}/assets/girl6.jpg`}\r\n        sx={{\r\n          position: 'absolute',\r\n          bottom: 0,\r\n          left: {\r\n            xs: '-5%',\r\n            md: '0',\r\n          },\r\n          maxHeight: {\r\n            xs: '60vh',\r\n            md: '100%',\r\n          },\r\n          maxWidth: {\r\n            xs: undefined,\r\n            md: '70vw',\r\n          },\r\n        }}\r\n      />\r\n      <SpeechBubble\r\n        sx={{\r\n          position: 'absolute',\r\n          top: {\r\n            xs: '10%',\r\n            md: '0',\r\n          },\r\n          right: 0\r\n        }}\r\n      >\r\n        {'No server, all personal data stays in your browser.'}\r\n      </SpeechBubble>\r\n    </Box>\r\n  </Paper>,\r\n  <Paper>\r\n    <Box\r\n      sx={{\r\n        height: '100vh',\r\n        width: '100%',\r\n        position: 'relative',\r\n        backgroundColor: '#db0285',\r\n        border: 'solid black 0.8vmin',\r\n        boxSizing: 'border-box',\r\n        overflow: 'hidden'\r\n      }}\r\n    >\r\n      <Box\r\n        component='img'\r\n        src={`${process.env.PUBLIC_URL}/assets/girl7.jpg`}\r\n        sx={{\r\n          position: 'absolute',\r\n          bottom: 0,\r\n          left: {\r\n            xs: '-5%',\r\n            md: '0',\r\n          },\r\n          maxHeight: {\r\n            xs: '60vh',\r\n            md: '100%',\r\n          },\r\n          maxWidth: {\r\n            xs: undefined,\r\n            md: '70vw',\r\n          },\r\n        }}\r\n      />\r\n      <SpeechBubble\r\n        sx={{\r\n          position: 'absolute',\r\n          top: {\r\n            xs: '10%',\r\n            md: '0',\r\n          },\r\n          right: 0\r\n        }}\r\n      >\r\n        {'Fullscreen and slideshow modes.'}\r\n      </SpeechBubble>\r\n    </Box>\r\n    <Box\r\n      sx={{\r\n        height: '103vh',\r\n        width: '100%',\r\n        backgroundColor: 'white',\r\n        display: 'flex',\r\n        flexDirection: 'column'\r\n      }}\r\n    >\r\n      <Box\r\n        sx={{\r\n          flexGrow: 1,\r\n          display: 'grid',\r\n          justifyContent: 'center',\r\n          alignContent: 'center'\r\n        }}\r\n      >\r\n        <Box\r\n          component={'img'}\r\n          src={`${process.env.PUBLIC_URL}/assets/Logo_48.svg`}\r\n          sx={{\r\n            height: '48px',\r\n            width: '48px',\r\n            justifySelf: 'center',\r\n            margin: '0 0 24px 0'\r\n          }}\r\n        />\r\n        <OpenView/>\r\n      </Box>\r\n      <Toolbar\r\n        sx={{\r\n          backgroundColor: '#424242',\r\n          color: 'white',\r\n        }}\r\n      >\r\n        <Link\r\n          href={`${process.env.PUBLIC_URL}/privacy.html`}\r\n          color='inherit'\r\n          underline='none'\r\n        >\r\n          {'Privacy Policy'}\r\n        </Link>\r\n        <Link\r\n          href={`${process.env.PUBLIC_URL}/terms.html`}\r\n          color='inherit'\r\n          underline='none'\r\n          sx={{\r\n            marginLeft: '24px'\r\n          }}\r\n        >\r\n          {'Terms And Conditions'}\r\n        </Link>\r\n      </Toolbar>\r\n    </Box>\r\n  </Paper>\r\n];\r\n\r\nconst Comix: React.FC<ComixProps> = (props) => {\r\n  const {\r\n    sx\r\n  } = props;\r\n  return (\r\n    <Box\r\n      sx={{\r\n        ...sx,\r\n        backgroundColor: 'black'\r\n      }}\r\n    >\r\n      {slides.map((slide, i) => (\r\n        <Fragment key={i}>\r\n          {slide}\r\n          {i < slides.length - 1 ?\r\n            <Box\r\n              sx={{\r\n                height: `${jumpHeight}px`\r\n              }}\r\n            /> : null\r\n          }\r\n        </Fragment>\r\n      ))}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Comix;\r\n","type Observer<T> = (message: T) => void;\r\n\r\nexport default class Observable<T> {\r\n  private observers = [] as Observer<T>[];\r\n  subscribe(observer: Observer<T>) {\r\n    this.observers.push(observer);\r\n  }\r\n  once(observer: Observer<T>) {\r\n    const onceObserver = (message: T) => {\r\n      observer(message);\r\n      this.unsubscribe(onceObserver);\r\n    };\r\n    this.subscribe(onceObserver);\r\n  }\r\n  unsubscribe(observer: Observer<T>){\r\n    this.observers.splice(\r\n      this.observers.indexOf(observer),\r\n      1\r\n    );\r\n  }\r\n  push(message: T) {\r\n    this.observers.forEach(observer => observer(message));\r\n  }\r\n  unsubscribeAll() {\r\n    this.observers = [];\r\n  }\r\n};","const document = typeof window !== 'undefined' &&\r\n\ttypeof window.document !== 'undefined' ?\r\n\t\twindow.document : {} as any;\r\n\r\nconst fn = (() => {\r\n\tlet val;\r\n\r\n\tlet fnMap = [\r\n\t\t[\r\n\t\t\t'requestFullscreen',\r\n\t\t\t'exitFullscreen',\r\n\t\t\t'fullscreenElement',\r\n\t\t\t'fullscreenEnabled',\r\n\t\t\t'fullscreenchange',\r\n\t\t\t'fullscreenerror'\r\n\t\t],\r\n\t\t// New WebKit\r\n\t\t[\r\n\t\t\t'webkitRequestFullscreen',\r\n\t\t\t'webkitExitFullscreen',\r\n\t\t\t'webkitFullscreenElement',\r\n\t\t\t'webkitFullscreenEnabled',\r\n\t\t\t'webkitfullscreenchange',\r\n\t\t\t'webkitfullscreenerror'\r\n\r\n\t\t],\r\n\t\t// Old WebKit\r\n\t\t[\r\n\t\t\t'webkitRequestFullScreen',\r\n\t\t\t'webkitCancelFullScreen',\r\n\t\t\t'webkitCurrentFullScreenElement',\r\n\t\t\t'webkitCancelFullScreen',\r\n\t\t\t'webkitfullscreenchange',\r\n\t\t\t'webkitfullscreenerror'\r\n\r\n\t\t],\r\n\t\t[\r\n\t\t\t'mozRequestFullScreen',\r\n\t\t\t'mozCancelFullScreen',\r\n\t\t\t'mozFullScreenElement',\r\n\t\t\t'mozFullScreenEnabled',\r\n\t\t\t'mozfullscreenchange',\r\n\t\t\t'mozfullscreenerror'\r\n\t\t],\r\n\t\t[\r\n\t\t\t'msRequestFullscreen',\r\n\t\t\t'msExitFullscreen',\r\n\t\t\t'msFullscreenElement',\r\n\t\t\t'msFullscreenEnabled',\r\n\t\t\t'MSFullscreenChange',\r\n\t\t\t'MSFullscreenError'\r\n\t\t]\r\n\t];\r\n\r\n\tlet i = 0;\r\n\tlet l = fnMap.length;\r\n\tlet ret = {} as any;\r\n\r\n\tfor (; i < l; i++) {\r\n\t\tval = fnMap[i];\r\n\t\tif (val && val[1] in document) {\r\n\t\t\tfor (i = 0; i < val.length; i++) {\r\n\t\t\t\tret[fnMap[0][i]] = val[i];\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n})();\r\n\r\ntype EventName = 'change' | 'error';\r\n\r\nclass Screenfull {\r\n\tstatic get isFullscreen() {\r\n\t\treturn Boolean(document[fn.fullscreenElement]);\r\n\t}\r\n\tstatic on(event: EventName, callback: (event: Event) => void) {\r\n    const eventName = event === 'error' ?\r\n      fn.fullscreenerror : fn.fullscreenchange;\r\n    document.addEventListener(eventName, callback, false);\r\n  }\r\n\tstatic off(event: EventName, callback: (event: Event) => void) {\r\n    const eventName = event === 'error' ?\r\n      fn.fullscreenerror : fn.fullscreenchange;\r\n    document.removeEventListener(eventName, callback, false);\r\n  }\r\n  static request(element?: Element) {\r\n    return new Promise<void>((resolve, reject) => {\r\n      const onFullScreenEntered = () => {\r\n        this.off('change', onFullScreenEntered);\r\n        resolve();\r\n      };\r\n\r\n      this.on('change', onFullScreenEntered);\r\n\r\n      const fullscreenElement = element || document.documentElement;\r\n\r\n      const returnPromise = fullscreenElement[fn.requestFullscreen]();\r\n\r\n      if (returnPromise instanceof Promise) {\r\n        returnPromise.then(onFullScreenEntered).catch(reject);\r\n      }\r\n    });\r\n  }\r\n  static exit() {\r\n    return new Promise<void>((resolve, reject) => {\r\n      if (!this.isFullscreen) {\r\n        resolve();\r\n        return;\r\n      }\r\n\r\n      const onFullScreenExit = () => {\r\n        this.off('change', onFullScreenExit);\r\n        resolve();\r\n      };\r\n\r\n      this.on('change', onFullScreenExit);\r\n\r\n      const returnPromise = document[fn.exitFullscreen]();\r\n\r\n      if (returnPromise instanceof Promise) {\r\n        returnPromise.then(onFullScreenExit).catch(reject);\r\n      }\r\n    });\r\n  }\r\n  static toggle(element?: Element){\r\n    return this.isFullscreen ? this.exit() : this.request(element);\r\n  }\r\n  static get isEnabled() {\r\n\t\treturn Boolean(document[fn.fullscreenEnabled]);\r\n\t}\r\n};\r\n\r\nexport default Screenfull;\r\n","import React, {\r\n  useState,\r\n  useRef,\r\n  useCallback,\r\n  useMemo,\r\n  useEffect\r\n} from 'react';\r\nimport {\r\n  AppBar,\r\n  Box,\r\n  Toolbar,\r\n  Drawer,\r\n  SwipeableDrawer\r\n} from '@material-ui/core';\r\nimport { useDrive, useIsSmallScreen, useRecentFiles } from '../../lib/hooks';\r\nimport Thumbnails from './components/thumbnails';\r\nimport Viewer, { ViewerRef } from './components/viewer';\r\nimport Topbar from './components/topbar';\r\n\r\n\r\nconst drawerWidth = 260;\r\nconst preloadCount = 3;\r\nexport const defaultTitle = 'Drive Photos';\r\n\r\nexport interface FileEntry {\r\n  id: string;\r\n  parentId: string;\r\n};\r\n\r\nexport enum FitMode {\r\n  Best = 1,\r\n  Width,\r\n  Height,\r\n  Original\r\n}\r\n\r\nconst View: React.FC = () => {\r\n  const [ fitMode, setFitMode ] = useState<FitMode>(FitMode.Best);\r\n  const [ parentId, setParentId ] = useState('');\r\n  const [ fileId, setFileId ] = useState('');\r\n  const [ isScrollToBottom, setIsScrollToBottom ] = useState(false);\r\n  const [ title, setTitle ] = useState(defaultTitle);\r\n  const [ isSlideshowPlaying, setSlideshowPlaying ] = useState(false);\r\n  const [\r\n    visibleThumbnails,\r\n    setVisibleThumbnails\r\n  ] = useState<number[]>([]);\r\n  const [ isMobileDrawerOpen, setMobileDrawerOpen ] = useState(false);\r\n\r\n  const toggleMobileDrawer = useCallback(() => {\r\n    setMobileDrawerOpen(current => !current);\r\n  }, []);\r\n  const isSmallScreen = useIsSmallScreen();\r\n\r\n\r\n  const {\r\n    files,\r\n    directoryId,\r\n    directoryName,\r\n    prevDirId,\r\n    prevDirFileId,\r\n    nextDirId,\r\n    nextDirFileId\r\n  } = useDrive(parentId);\r\n\r\n  const {\r\n    recentFiles,\r\n    replace,\r\n    shift,\r\n    clear\r\n  } = useRecentFiles();\r\n  const fileJustOpenedRef = useRef(false);\r\n\r\n  const onOpenFile = useCallback((file: FileEntry) => {\r\n    setFileId(file.id);\r\n    setParentId(file.parentId);\r\n    setIsScrollToBottom(false);\r\n    fileJustOpenedRef.current = true;\r\n  }, []);\r\n\r\n  const activeIndex = useMemo(() => {\r\n    if (fileId && files.length > 0) {\r\n      return files.findIndex(file => file.id === fileId);\r\n    } else {\r\n      return -1;\r\n    }\r\n  }, [\r\n    fileId,\r\n    files\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const activeFile = files[activeIndex];\r\n    const fileName = activeFile ? activeFile.name : '';\r\n    const title = (directoryName && fileName) ? \r\n      `${directoryName}/${fileName}` : '';\r\n    const documentTitle = title ?\r\n      `${title} | ${defaultTitle}` : defaultTitle;\r\n    setTitle(title || defaultTitle);\r\n    document.title = documentTitle;\r\n    if (activeFile && directoryId && title && activeFile.id) {\r\n      const recentFile = {\r\n        id: activeFile.id,\r\n        parentId: directoryId,\r\n        title\r\n      };\r\n      if (fileJustOpenedRef.current) {\r\n        shift(recentFile);\r\n        fileJustOpenedRef.current = false;\r\n      } else {\r\n        replace(recentFile);\r\n      }\r\n    }\r\n  }, [\r\n    activeIndex,\r\n    directoryId,\r\n    directoryName,\r\n    files,\r\n    replace,\r\n    shift\r\n  ]);\r\n\r\n  const counterTitle = useMemo(() => {\r\n    return (activeIndex >= 0 && files.length > 0) ?\r\n      `${activeIndex + 1}/${files.length}` : '';\r\n  }, [\r\n    activeIndex,\r\n    files\r\n  ]);\r\n\r\n  const isFirstImageEnabled = useMemo(() => {\r\n    if (activeIndex < 0 || files.length < 0) {\r\n      return false;\r\n    }\r\n    return (activeIndex > 0);\r\n  }, [\r\n    activeIndex,\r\n    files.length\r\n  ]);\r\n  const isPrevImageEnabled = useMemo(() => {\r\n    if (activeIndex < 0 || files.length < 0) {\r\n      return false;\r\n    }\r\n    return (\r\n      activeIndex > 0 ||\r\n      !!prevDirFileId\r\n    )\r\n  }, [\r\n    activeIndex,\r\n    files.length,\r\n    prevDirFileId\r\n  ]);\r\n  const isNextImageEnabled = useMemo(() => {\r\n    if (activeIndex < 0 || files.length < 0) {\r\n      return false;\r\n    }\r\n    return (\r\n      activeIndex < files.length - 1 ||\r\n      !!nextDirFileId\r\n    )\r\n  }, [\r\n    activeIndex,\r\n    files.length,\r\n    nextDirFileId\r\n  ]);\r\n  const isLastImageEnabled = useMemo(() => {\r\n    if (activeIndex < 0 || files.length < 0) {\r\n      return false;\r\n    }\r\n    return (activeIndex < files.length - 1);\r\n  }, [\r\n    activeIndex,\r\n    files.length\r\n  ]);\r\n  const isSlideshowEnabled = useMemo(() => {\r\n    return isNextImageEnabled;\r\n  }, [\r\n    isNextImageEnabled\r\n  ]);\r\n\r\n  const onFirstImage = useCallback(() => {\r\n    const newIndex = 0;\r\n    if (files[newIndex] && files[newIndex].id) {\r\n      setFileId(files[newIndex].id || '');\r\n      setIsScrollToBottom(false);\r\n    }\r\n  }, [\r\n    files\r\n  ]);\r\n  const onPrevImage = useCallback(() => {\r\n    const newIndex = activeIndex - 1;\r\n    if (files[newIndex] && files[newIndex].id) {\r\n      setFileId(files[newIndex].id || '');\r\n      setIsScrollToBottom(true);\r\n    } else {\r\n      if (prevDirId && prevDirFileId) {\r\n        setFileId(prevDirFileId);\r\n        setParentId(prevDirId);\r\n        setIsScrollToBottom(true);\r\n      }\r\n    }\r\n  }, [\r\n    activeIndex,\r\n    files,\r\n    prevDirId,\r\n    prevDirFileId\r\n  ]);\r\n  const onNextImage = useCallback(() => {\r\n    const newIndex = activeIndex + 1;\r\n    if (files[newIndex] && files[newIndex].id) {\r\n      setFileId(files[newIndex].id || '');\r\n      setIsScrollToBottom(false);\r\n    } else {\r\n      if (nextDirId && nextDirFileId) {\r\n        setFileId(nextDirFileId);\r\n        setParentId(nextDirId);\r\n        setIsScrollToBottom(false);\r\n      }\r\n    }\r\n  }, [\r\n    activeIndex,\r\n    files,\r\n    nextDirId,\r\n    nextDirFileId\r\n  ]);\r\n  const onLastImage = useCallback(() => {\r\n    const newIndex = files.length - 1;\r\n    if (files[newIndex] && files[newIndex].id) {\r\n      setFileId(files[newIndex].id || '');\r\n      setIsScrollToBottom(false);\r\n    }\r\n  }, [\r\n    files\r\n  ]);\r\n\r\n  const onSelect = useCallback((fileId: string) => {\r\n    setFileId(fileId);\r\n    setIsScrollToBottom(false);\r\n  }, []);\r\n  useEffect(() => {\r\n    if (!isSlideshowEnabled && isSlideshowPlaying) {\r\n      setSlideshowPlaying(false);\r\n    }\r\n  }, [\r\n    isSlideshowEnabled,\r\n    isSlideshowPlaying\r\n  ]);\r\n  const onToggleSlideshowPlaying = useCallback(() => {\r\n    setSlideshowPlaying(current => !current);\r\n  }, []);\r\n  const onDownloadFile = useCallback(() => {\r\n    const activeFile = files[activeIndex];\r\n    if (activeFile && activeFile.name && activeFile.webContentLink) {\r\n      const name = activeFile.name;\r\n      const url = activeFile.webContentLink;\r\n      const a = document.createElement('a');\r\n      a.download = name;\r\n      a.href = url;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n    }\r\n  }, [\r\n    activeIndex,\r\n    files\r\n  ]);\r\n  const onCloseFile = useCallback(() => {\r\n    setFileId('');\r\n    setParentId('');\r\n    setIsScrollToBottom(false);\r\n  }, []);\r\n  const onSignOut = useCallback(() => {\r\n    onCloseFile();\r\n    clear();\r\n    localStorage.clear();\r\n  }, [\r\n    onCloseFile,\r\n    clear\r\n  ]);\r\n\r\n  const viewFiles = useMemo(() => {\r\n    if (activeIndex < 0 || files.length <= 0) {\r\n      return [];\r\n    }\r\n    const activeFile = files[activeIndex];\r\n    const preloadFiles = new Set<gapi.client.drive.File>();\r\n    for (let i = 1; i <= preloadCount; i++) {\r\n      const file = files[activeIndex + i];\r\n      if (file) {\r\n        preloadFiles.add(file);\r\n      }\r\n    }\r\n    for (let i = 1; i <= preloadCount; i++) {\r\n      const file = files[activeIndex - i];\r\n      if (file) {\r\n        preloadFiles.add(file);\r\n      }\r\n    }\r\n    for (let i = 0; i < preloadCount; i++) {\r\n      const file = files[i];\r\n      if (file) {\r\n        preloadFiles.add(file);\r\n      }\r\n    }\r\n    for (let i = files.length - 1; i >= files.length - preloadCount; i--) {\r\n      const file = files[i];\r\n      if (file) {\r\n        preloadFiles.add(file);\r\n      }\r\n    }\r\n    for (let i of visibleThumbnails) {\r\n      const file = files[i];\r\n      if (file) {\r\n        preloadFiles.add(file);\r\n      }\r\n    }\r\n    preloadFiles.delete(activeFile);\r\n    return [activeFile].concat(Array.from(preloadFiles));\r\n  }, [\r\n    activeIndex,\r\n    files,\r\n    visibleThumbnails\r\n  ]);\r\n\r\n  const viewerRef = useRef<ViewerRef>(null);\r\n  const onToggleFullscreen = useCallback(() => {\r\n    if (viewerRef.current) {\r\n      viewerRef.current.toggleFullscreen();\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const onKeyDown = (e: KeyboardEvent) => {\r\n      switch (e.key) {\r\n        case 'Home': {\r\n          onFirstImage();\r\n          break;\r\n        }\r\n        case 'ArrowLeft': {\r\n          onPrevImage();\r\n          break;\r\n        }\r\n        case 'ArrowRight': {\r\n          onNextImage();\r\n          break;\r\n        }\r\n        case 'End': {\r\n          onLastImage();\r\n          break;\r\n        }\r\n        case ' ': {\r\n          onToggleSlideshowPlaying();\r\n          break;\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', onKeyDown);\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', onKeyDown);\r\n    };\r\n  }, [\r\n    onFirstImage,\r\n    onPrevImage,\r\n    onNextImage,\r\n    onLastImage,\r\n    onToggleSlideshowPlaying\r\n  ]);\r\n\r\n  return (\r\n    <Box sx={{ display: 'flex' }}>\r\n      <AppBar position='fixed' sx={{ zIndex: (theme) => theme.zIndex.drawer + 1 }}>\r\n        <Topbar\r\n          title={title}\r\n          counterTitle={counterTitle}\r\n          fitMode={fitMode}\r\n          onFitModeChange={setFitMode}\r\n          onOpenFile={onOpenFile}\r\n          onRecentFile={onOpenFile}\r\n          fullscreenButtonActive={files.length > 0}\r\n          onToggleFullscreen={onToggleFullscreen}\r\n          isFirstImageEnabled={isFirstImageEnabled}\r\n          isPrevImageEnabled={isPrevImageEnabled}\r\n          isNextImageEnabled={isNextImageEnabled}\r\n          isLastImageEnabled={isLastImageEnabled}\r\n          isSlideshowEnabled={isSlideshowEnabled}\r\n          isSlideshowPlaying={isSlideshowPlaying}\r\n          onToggleSlideshowPlaying={onToggleSlideshowPlaying}\r\n          onFirstImage={onFirstImage}\r\n          onPrevImage={onPrevImage}\r\n          onNextImage={onNextImage}\r\n          onLastImage={onLastImage}\r\n          recentFiles={recentFiles}\r\n          onDownloadFile={onDownloadFile}\r\n          onCloseFile={onCloseFile}\r\n          onSignOut={onSignOut}\r\n          isMobileDrawerOpen={isMobileDrawerOpen}\r\n          toggleMobileDrawer={toggleMobileDrawer}\r\n        />\r\n      </AppBar>\r\n      {isSmallScreen ?\r\n        <SwipeableDrawer\r\n          anchor='left'\r\n          open={isMobileDrawerOpen}\r\n          onOpen={toggleMobileDrawer}\r\n          onClose={toggleMobileDrawer}\r\n          sx={{\r\n            width: drawerWidth,\r\n            flexShrink: 0,\r\n            [`& .MuiDrawer-paper`]: {\r\n              width: drawerWidth,\r\n              boxSizing: 'border-box'\r\n            },\r\n            display: 'flex',\r\n            flexDirection: 'column'\r\n          }}\r\n          ModalProps={{\r\n            keepMounted: true,\r\n          }}\r\n        >\r\n          <Toolbar />\r\n          <Thumbnails\r\n            files={files}\r\n            fileId={fileId}\r\n            onSelect={onSelect}\r\n            onVisibleFiles={setVisibleThumbnails}\r\n            sx={{\r\n              flexGrow: 1\r\n            }}\r\n          />\r\n        </SwipeableDrawer> :\r\n        <Drawer\r\n          variant='permanent'\r\n          sx={{\r\n            width: drawerWidth,\r\n            flexShrink: 0,\r\n            [`& .MuiDrawer-paper`]: {\r\n              width: drawerWidth,\r\n              boxSizing: 'border-box'\r\n            },\r\n            display: 'flex',\r\n            flexDirection: 'column'\r\n          }}\r\n        >\r\n          <Toolbar />\r\n          <Thumbnails\r\n            files={files}\r\n            fileId={fileId}\r\n            onSelect={onSelect}\r\n            onVisibleFiles={setVisibleThumbnails}\r\n            sx={{\r\n              flexGrow: 1\r\n            }}\r\n          />\r\n        </Drawer>\r\n      }\r\n      <Box component='main' sx={{\r\n        flexGrow: 1,\r\n        height: '100vh',\r\n        display: 'flex',\r\n        flexDirection: 'column'\r\n      }}>\r\n        <Toolbar />\r\n        {files.length > 0 &&\r\n          <Viewer\r\n            fitMode={fitMode}\r\n            files={viewFiles}\r\n            onPrevImage={onPrevImage}\r\n            onNextImage={onNextImage}\r\n            onFitModeChange={setFitMode}\r\n            isScrollToBottom={isScrollToBottom}\r\n            isSlideshowEnabled={isSlideshowEnabled}\r\n            isSlideshowPlaying={isSlideshowPlaying}\r\n            onToggleSlideshowPlaying={onToggleSlideshowPlaying}\r\n            sx={{\r\n              flexGrow: 1\r\n            }}\r\n            ref={viewerRef}\r\n          />\r\n        }\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default View;\r\n","import {\r\n  useCallback,\r\n  useEffect,\r\n  useMemo,\r\n  useRef,\r\n  useState\r\n} from 'react';\r\nimport {\r\n  DirectoryEdge,\r\n  getEdgeFiles,\r\n  getParent,\r\n  getProfile,\r\n  isSignedIn,\r\n  listDirectories,\r\n  listFiles,\r\n  signIn,\r\n  signOut,\r\n  subscribeToGapiErrors,\r\n  subscribeToSignedInChange,\r\n  getGapiError,\r\n  Profile\r\n} from './api';\r\nimport Screenfull from './screenfull';\r\nimport { useTheme } from '@material-ui/core/styles';\r\nimport { useMediaQuery } from '@material-ui/core';\r\n\r\nconst recentLocalStorageKey = 'recent';\r\nconst recentLength = 10;\r\n\r\nconst useAbortSignal = () => {\r\n  const abortControllerRef = useRef(new AbortController());\r\n\r\n  useEffect(() => {\r\n    const abortController = abortControllerRef.current;\r\n    return () => {\r\n      abortController.abort();\r\n    };\r\n  }, []);\r\n\r\n  return abortControllerRef.current.signal;\r\n};\r\n\r\nconst useIsSignedIn = (onSignOut?: () => void) => {\r\n  const [ signedIn, setSignedIn ] = useState(isSignedIn());\r\n  const [ profile, setProfile ] = useState<Profile | null>(null);\r\n  const [ gapiError, setGapiError ] = useState(getGapiError());\r\n  const [ isCookiesError, setCookiesError ] = useState(false);\r\n  \r\n  useEffect(() => {\r\n    return subscribeToSignedInChange(setSignedIn);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    return subscribeToGapiErrors(setGapiError);\r\n  }, []);\r\n\r\n  const toggleSignedIn = useCallback(() => {\r\n    // console.log('toggleSignedIn');\r\n    if (!signedIn) {\r\n      signIn();\r\n    } else {\r\n      if (onSignOut) {\r\n        onSignOut();\r\n      }\r\n      signOut();\r\n    }\r\n  }, [\r\n    signedIn,\r\n    onSignOut\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (signedIn) {\r\n      const profile = getProfile();\r\n      setProfile(profile);\r\n    } else {\r\n      setProfile(null);\r\n    }\r\n  }, [\r\n    signedIn\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (gapiError && gapiError.details &&\r\n      gapiError.details === 'Cookies are not enabled in current environment.'\r\n    ) {\r\n      setCookiesError(true);\r\n    } else {\r\n      setCookiesError(false);\r\n    }\r\n  }, [\r\n    gapiError\r\n  ]);\r\n\r\n  return {\r\n    isSignedIn: signedIn,\r\n    toggleSignedIn,\r\n    profile,\r\n    isCookiesError\r\n  };\r\n};\r\n\r\nconst useFiles = (parentId?: string) => {\r\n  const [ files, setFiles ] = useState<gapi.client.drive.File[]>([]);\r\n  const [ pageToken, setPageToken ] = useState<string | undefined>();\r\n  const signal = useAbortSignal();\r\n  const parentIdRef = useRef<string | undefined>(parentId);\r\n\r\n  useEffect(() => {\r\n    if (parentId !== parentIdRef.current) {\r\n      setFiles([]);\r\n      parentIdRef.current = parentId;\r\n    }\r\n  }, [\r\n    parentId\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const run = async () => {\r\n      if (!parentId) {\r\n        return;\r\n      }\r\n      try {\r\n        const result = await listFiles({\r\n          parentId,\r\n          pageToken\r\n        });\r\n        if(!signal.aborted && result) {\r\n          setFiles(prevFiles => prevFiles.concat(result.files || []))\r\n          if (result.nextPageToken) {\r\n            setPageToken(result.nextPageToken);\r\n          }\r\n        }\r\n      }\r\n      catch(err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n\r\n    if (parentId) {\r\n      run();\r\n    }\r\n  }, [\r\n    pageToken,\r\n    parentId,\r\n    signal\r\n  ]);\r\n  \r\n  return files;\r\n};\r\n\r\nconst useDirectory = (parentId?: string) => {\r\n  const [\r\n    directory,\r\n    setDirectory\r\n  ] = useState<gapi.client.drive.File | null>(null);\r\n  const signal = useAbortSignal();\r\n\r\n  useEffect(() => {\r\n    const run = async () => {\r\n      if (!parentId) {\r\n        return;\r\n      }\r\n      try {\r\n        const directory = await getParent(parentId);\r\n        if(!signal.aborted && directory) {\r\n          setDirectory(directory);\r\n        }\r\n      }\r\n      catch(err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n\r\n    if (parentId) {\r\n      run();\r\n    }\r\n  }, [\r\n    parentId,\r\n    signal\r\n  ]);\r\n  \r\n  return directory;\r\n};\r\n\r\nconst useFullScreen = () => {\r\n  const [ isFullscreen, setFullscreen ] = useState(Screenfull.isFullscreen);\r\n  const [ isEnabled ] = useState(Screenfull.isEnabled);\r\n\r\n  useEffect(() => {\r\n    if (!Screenfull.isEnabled) {\r\n      return;\r\n    }\r\n    const run = () => {\r\n      const isFullscreen = Screenfull.isFullscreen;\r\n      setFullscreen(isFullscreen);\r\n    };\r\n    run();\r\n    Screenfull.on('change', run);\r\n    return () => {\r\n      Screenfull.off('change', run);\r\n    };\r\n  }, []);\r\n\r\n  const toggleFullScreen = useCallback((div?: HTMLDivElement | null) => {\r\n    const run = async () => {\r\n      if (!Screenfull.isEnabled) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        Screenfull.toggle(div || undefined);\r\n      }\r\n      catch (err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n    run();\r\n  }, []);\r\n\r\n  return {\r\n    isEnabled,\r\n    isFullscreen,\r\n    toggleFullScreen\r\n  };\r\n};\r\n\r\ninterface UseEdgeFileIdOptions {\r\n  parentId?: string;\r\n  edge: DirectoryEdge;\r\n};\r\n\r\nconst useEdgeFileId = (options: UseEdgeFileIdOptions) => {\r\n  const {\r\n    parentId,\r\n    edge\r\n  } = options;\r\n  const [ edgeFileId, setEdgeFileId ] = useState('');\r\n  const signal = useAbortSignal();\r\n\r\n  useEffect(() => {\r\n    const run = async () => {\r\n      if (!parentId) {\r\n        return;\r\n      }\r\n      try {\r\n        const edgeFiles = await getEdgeFiles({\r\n          parentId,\r\n          edge\r\n        });\r\n        if(!signal.aborted){\r\n          if (edgeFiles && edgeFiles.length && edgeFiles[0].id) {\r\n            setEdgeFileId(edgeFiles[0].id);\r\n          } else {\r\n            setEdgeFileId('');\r\n          }\r\n        }\r\n      }\r\n      catch(err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n\r\n    if (parentId) {\r\n      run();\r\n    } else {\r\n      setEdgeFileId('');\r\n    }\r\n  }, [\r\n    parentId,\r\n    edge,\r\n    signal\r\n  ]);\r\n  \r\n  return edgeFileId;\r\n};\r\n\r\nconst useDirectories = (grandParentId?: string) => {\r\n  const [\r\n    directories,\r\n    setDirectories\r\n  ] = useState<gapi.client.drive.File[]>([]);\r\n  const signal = useAbortSignal();\r\n\r\n  useEffect(() => {\r\n    const run = async () => {\r\n      if (!grandParentId) {\r\n        return;\r\n      }\r\n      try {\r\n        const result = await listDirectories(grandParentId);\r\n        if(!signal.aborted && result) {\r\n          setDirectories(result.files || [])\r\n        }\r\n      }\r\n      catch(err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n\r\n    if (grandParentId) {\r\n      run();\r\n    }\r\n  }, [\r\n    grandParentId,\r\n    signal\r\n  ]);\r\n  \r\n  return directories;\r\n};\r\n\r\nconst useDrive = (parentId?: string) => {\r\n  const [ prevDirId, setPrevDirId ] = useState('');\r\n  const [ nextDirId, setNextDirId ] = useState('');\r\n  \r\n  const prevDirFileId = useEdgeFileId({\r\n    parentId: prevDirId,\r\n    edge: DirectoryEdge.End\r\n  });\r\n  const files = useFiles(parentId);\r\n  const nextDirFileId = useEdgeFileId({\r\n    parentId: nextDirId,\r\n    edge: DirectoryEdge.Begin\r\n  });\r\n  const directory = useDirectory(parentId);\r\n  const directories = useDirectories(\r\n    (directory && directory.parents) ?\r\n      directory.parents[0] :\r\n      ''\r\n  );\r\n  const directoryIndex = useMemo(() => {\r\n    return directories.findIndex(sibling => sibling.id === parentId);\r\n  }, [\r\n    parentId,\r\n    directories\r\n  ]);\r\n  const directoryId = useMemo(() => {\r\n    return directory ? (directory.id as string || '') : '';\r\n  }, [\r\n    directory\r\n  ]);\r\n  const directoryName = useMemo(() => {\r\n    return directory ? (directory.name as string || '') : '';\r\n  }, [\r\n    directory\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (directoryIndex >= 0) {\r\n      const prev = directories[directoryIndex - 1];\r\n      if (prev && prev.id) {\r\n        setPrevDirId(prev.id);\r\n      }\r\n      const next = directories[directoryIndex + 1];\r\n      if (next && next.id) {\r\n        setNextDirId(next.id);\r\n      }\r\n    }\r\n  }, [\r\n    directories,\r\n    directoryIndex\r\n  ]);\r\n\r\n  return {\r\n    files,\r\n    directoryId,\r\n    directoryName,\r\n    prevDirId,\r\n    prevDirFileId,\r\n    nextDirId,\r\n    nextDirFileId\r\n  }\r\n};\r\n\r\n\r\nexport interface RecentFile {\r\n  id: string;\r\n  parentId: string;\r\n  title: string;\r\n};\r\n\r\nconst useRecentFiles = () => {\r\n  const [ recentFiles, setRecentFiles ] = useState<RecentFile[]>([]);\r\n  const recentJsonRef = useRef<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const recentJson = localStorage.getItem(recentLocalStorageKey);\r\n    recentJsonRef.current = recentJson;\r\n\r\n    if (recentJson) {\r\n      setRecentFiles(JSON.parse(recentJson));\r\n    }\r\n  }, []);\r\n\r\n  const replace = useCallback((file: RecentFile) => {\r\n    setRecentFiles(\r\n      current => [file].concat(current.slice(1))\r\n    );\r\n  }, []);\r\n  const shift = useCallback((file: RecentFile) => {\r\n    setRecentFiles(\r\n      current => [file].concat(current.slice(0, recentLength - 1))\r\n    );\r\n  }, []);\r\n  const clear = useCallback(() => {\r\n    setRecentFiles([]);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (recentFiles.length > 0) {\r\n      const recentJson = JSON.stringify(recentFiles);\r\n  \r\n      if (recentJson !== recentJsonRef.current) {\r\n        localStorage.setItem(recentLocalStorageKey, recentJson);\r\n        recentJsonRef.current = recentJson;\r\n      }\r\n    } else {\r\n      if (localStorage.getItem(recentLocalStorageKey)) {\r\n        localStorage.removeItem(recentLocalStorageKey);\r\n        recentJsonRef.current = null\r\n      }\r\n    }\r\n  }, [\r\n    recentFiles\r\n  ]);\r\n\r\n  return {\r\n    recentFiles,\r\n    replace,\r\n    shift,\r\n    clear\r\n  };\r\n};\r\n\r\nconst useIsSmallScreen = () => {\r\n  const theme = useTheme();\r\n  const isSmallScreen = useMediaQuery(theme.breakpoints.down('md'));\r\n  return isSmallScreen;\r\n};\r\n\r\nexport {\r\n  useAbortSignal,\r\n  useIsSignedIn,\r\n  useFiles,\r\n  useDirectory,\r\n  useFullScreen,\r\n  useDrive,\r\n  useRecentFiles,\r\n  useIsSmallScreen,\r\n};\r\n","import {\r\n  useState,\r\n  useEffect,\r\n  useRef,\r\n  useCallback\r\n} from 'react';\r\nimport { useAbortSignal } from '../../../../lib/hooks';\r\n\r\nconst useDebounce = <T>(value: T, delay: number) => {\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n\r\n  useEffect(\r\n    () => {\r\n      const timeout = setTimeout(() => {\r\n        setDebouncedValue(value);\r\n      }, delay);\r\n      return () => {\r\n        clearTimeout(timeout);\r\n      };\r\n    },\r\n    [value, delay]\r\n  );\r\n\r\n  return debouncedValue;\r\n};\r\n\r\nconst useScrollAware = () => {\r\n  const [scrollTop, setScrollTop] = useState(0);\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  const signal = useAbortSignal();\r\n\r\n  useEffect(() => {\r\n    const scrollContainer = ref.current;\r\n    if (!scrollContainer) {\r\n      return;\r\n    }\r\n\r\n    const onScroll = (e: Event) => {\r\n      const div = e.target as HTMLDivElement;\r\n      if (div && !signal.aborted) {\r\n        setScrollTop(+div.scrollTop);\r\n      }\r\n    };\r\n\r\n    setScrollTop(scrollContainer.scrollTop);\r\n    scrollContainer.addEventListener('scroll', onScroll);\r\n    return () => scrollContainer.removeEventListener('scroll', onScroll);\r\n  }, [\r\n    signal\r\n  ]);\r\n\r\n  return {\r\n    scrollTop,\r\n    ref\r\n  };\r\n};\r\n\r\ninterface RectSize {\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nconst useRectSize = () => {\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  const [ rectSize, setRectSize ] = useState({\r\n    width: 0,\r\n    height: 0\r\n  } as RectSize);\r\n  const debouncedRectSize = useDebounce(rectSize, 150);\r\n  const signal = useAbortSignal();\r\n\r\n  const check = useCallback(async () => {\r\n    requestAnimationFrame(() => {\r\n      const div = ref.current;\r\n      if (div && !signal.aborted) {\r\n        setRectSize({\r\n          width: div.offsetWidth,\r\n          height: div.offsetHeight\r\n        } as RectSize)\r\n      }\r\n    });\r\n  }, [\r\n    signal\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    check();\r\n    window.addEventListener('resize', check);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', check);\r\n    };\r\n  }, [\r\n    check,\r\n    signal\r\n  ]);\r\n\r\n\r\n  return {\r\n    ref,\r\n    rectSize: debouncedRectSize\r\n  };\r\n};\r\n\r\nexport {\r\n  useDebounce,\r\n  useScrollAware,\r\n  useRectSize\r\n}\r\n","const easeInOutSine = (\r\n  time: number, \r\n  timeFrom: number,\r\n  timeTo: number,\r\n  valFrom: number,\r\n  valTo: number,\r\n) => -(valTo - valFrom) / 2 * (\r\n  Math.cos(Math.PI * (time - timeFrom) / (timeTo - timeFrom)) - 1\r\n) + valFrom;\r\n\r\nconst easeInOutCap = (\r\n  time: number, \r\n  timeFrom: number,\r\n  timeCapFraction: number,\r\n  timeTo: number,\r\n  valFrom: number,\r\n  valCap: number,\r\n  valTo: number,\r\n) => {\r\n  const timeCap = timeFrom + (timeTo - timeFrom) * timeCapFraction;\r\n\r\n  // console.log({\r\n  //   time, \r\n  //   timeFrom,\r\n  //   timeCap,\r\n  //   timeTo,\r\n  //   valFrom,\r\n  //   valCap,\r\n  //   valTo\r\n  // });\r\n  if (time < timeCap) {\r\n    return easeInOutSine(time, timeFrom, timeCap, valFrom, valCap);\r\n  } else if (time < timeTo - timeCap) {\r\n    return valCap;\r\n  } else {\r\n    return easeInOutSine(time, timeTo - timeCap, timeTo, valCap, valTo);\r\n  }\r\n};\r\n\r\nexport {\r\n  easeInOutSine,\r\n  easeInOutCap\r\n};\r\n","import React, {\r\n  useCallback,\r\n  useEffect,\r\n  useMemo,\r\n} from 'react';\r\nimport {\r\n  Box,\r\n} from '@material-ui/core';\r\nimport {\r\n  SystemStyleObject\r\n} from '@material-ui/system';\r\nimport { useDebounce, useRectSize } from '../../../../view/components/thumbnails/hooks';\r\nimport { easeInOutCap, easeInOutSine } from './helpers';\r\n\r\nconst cellToSlideRatio = 1.3;\r\nconst numColumns = 5;\r\nconst slidePadding = 1;\r\nconst jumpCapRatio = 1.5;\r\nconst jumpCapFraction = 0.3;\r\n\r\ninterface SlideWithCoordinates {\r\n  row: number;\r\n  column: number;\r\n  shift: number[];\r\n  slide: JSX.Element;\r\n};\r\n\r\ninterface SpaceProps {\r\n  slides: JSX.Element[];\r\n  slideHeight: number;\r\n  jumpHeight: number;\r\n  scrollTop: number;\r\n  isJumping: boolean;\r\n  setJumping: (isJumping: boolean) => void;\r\n  sx?: SystemStyleObject;\r\n};\r\n\r\nconst Space: React.FC<SpaceProps> = (props) => {\r\n  const {\r\n    slides,\r\n    slideHeight,\r\n    jumpHeight,\r\n    scrollTop,\r\n    isJumping,\r\n    setJumping,\r\n    sx\r\n  } = props;\r\n\r\n  const cellSize = useMemo(() => {\r\n    return slideHeight * cellToSlideRatio\r\n  }, [\r\n    slideHeight\r\n  ]);\r\n  const randomShift = useCallback(() => {\r\n    return [\r\n      Math.random() * cellSize / 2,\r\n      Math.random() * cellSize / 2,\r\n      Math.random() * cellSize / 2\r\n    ];\r\n  }, [\r\n    cellSize\r\n  ]);\r\n  const slidesWithCoordinates = useMemo(() => {\r\n    const list = [] as SlideWithCoordinates[];\r\n    const hash = new Map<number, SlideWithCoordinates>();\r\n    for (let i = 0; i < slides.length; i++) {\r\n      const slide = slides[i];\r\n      const row = (slidePadding * 2 + 1) * i + slidePadding;\r\n      const column = Math.floor(\r\n        (numColumns - slidePadding * 2) * Math.random()\r\n      ) + slidePadding;\r\n      const key = row * numColumns + column;\r\n      const slideWithCoordinates = {\r\n        row,\r\n        column,\r\n        shift: randomShift(),\r\n        slide\r\n      };\r\n      list.push(slideWithCoordinates);\r\n      hash.set(key, slideWithCoordinates);\r\n    }\r\n    return {\r\n      list,\r\n      hash\r\n    };\r\n  }, [\r\n    randomShift,\r\n    slides\r\n  ]);\r\n\r\n  const cells = useMemo(() => {\r\n    const cells = [] as JSX.Element[];\r\n    const numRows = slides.length * (slidePadding * 2 + 1);\r\n    for (let i = 0; i < numRows; i++) {\r\n      for (let j = 0; j < numColumns; j++) {\r\n        const key = i * numColumns + j;\r\n        const slideWithCoordinates = slidesWithCoordinates.hash.get(key);\r\n        if (slideWithCoordinates) {\r\n          const {\r\n            slide,\r\n            shift\r\n          } = slideWithCoordinates;\r\n          const dx = cellSize * j + shift[0];\r\n          const dy = cellSize * i + shift[1];\r\n          const dz = shift[2];\r\n          cells.push(\r\n            <Box\r\n              key={key}\r\n              sx={{\r\n                transform: `translate3d(${dx}px, ${dy}px, ${dz}px)`,\r\n                position: 'absolute',\r\n                width: '100%'\r\n              }}\r\n            >\r\n              {slide}\r\n            </Box>\r\n          );\r\n        } else {\r\n          const shift = randomShift();\r\n          const dx = cellSize * j + shift[0];\r\n          const dy = cellSize * i + shift[1];\r\n          const dz = shift[2];\r\n          cells.push(\r\n            <Box\r\n              key={key}\r\n              component='img'\r\n              src={`https://picsum.photos/300/400?random=${key}`}\r\n              loading='lazy'\r\n              sx={{\r\n                height: `${slideHeight}px`,\r\n                width: 'auto',\r\n                transform: `translate3d(${dx}px, ${dy}px, ${dz}px)`,\r\n                position: 'absolute',\r\n              }}\r\n            />\r\n          );\r\n        }\r\n      }\r\n    }\r\n    return cells;\r\n  }, [\r\n    slideHeight,\r\n    cellSize,\r\n    randomShift,\r\n    slides.length,\r\n    slidesWithCoordinates\r\n  ]);\r\n\r\n  const {\r\n    rectSize,\r\n    ref\r\n  } = useRectSize();\r\n  const calculateShift = useCallback((scrollTop: number) => {\r\n    const scrollMax = slideHeight + jumpHeight;\r\n    const slideIndex = Math.floor(scrollTop / scrollMax);\r\n    const scroll = scrollTop % scrollMax;\r\n    const scrollJump = slideHeight - rectSize.height;\r\n    if (scroll <= scrollJump ||\r\n      slideIndex >= slidesWithCoordinates.list.length - 1\r\n    ) {\r\n      const curr = slidesWithCoordinates.list[slideIndex];\r\n      const currX = cellSize * curr.column + curr.shift[0];\r\n      const currY = cellSize * curr.row + curr.shift[1];\r\n      const currZ = curr.shift[2];\r\n      return [\r\n        -currX,\r\n        -currY - scroll,\r\n        -currZ\r\n      ];\r\n    } else {\r\n      const prev = slidesWithCoordinates.list[slideIndex];\r\n      const next = slidesWithCoordinates.list[slideIndex + 1];\r\n      const prevX = cellSize * prev.column + prev.shift[0];\r\n      const prevY = cellSize * prev.row + prev.shift[1] + scrollJump;\r\n      const prevZ = prev.shift[2];\r\n      const nextX = cellSize * next.column + next.shift[0];\r\n      const nextY = cellSize * next.row + next.shift[1];\r\n      const nextZ = next.shift[2];\r\n      const x = easeInOutSine(scroll, scrollJump, scrollMax, prevX, nextX);\r\n      const y = easeInOutSine(scroll, scrollJump, scrollMax, prevY, nextY);\r\n      const z = easeInOutCap(\r\n        scroll,\r\n        scrollJump,\r\n        jumpCapFraction,\r\n        scrollMax,\r\n        prevZ,\r\n        slideHeight * jumpCapRatio,\r\n        nextZ\r\n      );\r\n\r\n      // console.log({\r\n      //   scroll,\r\n      //   scrollJump,\r\n      //   scrollMax,\r\n      //   prev,\r\n      //   next,\r\n      //   prevX,\r\n      //   prevY,\r\n      //   prevZ,\r\n      //   nextX,\r\n      //   nextY,\r\n      //   nextZ,\r\n      //   x,\r\n      //   y,\r\n      //   z\r\n      // });\r\n      return [\r\n        -x,\r\n        -y,\r\n        -z\r\n      ];\r\n    }\r\n  }, [\r\n    slideHeight,\r\n    jumpHeight,\r\n    rectSize.height,\r\n    cellSize,\r\n    slidesWithCoordinates\r\n  ]);\r\n  const planeShift = calculateShift(scrollTop);\r\n\r\n  useEffect(() => {\r\n    const scrollJump = slideHeight - rectSize.height;\r\n    if (scrollTop % (slideHeight + jumpHeight) > scrollJump) {\r\n      setJumping(true);\r\n    }\r\n  }, [\r\n    slideHeight,\r\n    jumpHeight,\r\n    rectSize.height,\r\n    setJumping,\r\n    scrollTop\r\n  ]);\r\n  const debouncedSrollTop = useDebounce(scrollTop, 1000);\r\n  useEffect(() => {\r\n    const scrollJump = slideHeight - rectSize.height;\r\n    if (debouncedSrollTop % (slideHeight + jumpHeight) <= scrollJump) {\r\n      setJumping(false);\r\n    }\r\n  }, [\r\n    slideHeight,\r\n    jumpHeight,\r\n    rectSize.height,\r\n    setJumping,\r\n    debouncedSrollTop\r\n  ]);\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        ...sx,\r\n        backgroundColor: 'black',\r\n        perspective: '25vh',\r\n        willChange: 'transform'\r\n      }}\r\n      ref={ref}\r\n    >\r\n      <Box\r\n        sx={{\r\n          position: 'relative',\r\n          transformStyle: 'preserve-3d',\r\n          transform: `translate3d(${planeShift\r\n            .map(shift => `${shift}px`)\r\n            .join(',')\r\n          })`,\r\n          transition: isJumping ? 'transform 1s ease-out' : undefined\r\n        }}\r\n      >\r\n        {cells}\r\n      </Box>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Space;\r\n","import React, { useState } from 'react';\r\nimport {\r\n  Box, Toolbar\r\n} from '@material-ui/core';\r\nimport Comix, {\r\n  slides,\r\n  jumpHeight\r\n} from './comix';\r\nimport Space from './space';\r\nimport { useScrollAware } from './hooks';\r\n\r\nconst Landing: React.FC = () => {\r\n  const scrollTop = useScrollAware();\r\n  const slideHeight = Math.round(2.03 * document.documentElement.clientHeight);\r\n  const [ isJumping, setJumping ] = useState(false);\r\n\r\n  return (\r\n    <Box>\r\n      <Box\r\n        sx={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          left: 0,\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          zIndex: isJumping ? undefined : -1\r\n        }}\r\n      >\r\n        <Toolbar/>\r\n        <Space\r\n          scrollTop={scrollTop}\r\n          slideHeight={slideHeight}\r\n          jumpHeight={jumpHeight}\r\n          slides={slides}\r\n          isJumping={isJumping}\r\n          setJumping={setJumping}\r\n          sx={{\r\n            flexGrow: 1,\r\n            overflow: 'hidden',\r\n            visibility: isJumping ? 'visible' : 'hidden'\r\n          }}\r\n        />\r\n      </Box>\r\n      <Comix\r\n        sx={{\r\n          visibility: isJumping ? 'hidden' : 'visible'\r\n        }}\r\n      />\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Landing;\r\n","import {\r\n  useState,\r\n  useEffect,\r\n} from 'react';\r\nimport { useAbortSignal } from '../../../../lib/hooks';\r\n\r\nconst useScrollAware = () => {\r\n  const [scrollTop, setScrollTop] = useState(0);\r\n  const signal = useAbortSignal();\r\n\r\n  useEffect(() => {\r\n    const onScroll = () => {\r\n      if (!signal.aborted) {\r\n        setScrollTop(+document.documentElement.scrollTop);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('scroll', onScroll);\r\n    return () => document.removeEventListener('scroll', onScroll);\r\n  }, [\r\n    signal\r\n  ]);\r\n\r\n  return scrollTop;\r\n};\r\n\r\nexport {\r\n  useScrollAware,\r\n}\r\n","import React, {\r\n} from 'react';\r\nimport {\r\n  AppBar,\r\n  Box,\r\n  Toolbar,\r\n} from '@material-ui/core';\r\nimport Topbar from './components/topbar';\r\nimport Landing from './components/landing';\r\n\r\nconst Home: React.FC = () => {\r\n  return (\r\n    <Box>\r\n      <AppBar position='fixed' sx={{ zIndex: (theme) => theme.zIndex.drawer + 1 }}>\r\n        <Topbar/>\r\n      </AppBar>\r\n      <Box component='main'>\r\n        <Toolbar />\r\n        <Landing />\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default Home;\r\n","import React from 'react';\r\n\r\nimport {\r\n  Box,\r\n  ImageListItemBar\r\n} from '@material-ui/core';\r\n\r\ninterface ThumbnailProps {\r\n  file: gapi.client.drive.File;\r\n  counter: number,\r\n  isActive: boolean;\r\n  onClick: () => void;\r\n}\r\n\r\nconst Thumbnail: React.FC<ThumbnailProps> = (props: ThumbnailProps) => {\r\n  const {\r\n    file,\r\n    counter,\r\n    isActive,\r\n    onClick\r\n  } = props;\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        height: 220,\r\n        width: 220,\r\n        borderRadius: '6px',\r\n        boxSizing: 'border-box',\r\n        overflow: 'hidden',\r\n        display: 'grid',\r\n        alignContent: 'center',\r\n        justifyContent: 'center',\r\n        position: 'relative',\r\n        ...(isActive ?\r\n          {\r\n            bgcolor: 'common.black'\r\n          } :\r\n          {\r\n            border: '1px solid #dadce0'\r\n          }\r\n        )\r\n      }}\r\n      onClick={onClick}\r\n    >\r\n      <img\r\n        src={file.thumbnailLink}\r\n        alt={file.name}\r\n      />\r\n      <ImageListItemBar\r\n        title={file.name}\r\n        subtitle={`#${counter}`}\r\n        sx={{\r\n          ...(!isActive &&\r\n            {\r\n              background: 'rgba(255, 255, 255, 0.5)',\r\n              [`& .MuiImageListItemBar-titleWrap`]: {\r\n                color: 'common.black'\r\n              }\r\n            }\r\n          )\r\n        }}\r\n      />\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Thumbnail;\r\n","import React, {\r\n  useMemo,\r\n  useEffect,\r\n  useCallback,\r\n  forwardRef,\r\n  useImperativeHandle\r\n} from 'react';\r\nimport './VirtualGrid.css';\r\nimport { useScrollAware } from './hooks';\r\n\r\nexport interface ItemProps {\r\n  index: number;\r\n}\r\n\r\ntype ScrollToBlock = 'center' | 'smart';\r\n\r\nexport interface VirtualGridRef {\r\n  scrollToIndex: (index: number, block?:  ScrollToBlock) => void;\r\n}\r\n\r\ninterface VirtualGridProps {\r\n  Item: React.FC<ItemProps>;\r\n  itemsCount: number;\r\n  height: number;\r\n  itemHeight: number;\r\n  rowsAhead: number;\r\n  rowGap?: number;\r\n  columnGap?: number;\r\n  width?: number;\r\n  itemWidth?: number;\r\n  className?: string;\r\n  scrollBar?: 'right' | 'left' | 'none',\r\n  scrollToIndex?: number;\r\n  onVisibleRows?: (rows: number[]) => void;\r\n  center?: boolean;\r\n}\r\n\r\nconst scrollBarWidth = 19;\r\n\r\nconst VirtualGrid = forwardRef<VirtualGridRef, VirtualGridProps>(\r\n  (props, scrollRef) => {\r\n  const {\r\n    Item,\r\n    height,\r\n    itemHeight,\r\n    itemsCount,\r\n    rowsAhead,\r\n    rowGap = 0,\r\n    columnGap = 0,\r\n    width,\r\n    itemWidth,\r\n    scrollBar = 'right',\r\n    scrollToIndex,\r\n    onVisibleRows,\r\n    center = false\r\n  } = props;\r\n\r\n  const className = 'VirtualGrid '.concat(\r\n    props.className ? `${props.className} ` : '',\r\n    `VirtualGrid--${scrollBar}`\r\n  );\r\n\r\n  const itemsInRow = (width && itemWidth && width > itemWidth) ?\r\n    Math.floor((width + columnGap - scrollBarWidth) /\r\n    (itemWidth + columnGap)) : 1;\r\n  const rowsCount = Math.ceil(itemsCount / itemsInRow);\r\n\r\n  const {\r\n    ref,\r\n    scrollTop\r\n  } = useScrollAware();\r\n\r\n  const indexToOffset = useCallback((index: number, block: ScrollToBlock) => {\r\n    const scrollToRow = index &&\r\n      Math.floor(index / itemsInRow);\r\n    let scrollOffset = 0;\r\n    if (block === 'smart') {\r\n      const scrollToRowTop = scrollToRow &&\r\n        Math.ceil(scrollToRow * (itemHeight + rowGap));\r\n      const scrollToRowBottom = scrollToRowTop + itemHeight;\r\n      const scrollBottom = scrollTop + height;\r\n\r\n      // console.log({scrollToRowTop, scrollBottom, height, itemHeight});\r\n\r\n      if (scrollToRowTop >= scrollTop && scrollToRowBottom <= scrollBottom) {\r\n        return scrollTop;\r\n      } else if (scrollToRowBottom > scrollTop && scrollToRowTop < scrollTop) {\r\n        scrollOffset = 0\r\n      } else if (scrollToRowTop < scrollBottom && scrollToRowBottom > scrollBottom) {\r\n        scrollOffset = height - itemHeight;\r\n      }\r\n    } else {\r\n      scrollOffset = Math.ceil(height / 2 - itemHeight / 2);\r\n    }\r\n    const scrollTo = index && scrollToRow &&\r\n      Math.ceil(scrollToRow * (itemHeight + rowGap)) -\r\n        scrollOffset;\r\n    return scrollTo;\r\n  }, [\r\n    rowGap,\r\n    height,\r\n    itemHeight,\r\n    itemsInRow,\r\n    scrollTop\r\n  ]);\r\n\r\n  const totalHeight = rowsCount * itemHeight +\r\n    (rowsCount - 1) * rowGap;\r\n\r\n  useImperativeHandle(scrollRef, () => ({\r\n    scrollToIndex(index: number, block = 'center') {\r\n      const scrollTo = indexToOffset(index, block);\r\n      if (ref.current) {\r\n        const div = ref.current;\r\n        div.scroll(0, scrollTo);\r\n      }\r\n    }\r\n  }), [\r\n    indexToOffset,\r\n    ref\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (ref.current) {\r\n      if (scrollToIndex !== undefined) {\r\n        const scrollTo = indexToOffset(scrollToIndex, 'center');\r\n        const div = ref.current;\r\n        div.scroll(0, scrollTo);\r\n      }\r\n    }\r\n  }, [\r\n    indexToOffset,\r\n    ref,\r\n    scrollToIndex\r\n  ]);\r\n\r\n  const startRow = Math.max(\r\n    0,\r\n    Math.floor(scrollTop / (itemHeight + rowGap)) - rowsAhead\r\n  );\r\n  const startItem = startRow * itemsInRow;\r\n\r\n  const visibleItemsCount = Math.min(\r\n    itemsCount - startItem,\r\n    (Math.ceil(height / (itemHeight + rowGap)) + 2 * rowsAhead)\r\n      * itemsInRow\r\n  );\r\n\r\n  const offsetY = startRow * (itemHeight + rowGap);\r\n\r\n  const firstVisibleRow = Math.floor(\r\n    (scrollTop) / (itemHeight + rowGap)\r\n  );\r\n  const lastVisibleRow = Math.floor(\r\n    (scrollTop + height) / (itemHeight + rowGap)\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (onVisibleRows) {\r\n      const visibleRows = [] as number[];\r\n      for (let i = firstVisibleRow; i <= lastVisibleRow; i++) {\r\n        visibleRows.push(i);\r\n      }\r\n      onVisibleRows(visibleRows);\r\n    }\r\n  }, [\r\n    firstVisibleRow,\r\n    lastVisibleRow,\r\n    onVisibleRows\r\n  ]);\r\n\r\n  const visibleItems = useMemo(() =>\r\n    (visibleItemsCount > 0) ?\r\n      new Array(visibleItemsCount)\r\n        .fill(null)\r\n        .map((_ , index) => (\r\n          <Item\r\n            key={index + startItem}\r\n            index={index + startItem}\r\n          />\r\n        )) :\r\n      []\r\n  ,[startItem, visibleItemsCount, Item]);\r\n\r\n  const columnWidth = itemWidth ? `${itemWidth}px` : '1fr';\r\n  const gridTemplateColumns = `repeat(${itemsInRow}, ${columnWidth})`;\r\n  const rowWidth = itemWidth &&\r\n    itemsInRow > 1 ?\r\n      itemsInRow * itemWidth + (itemsInRow - 1) * columnGap :\r\n      undefined;\r\n  const totalWidth = (width && itemWidth && width < itemWidth) ?\r\n    Math.max(width, itemWidth) : rowWidth;\r\n\r\n  return (\r\n    <div\r\n      className={className}\r\n      ref={ref}\r\n      style={{\r\n        height,\r\n        width\r\n      }}\r\n    >\r\n      <div\r\n        className={'VirtualGrid-area'}\r\n        style={{\r\n          height: totalHeight,\r\n          width: totalWidth\r\n        }}\r\n      >\r\n        <div\r\n          className={'VirtualGrid-visible'}\r\n          style={{\r\n            top: `${offsetY}px`,\r\n            gap: `${rowGap}px ${columnGap}px`,\r\n            gridTemplateColumns,\r\n            ...(center && {\r\n              justifyContent: 'center',\r\n              justifyItems: 'center'\r\n            })\r\n          }}\r\n        >\r\n          {visibleItems}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default VirtualGrid;\r\n","import React, {useMemo, useRef, useEffect} from 'react';\r\nimport { Box } from '@material-ui/core';\r\nimport { useRectSize } from './hooks';\r\nimport Thumbnail from './Thumbnail';\r\nimport VirtualGrid, { ItemProps, VirtualGridRef } from './VirtualGrid';\r\nimport {\r\n  SystemStyleObject\r\n} from '@material-ui/system';\r\n\r\ninterface ThumbnailsProps {\r\n  files?: gapi.client.drive.File[];\r\n  fileId?: string;\r\n  onSelect: (fileId: string) => void;\r\n  onVisibleFiles?: (indices: number[]) => void;\r\n  sx?: SystemStyleObject;\r\n};\r\n\r\nconst Thumbnails: React.FC<ThumbnailsProps> = (props) => {\r\n  const {\r\n    files = [],\r\n    fileId,\r\n    onSelect,\r\n    onVisibleFiles,\r\n    sx\r\n  } = props;\r\n\r\n  const virtualGridRef = useRef<VirtualGridRef>(null);\r\n  const scrollIndexRef = useRef(0);\r\n\r\n  const Item = useMemo(() => {\r\n    return ({index}: ItemProps) => {\r\n      const file = files[index];\r\n      const isActive = fileId === file.id;\r\n\r\n      return (\r\n        <Thumbnail\r\n          file={file}\r\n          counter={index + 1}\r\n          isActive={isActive}\r\n          onClick={() => {\r\n            if (virtualGridRef.current) {\r\n              scrollIndexRef.current = index;\r\n              virtualGridRef.current.scrollToIndex(index, 'smart');\r\n            }\r\n            if (file.id) {\r\n              onSelect(file.id);\r\n            }\r\n          }}\r\n        />\r\n      );\r\n    };\r\n  }, [\r\n    files,\r\n    fileId,\r\n    onSelect\r\n  ]);\r\n\r\n  const { ref, rectSize } = useRectSize();\r\n  const activeIndex = useMemo(() => {\r\n    if (fileId && files && files.length > 0) {\r\n      return files.findIndex(file => file.id === fileId);\r\n    } else {\r\n      return -1;\r\n    }\r\n  }, [\r\n    fileId,\r\n    files\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (virtualGridRef.current && activeIndex !== scrollIndexRef.current) {\r\n      scrollIndexRef.current = activeIndex;\r\n      virtualGridRef.current.scrollToIndex(activeIndex);\r\n    }\r\n  }, [\r\n    activeIndex\r\n  ]);\r\n\r\n  return (\r\n    <Box\r\n      ref={ref}\r\n      sx={{\r\n        ...sx,\r\n        overflow: 'hidden'\r\n      }}\r\n    >\r\n      {(files.length > 0 && rectSize.height > 0) &&\r\n        <VirtualGrid\r\n          Item={Item}\r\n          height={rectSize.height}\r\n          itemHeight={220}\r\n          itemsCount={files.length}\r\n          rowsAhead={3}\r\n          center\r\n          rowGap={4}\r\n          ref={virtualGridRef}\r\n          onVisibleRows={onVisibleFiles}\r\n        />\r\n      }\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Thumbnails;","import React, {\r\n  useMemo,\r\n  useEffect,\r\n  forwardRef,\r\n  useImperativeHandle,\r\n  useCallback,\r\n  useState\r\n} from 'react';\r\nimport {\r\n  SystemStyleObject,\r\n  styled\r\n} from '@material-ui/system';\r\nimport {\r\n  Box,\r\n  Menu,\r\n  MenuItem,\r\n  ListItemIcon,\r\n  ListItemText\r\n} from '@material-ui/core';\r\nimport { useScrollActions } from './hooks';\r\nimport { FitMode } from '../..';\r\nimport { useFullScreen } from '../../../../lib/hooks';\r\nimport FullscreenEnterIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport FitBestIcon from '@material-ui/icons/CropDin';\r\nimport FitWidthIcon from '@material-ui/icons/CropPortrait';\r\nimport FitHeightIcon from '@material-ui/icons/CropLandscape';\r\nimport FitOriginalIcon from '@material-ui/icons/CropOriginal';\r\nimport StartSlideshowIcon from '@material-ui/icons/PlayArrow';\r\nimport EndSlideshowIcon from '@material-ui/icons/Pause';\r\n\r\nconst wheelCount = 3;\r\nconst slideShowInterval = 5000;\r\n\r\nexport interface ViewerRef {\r\n  toggleFullscreen: () => void;\r\n}\r\n\r\ninterface ViewerProps {\r\n  fitMode: FitMode;\r\n  files: gapi.client.drive.File[];\r\n  onNextImage: () => void;\r\n  onPrevImage: () => void;\r\n  onFitModeChange: (fitMode: FitMode) => void;\r\n  sx?: SystemStyleObject;\r\n  isScrollToBottom?: boolean;\r\n  isSlideshowEnabled?: boolean;\r\n  isSlideshowPlaying?: boolean;\r\n  onToggleSlideshowPlaying: () => void;\r\n};\r\n\r\ninterface Point {\r\n  x: number;\r\n  y: number;\r\n};\r\n\r\nconst Img = styled('img')({});\r\n\r\nconst Viewer = forwardRef<ViewerRef, ViewerProps>(\r\n  (props, viewerRef) => {\r\n  const {\r\n    fitMode,\r\n    files,\r\n    onNextImage,\r\n    onPrevImage,\r\n    onFitModeChange,\r\n    sx,\r\n    isScrollToBottom,\r\n    isSlideshowEnabled,\r\n    isSlideshowPlaying,\r\n    onToggleSlideshowPlaying\r\n  } = props;\r\n\r\n  const [ contextMenu, setContextMenu ] = useState<Point | null>(null);\r\n\r\n  const {\r\n    ref,\r\n    scrollToTop,\r\n    scrollToBottom,\r\n    scrollNextSlide\r\n  } = useScrollActions({\r\n    wheelCount,\r\n    onScrollOverTop: onPrevImage,\r\n    onScrollBelowBottom: onNextImage\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (isSlideshowPlaying) {\r\n      const timer = setInterval(scrollNextSlide, slideShowInterval);\r\n      return () => {\r\n        clearInterval(timer);\r\n      };\r\n    }\r\n  }, [\r\n    isSlideshowPlaying,\r\n    scrollNextSlide\r\n  ]);\r\n\r\n  const activeFileId = useMemo(() => {\r\n    return (files.length > 0) ?\r\n      files[0].id as string :\r\n      '';\r\n  }, [\r\n    files\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (activeFileId && ref.current) {\r\n      if (isScrollToBottom) {\r\n        scrollToBottom();\r\n      } else {\r\n        scrollToTop()\r\n      }\r\n    }\r\n  }, [\r\n    activeFileId,\r\n    ref,\r\n    scrollToTop,\r\n    isScrollToBottom,\r\n    scrollToBottom\r\n  ]);\r\n  \r\n  const {\r\n    isEnabled,\r\n    isFullscreen,\r\n    toggleFullScreen\r\n  } = useFullScreen();\r\n  useImperativeHandle(viewerRef, () => ({\r\n    toggleFullscreen() {\r\n      if (isEnabled) {\r\n        toggleFullScreen(ref.current);\r\n      }\r\n    }\r\n  }), [\r\n    ref,\r\n    isEnabled,\r\n    toggleFullScreen\r\n  ]);\r\n\r\n  const onContextMenu = useCallback((e: React.MouseEvent<HTMLDivElement>) => {\r\n    e.preventDefault();\r\n    setContextMenu(\r\n      prev => !prev ?\r\n        {\r\n          x: e.clientX - 2,\r\n          y: e.clientY - 4\r\n        } :\r\n        null\r\n    );\r\n  }, []);\r\n\r\n  const onClose = useCallback(() => {\r\n    setContextMenu(null);\r\n  }, []);\r\n\r\n  const onClickFullscreen = useCallback(() => {\r\n    if (isEnabled) {\r\n      toggleFullScreen(ref.current);\r\n    }\r\n    onClose();\r\n  }, [\r\n    isEnabled,\r\n    ref,\r\n    toggleFullScreen,\r\n    onClose\r\n  ]);\r\n\r\n  const onClickFitBest = useCallback(() => {\r\n    onFitModeChange(FitMode.Best);\r\n    onClose();\r\n  }, [\r\n    onFitModeChange,\r\n    onClose\r\n  ]);\r\n  const onClickFitWidth = useCallback(() => {\r\n    onFitModeChange(FitMode.Width);\r\n    onClose();\r\n  }, [\r\n    onFitModeChange,\r\n    onClose\r\n  ]);\r\n  const onClickFitHeight = useCallback(() => {\r\n    onFitModeChange(FitMode.Height);\r\n    onClose();\r\n  }, [\r\n    onFitModeChange,\r\n    onClose\r\n  ]);\r\n  const onClickFitOriginal = useCallback(() => {\r\n    onFitModeChange(FitMode.Original);\r\n    onClose();\r\n  }, [\r\n    onFitModeChange,\r\n    onClose\r\n  ]);\r\n  const onClickSlideshow = useCallback(() => {\r\n    onToggleSlideshowPlaying();\r\n    onClose();\r\n  }, [\r\n    onToggleSlideshowPlaying,\r\n    onClose\r\n  ]);\r\n\r\n  return (\r\n    <Box sx={{\r\n      ...sx,\r\n      position: 'relative'\r\n    }}>\r\n      <Box\r\n        component='div'\r\n        onContextMenu={onContextMenu}\r\n        sx={{\r\n          textAlign: 'center',\r\n          position: 'absolute',\r\n          top: 0,\r\n          left: 0,\r\n          right: 0,\r\n          bottom: 0,\r\n          overflow: 'auto',\r\n          whiteSpace: 'nowrap',\r\n          ...(files.length > 0 && {\r\n            bgcolor: 'common.black'\r\n          })\r\n        }}\r\n        ref={ref}\r\n      >\r\n        <Box\r\n          component='span'\r\n          sx={{\r\n            height: '100%',\r\n            verticalAlign: 'middle',\r\n            display: 'inline-block'\r\n          }}\r\n        />\r\n        {files.map((file, i) => (\r\n          <Img\r\n            key={file.id}\r\n            src={file.webContentLink}\r\n            alt={file.name}\r\n            sx={i === 0 ?\r\n              {\r\n                verticalAlign: 'middle',\r\n                ...(fitMode === FitMode.Best && {\r\n                  maxWidth: '100%',\r\n                  maxHeight: '100%'\r\n                }),\r\n                ...(fitMode === FitMode.Width && {\r\n                  maxWidth: '100%'\r\n                }),\r\n                ...(fitMode === FitMode.Height && {\r\n                  maxHeight: '100%'\r\n                })\r\n              } : {\r\n                display: 'none'\r\n              }\r\n            }\r\n            onClick={onNextImage}\r\n            // onLoad={i === 0 ? onImageLoad : undefined}\r\n          />\r\n        ))}\r\n        <Menu\r\n          container={ref.current}\r\n          disableScrollLock={true}\r\n          open={!!contextMenu}\r\n          onClose={onClose}\r\n          anchorReference='anchorPosition'\r\n          anchorPosition={!!contextMenu ?\r\n            {\r\n              top: contextMenu.y,\r\n              left: contextMenu.x\r\n            } :\r\n            undefined\r\n          }\r\n        >\r\n          {isEnabled &&\r\n            <MenuItem\r\n              onClick={onClickFullscreen}\r\n            >\r\n              <ListItemIcon>\r\n                {isFullscreen ?\r\n                  <FullscreenExitIcon /> :\r\n                  <FullscreenEnterIcon />\r\n                }\r\n              </ListItemIcon>\r\n              <ListItemText>\r\n                {isFullscreen ?\r\n                  'Exit Fullscreen' :\r\n                  'Enter Fullscreen'\r\n                }\r\n              </ListItemText>\r\n            </MenuItem>\r\n          }\r\n          {isSlideshowEnabled &&\r\n            <MenuItem\r\n              onClick={onClickSlideshow}\r\n            >\r\n              <ListItemIcon>\r\n                {isSlideshowPlaying ?\r\n                  <EndSlideshowIcon/> :\r\n                  <StartSlideshowIcon/>\r\n                }\r\n              </ListItemIcon>\r\n              <ListItemText>\r\n                {isSlideshowPlaying ?\r\n                  'End Slideshow' :\r\n                  'Start Slideshow'\r\n                }\r\n              </ListItemText>\r\n            </MenuItem>\r\n          }\r\n          <MenuItem\r\n            onClick={onClickFitBest}\r\n          >\r\n            <ListItemIcon>\r\n              <FitBestIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Best Fit'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n          <MenuItem\r\n            onClick={onClickFitWidth}\r\n          >\r\n            <ListItemIcon>\r\n              <FitWidthIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Fit Width'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n          <MenuItem\r\n            onClick={onClickFitHeight}\r\n          >\r\n            <ListItemIcon>\r\n              <FitHeightIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Fit Height'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n          <MenuItem\r\n            onClick={onClickFitOriginal}\r\n          >\r\n            <ListItemIcon>\r\n              <FitOriginalIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Original Size'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        </Menu>\r\n      </Box>\r\n    </Box>\r\n  );\r\n});\r\n\r\nexport default Viewer;\r\n","import {\r\n  useEffect,\r\n  useRef,\r\n  useCallback\r\n} from 'react';\r\n\r\ninterface ScrollActionsOptions {\r\n  wheelCount?: number;\r\n  onScrollOverTop?: () => void;\r\n  onScrollBelowBottom?: () => void;\r\n};\r\n\r\nconst useScrollActions = (options: ScrollActionsOptions) => {\r\n  const {\r\n    wheelCount = 3,\r\n    onScrollOverTop,\r\n    onScrollBelowBottom\r\n  } = options;\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  const scrollTopRef = useRef(0);\r\n  const scrollOverTopCountRef = useRef(0);\r\n  const scrollBelowBottomCountRef = useRef(0);\r\n\r\n  const scrollToTop = useCallback(() => {\r\n    if (ref.current) {\r\n      const div = ref.current;\r\n      div.scroll(0, 0);\r\n    }\r\n  }, []);\r\n\r\n  const scrollToBottom = useCallback(() => {\r\n    if (ref.current) {\r\n      const div = ref.current;\r\n      div.scroll(0, div.scrollHeight);\r\n    }\r\n  }, []);\r\n\r\n  const scrollNextSlide = useCallback(() => {\r\n    if (ref.current) {\r\n      const div = ref.current;\r\n      const scrollHeight = div.scrollHeight - div.offsetHeight;\r\n      if (scrollTopRef.current >= scrollHeight && onScrollBelowBottom) {\r\n        onScrollBelowBottom();\r\n      } else {\r\n        const slideSize = Math.max(div.offsetHeight - 50, 50);\r\n        div.scroll(0, scrollTopRef.current + slideSize);\r\n      }\r\n    }\r\n  }, [\r\n    onScrollBelowBottom\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const scrollContainer = ref.current;\r\n    if (!scrollContainer) {\r\n      return;\r\n    }\r\n\r\n    const onScroll = (e: Event) => {\r\n      requestAnimationFrame(() => {\r\n        const div = e.target as HTMLDivElement;\r\n        if (div) {\r\n          scrollTopRef.current = +div.scrollTop;\r\n        }\r\n      });\r\n    };\r\n\r\n    scrollContainer.addEventListener('scroll', onScroll);\r\n    return () => scrollContainer.removeEventListener('scroll', onScroll);\r\n  }, [\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const scrollContainer = ref.current;\r\n    if (!scrollContainer) {\r\n      return;\r\n    }\r\n\r\n    const onWheel = (e: WheelEvent) => {\r\n      const div = ref.current;\r\n      if (div) {\r\n        const scrollHeight = div.scrollHeight - div.offsetHeight;\r\n        if (e.deltaY < 0) {\r\n          scrollBelowBottomCountRef.current = 0;\r\n          if (scrollTopRef.current <= 0) {\r\n            scrollOverTopCountRef.current += 1;\r\n          }\r\n          if (onScrollOverTop) {\r\n            if (\r\n              scrollHeight <= 0 ||\r\n              scrollOverTopCountRef.current >= wheelCount\r\n            ) {\r\n              scrollOverTopCountRef.current = 0;\r\n              onScrollOverTop();\r\n            }\r\n          }\r\n        }\r\n        if (e.deltaY > 0) {\r\n          scrollOverTopCountRef.current = 0;\r\n          if (scrollTopRef.current >= scrollHeight) {\r\n            scrollBelowBottomCountRef.current += 1;\r\n          }\r\n          if (onScrollBelowBottom) {\r\n            if (\r\n              scrollHeight <= 0 ||\r\n              scrollBelowBottomCountRef.current >= wheelCount\r\n            ) {\r\n              scrollBelowBottomCountRef.current = 0;\r\n              onScrollBelowBottom();\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    scrollContainer.addEventListener('wheel', onWheel);\r\n    return () => scrollContainer.removeEventListener('wheel', onWheel);\r\n  }, [\r\n    wheelCount,\r\n    onScrollOverTop,\r\n    onScrollBelowBottom\r\n  ]);\r\n\r\n  return {\r\n    ref,\r\n    scrollToTop,\r\n    scrollToBottom,\r\n    scrollNextSlide\r\n  };\r\n};\r\n\r\nexport {\r\n  useScrollActions\r\n}\r\n","import { SvgIcon } from '@material-ui/core';\r\nimport React from 'react';\r\n\r\nconst GoogleIcon: React.FC = () => {\r\n  return (\r\n    <SvgIcon\r\n      fontSize={'small'}\r\n    >\r\n      <g transform=\"matrix(1, 0, 0, 1, 27.009001, -39.238998)\">\r\n        <path fill=\"#4285F4\" d=\"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z\"/>\r\n        <path fill=\"#34A853\" d=\"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z\"/>\r\n        <path fill=\"#FBBC05\" d=\"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.724 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z\"/>\r\n        <path fill=\"#EA4335\" d=\"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.789 L -6.734 42.369 C -8.804 40.429 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z\"/>\r\n      </g>\r\n    </SvgIcon>\r\n  );\r\n};\r\n\r\nexport default GoogleIcon;\r\n","import React, {\r\n  useRef,\r\n  useEffect,\r\n  useState\r\n} from 'react';\r\nimport {\r\n  Tooltip,\r\n  Typography\r\n} from '@material-ui/core';\r\nimport {\r\n  SystemStyleObject\r\n} from '@material-ui/system'\r\n\r\ninterface TitleTooltipProps {\r\n  text: string;\r\n  sx?: SystemStyleObject;\r\n};\r\n\r\nconst TitleTooltip: React.FC<TitleTooltipProps> = (props) => {\r\n  const {\r\n    text,\r\n    sx\r\n  } = props;\r\n\r\n  const ref = useRef<HTMLDivElement>(null);\r\n  const [ isOverflow, setOverflow ] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const div = ref.current;\r\n    const check = () => {\r\n      if (div) {\r\n        const isOverflow = div.scrollWidth > div.offsetWidth;\r\n        setOverflow(isOverflow);\r\n      }\r\n    };\r\n    if (div && text) {\r\n      check();\r\n    } else {\r\n      setOverflow(false);\r\n    }\r\n  }, [\r\n    text\r\n  ]);\r\n\r\n  return (\r\n    <Tooltip\r\n      title={text}\r\n      disableHoverListener={!isOverflow}\r\n    >\r\n      <Typography\r\n        variant='h6'\r\n        component='div'\r\n        noWrap\r\n        sx={sx}\r\n        ref={ref}\r\n      >\r\n        <span>\r\n          {text}\r\n        </span>\r\n      </Typography>\r\n    </Tooltip>\r\n  );\r\n};\r\n\r\nexport default TitleTooltip;","import React, {\r\n  useState,\r\n  useRef,\r\n  useCallback,\r\n} from 'react';\r\nimport {\r\n  Box,\r\n  Toolbar,\r\n  Typography,\r\n  IconButton,\r\n  Menu,\r\n  MenuItem,\r\n  ToggleButtonGroup,\r\n  Tooltip,\r\n  ToggleButton,\r\n  ListItemIcon,\r\n  ListItemText,\r\n  Avatar,\r\n  Divider,\r\n} from '@material-ui/core';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport FitBestIcon from '@material-ui/icons/CropDin';\r\nimport FitWidthIcon from '@material-ui/icons/CropPortrait';\r\nimport FitHeightIcon from '@material-ui/icons/CropLandscape';\r\nimport FitOriginalIcon from '@material-ui/icons/CropOriginal';\r\nimport FullscreenEnterIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport FirstImageIcon from '@material-ui/icons/FirstPage';\r\nimport LastImageIcon from '@material-ui/icons/LastPage';\r\nimport PrevImageIcon from '@material-ui/icons/NavigateBefore';\r\nimport NextImageIcon from '@material-ui/icons/NavigateNext';\r\nimport StartSlideshowIcon from '@material-ui/icons/PlayArrow';\r\nimport EndSlideshowIcon from '@material-ui/icons/Pause';\r\nimport OpenFileIcon from '@material-ui/icons/InsertDriveFile';\r\nimport RecentFilesIcon from '@material-ui/icons/History';\r\nimport DownloadFileIcon from '@material-ui/icons/FileDownload';\r\nimport CloseFileIcon from '@material-ui/icons/Close';\r\nimport HelpIcon from '@material-ui/icons/HelpOutline';\r\nimport PolicyIcon from '@material-ui/icons/Policy';\r\nimport TermsIcon from '@material-ui/icons/Gavel';\r\nimport SignOutIcon from '@material-ui/icons/Logout';\r\nimport GoogleIcon from './GoogleIcon';\r\nimport CookiesErrorIcon from '@material-ui/icons/VisibilityOff';\r\nimport HideDrawerIcon from '@material-ui/icons/ArrowLeft';\r\nimport ShowDrawerIcon from '@material-ui/icons/ArrowRight';\r\nimport { defaultTitle, FitMode } from '../..';\r\nimport { RecentFile, useFullScreen, useIsSignedIn } from '../../../../lib/hooks';\r\nimport {\r\n  pickFile\r\n} from '../../../../lib/api';\r\nimport TitleTooltip from './TitleTooltip';\r\nimport { Link } from 'react-router-dom';\r\nimport CloseViewIcon from '@material-ui/icons/CancelPresentation';\r\n\r\ninterface TopbarProps {\r\n  title: string;\r\n  counterTitle: string;\r\n  fitMode: FitMode;\r\n  onFitModeChange: (fitMode: FitMode) => void;\r\n  onOpenFile: (file: google.picker.DocumentObject) => void;\r\n  onRecentFile: (file: RecentFile) => void;\r\n  fullscreenButtonActive?: boolean;\r\n  onToggleFullscreen: () => void;\r\n  isFirstImageEnabled?: boolean;\r\n  isPrevImageEnabled?: boolean;\r\n  isNextImageEnabled?: boolean;\r\n  isLastImageEnabled?: boolean;\r\n  isSlideshowEnabled?: boolean;\r\n  isSlideshowPlaying?: boolean;\r\n  onToggleSlideshowPlaying: () => void;\r\n  onFirstImage: () => void;\r\n  onPrevImage: () => void;\r\n  onNextImage: () => void;\r\n  onLastImage: () => void;\r\n  recentFiles: RecentFile[];\r\n  onDownloadFile: () => void;\r\n  onCloseFile: () => void;\r\n  onSignOut: () => void;\r\n  isMobileDrawerOpen: boolean;\r\n  toggleMobileDrawer: () => void;\r\n};\r\n\r\nconst Topbar: React.FC<TopbarProps> = (props) => {\r\n  const {\r\n    title,\r\n    counterTitle,\r\n    fitMode,\r\n    onFitModeChange,\r\n    onOpenFile,\r\n    onRecentFile,\r\n    fullscreenButtonActive,\r\n    onToggleFullscreen,\r\n    isFirstImageEnabled,\r\n    isPrevImageEnabled,\r\n    isNextImageEnabled,\r\n    isLastImageEnabled,\r\n    isSlideshowEnabled,\r\n    isSlideshowPlaying,\r\n    onToggleSlideshowPlaying,\r\n    onFirstImage,\r\n    onPrevImage,\r\n    onNextImage,\r\n    onLastImage,\r\n    recentFiles,\r\n    onDownloadFile,\r\n    onCloseFile,\r\n    onSignOut,\r\n    isMobileDrawerOpen,\r\n    toggleMobileDrawer\r\n  } = props;\r\n  const [ isMenuOpen, setMenuOpen ] = useState(false);\r\n  const menuRef = useRef<HTMLButtonElement>(null);\r\n  const [ isRecentMenuOpen, setRecentMenuOpen ] = useState(false);\r\n  const recentMenuRef = useRef<HTMLLIElement>(null);\r\n  const [ isHelpMenuOpen, setHelpMenuOpen ] = useState(false);\r\n  const helpMenuRef = useRef<HTMLButtonElement>(null);\r\n  const [ isProfileMenuOpen, setProfileMenuOpen ] = useState(false);\r\n  const profileMenuRef = useRef<HTMLButtonElement>(null);\r\n  const {\r\n    isEnabled: isFullscreenEnabled,\r\n    isFullscreen\r\n  } = useFullScreen();\r\n\r\n  const {\r\n    isSignedIn,\r\n    toggleSignedIn,\r\n    profile,\r\n    isCookiesError\r\n  } = useIsSignedIn(onSignOut);\r\n\r\n  const handleMenuClose = useCallback(() => {\r\n    setMenuOpen(false);\r\n  }, []);\r\n  const handleMenuClick = useCallback(() => {\r\n    setMenuOpen(current => !current);\r\n  }, []);\r\n  const onOpenClick = useCallback(async () => {\r\n    handleMenuClose();\r\n    const doc = await pickFile();\r\n    if (doc) {\r\n      onOpenFile(doc);\r\n    }\r\n  }, [\r\n    handleMenuClose,\r\n    onOpenFile\r\n  ]);\r\n  const onDrawerClick = useCallback(() => {\r\n    toggleMobileDrawer();\r\n    handleMenuClose();\r\n  }, [\r\n    toggleMobileDrawer,\r\n    handleMenuClose\r\n  ]);\r\n  const onDownloadClick = useCallback(() => {\r\n    onDownloadFile();\r\n    handleMenuClose();\r\n  }, [\r\n    handleMenuClose,\r\n    onDownloadFile\r\n  ]);\r\n  const onCloseClick = useCallback(() => {\r\n    onCloseFile();\r\n    handleMenuClose();\r\n  }, [\r\n    onCloseFile,\r\n    handleMenuClose\r\n  ]);\r\n  const handleRecentMenuClose = useCallback(() => {\r\n    setRecentMenuOpen(false);\r\n  }, []);\r\n  const handleRecentMenuClick = useCallback(() => {\r\n    setRecentMenuOpen(current => !current);\r\n  }, []);\r\n  const onRecentFileClick = useCallback((recentFile: RecentFile) => {\r\n    handleRecentMenuClose();\r\n    handleMenuClose();\r\n    onRecentFile(recentFile);\r\n  }, [\r\n    handleRecentMenuClose,\r\n    handleMenuClose,\r\n    onRecentFile\r\n  ]);\r\n  const handleHelpMenuClose = useCallback(() => {\r\n    setHelpMenuOpen(false);\r\n  }, []);\r\n  const handleHelpMenuClick = useCallback(() => {\r\n    setHelpMenuOpen(current => !current);\r\n  }, []);\r\n  const handleProfileMenuClose = useCallback(() => {\r\n    setProfileMenuOpen(false);\r\n  }, []);\r\n  const handleProfileMenuClick = useCallback(() => {\r\n    setProfileMenuOpen(current => !current);\r\n  }, []);\r\n  const onSignOutClick = useCallback(() => {\r\n    handleProfileMenuClose();\r\n    toggleSignedIn();\r\n  }, [\r\n    handleProfileMenuClose,\r\n    toggleSignedIn\r\n  ]);\r\n\r\n  return (\r\n    <Toolbar>\r\n      <IconButton\r\n        size='large'\r\n        edge='start'\r\n        color='inherit'\r\n        aria-label='menu'\r\n        sx={{ mr: 2 }}\r\n        ref={menuRef}\r\n        onClick={handleMenuClick}\r\n      >\r\n        <MenuIcon />\r\n      </IconButton>\r\n      <Menu\r\n        anchorEl={menuRef.current}\r\n        open={isMenuOpen}\r\n        onClose={handleMenuClose}\r\n      >\r\n        <MenuItem\r\n          onClick={onDrawerClick}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            {isMobileDrawerOpen ?\r\n              <HideDrawerIcon/> :\r\n              <ShowDrawerIcon/>\r\n            }\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {isMobileDrawerOpen ?\r\n              'Hide Thumbnails' :\r\n              'Show Thumbnails'\r\n            }\r\n          </ListItemText>\r\n        </MenuItem>\r\n        {!isSignedIn &&\r\n          <MenuItem\r\n            onClick={toggleSignedIn}\r\n          >\r\n            <ListItemIcon>\r\n              <GoogleIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Sign in with Google'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        }\r\n        {isSignedIn &&\r\n          <MenuItem\r\n            onClick={onOpenClick}\r\n          >\r\n            <ListItemIcon>\r\n              <OpenFileIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Open File'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        }\r\n        {isSignedIn &&\r\n          <MenuItem\r\n            onClick={handleRecentMenuClick}\r\n            disabled={recentFiles.length === 0}\r\n            ref={recentMenuRef}\r\n          >\r\n            <ListItemIcon>\r\n              <RecentFilesIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Recent Files'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        }\r\n        {fullscreenButtonActive &&\r\n          <MenuItem\r\n            onClick={onDownloadClick}\r\n          >\r\n            <ListItemIcon>\r\n              <DownloadFileIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Download File'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        }\r\n        {fullscreenButtonActive &&\r\n          <MenuItem\r\n            onClick={onCloseClick}\r\n          >\r\n            <ListItemIcon>\r\n              <CloseFileIcon/>\r\n            </ListItemIcon>\r\n            <ListItemText>\r\n              {'Close File'}\r\n            </ListItemText>\r\n          </MenuItem>\r\n        }\r\n        <Divider\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        />\r\n        <MenuItem\r\n          disabled={!fullscreenButtonActive}\r\n          onClick={() => {\r\n            onFirstImage();\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <FirstImageIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'First Image'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          disabled={!fullscreenButtonActive}\r\n          onClick={() => {\r\n            onToggleSlideshowPlaying();\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            {isSlideshowPlaying ?\r\n              <EndSlideshowIcon/> :\r\n              <StartSlideshowIcon/>\r\n            }\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {isSlideshowPlaying ?\r\n              'End Slideshow' :\r\n              'Start Slideshow'\r\n            }\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          disabled={!fullscreenButtonActive}\r\n          onClick={() => {\r\n            onLastImage();\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <LastImageIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Last Image'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <Divider\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        />\r\n        <MenuItem\r\n          onClick={() => {\r\n            onFitModeChange(FitMode.Best);\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' },\r\n            backgroundColor: fitMode === FitMode.Best ?\r\n              'rgba(0, 0, 0, 0.08)' : undefined\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <FitBestIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Best Fit'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          onClick={() => {\r\n            onFitModeChange(FitMode.Width);\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' },\r\n            backgroundColor: fitMode === FitMode.Width ?\r\n              'rgba(0, 0, 0, 0.08)' : undefined\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <FitWidthIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Fit Width'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          onClick={() => {\r\n            onFitModeChange(FitMode.Height);\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' },\r\n            backgroundColor: fitMode === FitMode.Height ?\r\n              'rgba(0, 0, 0, 0.08)' : undefined\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <FitHeightIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Fit Height'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          onClick={() => {\r\n            onFitModeChange(FitMode.Original);\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' },\r\n            backgroundColor: fitMode === FitMode.Original ?\r\n              'rgba(0, 0, 0, 0.08)' : undefined\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <FitOriginalIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Original Size'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <Divider\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        />\r\n        <MenuItem\r\n          disabled={!fullscreenButtonActive}\r\n          onClick={() => {\r\n            onToggleFullscreen();\r\n            handleMenuClose();\r\n          }}\r\n          sx={{\r\n            display: { xs: 'flex', md: 'none' }\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            {isFullscreen ?\r\n              <FullscreenExitIcon /> :\r\n              <FullscreenEnterIcon/>\r\n            }\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {isFullscreen ?\r\n              'Exit Fullscreen' :\r\n              'Enter Fullscreen'\r\n            }\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          component={Link}\r\n          to={'/'}\r\n          onClick={() => {\r\n            document.title = defaultTitle;\r\n          }}\r\n        >\r\n          <ListItemIcon>\r\n            <CloseViewIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Close View'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </Menu>\r\n      <Menu\r\n        anchorEl={recentMenuRef.current}\r\n        open={isRecentMenuOpen}\r\n        onClose={handleRecentMenuClose}\r\n        PaperProps={{\r\n          sx: {\r\n            maxWidth: '400px'\r\n          }\r\n        }}\r\n        anchorOrigin={{\r\n          vertical: 'top',\r\n          horizontal: 'right'\r\n        }}\r\n      >\r\n        {recentFiles.map((recentFile, i) => (\r\n          <MenuItem\r\n            key={i}\r\n            onClick={() => onRecentFileClick(recentFile)}\r\n          >\r\n            <Typography\r\n              noWrap\r\n            >\r\n              {recentFile.title}\r\n            </Typography>\r\n          </MenuItem>\r\n        ))}\r\n      </Menu>\r\n      <TitleTooltip\r\n        text={title}\r\n        sx={{\r\n          flexGrow: 1\r\n        }}\r\n      />\r\n      {!!counterTitle &&\r\n        <Box\r\n          sx={{\r\n            m: 1\r\n          }}\r\n        >\r\n          <Typography variant='body1' noWrap>\r\n            {counterTitle}\r\n          </Typography>\r\n        </Box>\r\n      }\r\n      <Tooltip\r\n        title='First Image (Home)'\r\n      >\r\n        <Box\r\n          sx={{\r\n            display: { xs: 'none', md: 'block' }\r\n          }}\r\n        >\r\n          <IconButton\r\n            size='large'\r\n            color='inherit'\r\n            aria-label='first-image'\r\n            disabled={!isFirstImageEnabled}\r\n            onClick={onFirstImage}\r\n          >\r\n            <FirstImageIcon/>\r\n          </IconButton>\r\n        </Box>\r\n      </Tooltip>\r\n      <Tooltip\r\n        title='Previous Image (Left Arrow)'\r\n      >\r\n        <Box>\r\n          <IconButton\r\n            size='large'\r\n            color='inherit'\r\n            aria-label='prev-image'\r\n            disabled={!isPrevImageEnabled}\r\n            onClick={onPrevImage}\r\n            sx={{\r\n              p: { xs: '6px', md: '12px'}\r\n            }}\r\n          >\r\n            <PrevImageIcon/>\r\n          </IconButton>\r\n        </Box>\r\n      </Tooltip>\r\n      <Tooltip\r\n        title={isSlideshowPlaying ?\r\n          'End Slideshow (Space)' :\r\n          'Start Slideshow (Space)'\r\n        }\r\n      >\r\n        <Box\r\n          sx={{\r\n            display: { xs: 'none', md: 'block' }\r\n          }}\r\n        >\r\n          <IconButton\r\n            size='large'\r\n            color='inherit'\r\n            aria-label='next-image'\r\n            disabled={!isSlideshowEnabled}\r\n            onClick={onToggleSlideshowPlaying}\r\n          >\r\n            {isSlideshowPlaying ?\r\n              <EndSlideshowIcon/> :\r\n              <StartSlideshowIcon/>\r\n            }\r\n          </IconButton>\r\n        </Box>\r\n      </Tooltip>\r\n      <Tooltip\r\n        title='Next Image (Right Arrow, Scroll Below, Click)'\r\n      >\r\n        <Box>\r\n          <IconButton\r\n            size='large'\r\n            color='inherit'\r\n            aria-label='next-image'\r\n            disabled={!isNextImageEnabled}\r\n            onClick={onNextImage}\r\n            sx={{\r\n              p: { xs: '6px', md: '12px'}\r\n            }}\r\n          >\r\n            <NextImageIcon/>\r\n          </IconButton>\r\n        </Box>\r\n      </Tooltip>\r\n      <Tooltip\r\n        title='Last Image (End)'\r\n      >\r\n        <Box\r\n          sx={{\r\n            display: { xs: 'none', md: 'block' }\r\n          }}\r\n        >\r\n          <IconButton\r\n            size='large'\r\n            color='inherit'\r\n            aria-label='last-image'\r\n            disabled={!isLastImageEnabled}\r\n            onClick={onLastImage}\r\n          >\r\n            <LastImageIcon/>\r\n          </IconButton>\r\n        </Box>\r\n      </Tooltip>\r\n      <ToggleButtonGroup\r\n        value={fitMode}\r\n        exclusive\r\n        onChange={(e, value) => onFitModeChange(value)}\r\n        sx={{\r\n          display: { xs: 'none', md: 'flex' }\r\n        }}\r\n      >\r\n        <ToggleButton\r\n          value={FitMode.Best}\r\n          aria-label='best-fit'\r\n          sx={{\r\n            p: 0\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title='Best Fit'\r\n          >\r\n            <Box\r\n              sx={{\r\n                height: 'min-content',\r\n                width: 'min-content',\r\n                p: '11px',\r\n                display: 'grid',\r\n                alignContent: 'center',\r\n                justifyContent: 'center'\r\n              }}\r\n            >\r\n              <FitBestIcon/>\r\n            </Box>\r\n          </Tooltip>\r\n        </ToggleButton>\r\n        <ToggleButton\r\n          value={FitMode.Width}\r\n          aria-label='fit-width'\r\n          sx={{\r\n            p: 0\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title='Fit Width'\r\n          >\r\n            <Box\r\n              sx={{\r\n                height: 'min-content',\r\n                width: 'min-content',\r\n                p: '11px',\r\n                display: 'grid',\r\n                alignContent: 'center',\r\n                justifyContent: 'center'\r\n              }}\r\n            >\r\n              <FitWidthIcon/>\r\n            </Box>\r\n          </Tooltip>\r\n        </ToggleButton>\r\n        <ToggleButton\r\n          value={FitMode.Height}\r\n          aria-label='fit-height'\r\n          sx={{\r\n            p: 0\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title='Fit Height'\r\n          >\r\n            <Box\r\n              sx={{\r\n                height: 'min-content',\r\n                width: 'min-content',\r\n                p: '11px',\r\n                display: 'grid',\r\n                alignContent: 'center',\r\n                justifyContent: 'center'\r\n              }}\r\n            >\r\n              <FitHeightIcon/>\r\n            </Box>\r\n          </Tooltip>\r\n        </ToggleButton>\r\n        <ToggleButton\r\n          value={FitMode.Original}\r\n          aria-label='fit-original'\r\n          sx={{\r\n            p: 0\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title='Original Size'\r\n          >\r\n            <Box\r\n              sx={{\r\n                height: 'min-content',\r\n                width: 'min-content',\r\n                p: '11px',\r\n                display: 'grid',\r\n                alignContent: 'center',\r\n                justifyContent: 'center'\r\n              }}\r\n            >\r\n              <FitOriginalIcon/>\r\n            </Box>\r\n          </Tooltip>\r\n        </ToggleButton>\r\n      </ToggleButtonGroup>\r\n      {isFullscreenEnabled &&\r\n        <Tooltip\r\n          title={isFullscreen ?\r\n            'Exit Fullscreen' :\r\n            'Enter Fullscreen'\r\n          }\r\n        >\r\n          <Box\r\n            sx={{\r\n              display: { xs: 'none', md: 'block' }\r\n            }}\r\n          >\r\n            <IconButton\r\n              size='large'\r\n              color='inherit'\r\n              aria-label='fullscreen'\r\n              disabled={!fullscreenButtonActive}\r\n              onClick={onToggleFullscreen}\r\n            >\r\n              {isFullscreen ?\r\n                <FullscreenExitIcon /> :\r\n                <FullscreenEnterIcon/>\r\n              }\r\n            </IconButton>\r\n          </Box>\r\n        </Tooltip>\r\n      }\r\n      <Tooltip\r\n        title='Terms And Conditions'\r\n      >\r\n        <IconButton\r\n          size='large'\r\n          color='inherit'\r\n          aria-label='terms-and-policy'\r\n          edge={isSignedIn ? undefined : 'end'}\r\n          ref={helpMenuRef}\r\n          onClick={handleHelpMenuClick}\r\n          sx={{\r\n            p: { xs: '6px', md: '12px'}\r\n          }}\r\n        >\r\n          <HelpIcon/>\r\n        </IconButton>\r\n      </Tooltip>\r\n      <Menu\r\n        anchorEl={helpMenuRef.current}\r\n        open={isHelpMenuOpen}\r\n        onClose={handleHelpMenuClose}\r\n        MenuListProps={{\r\n          'aria-labelledby': 'basic-button',\r\n        }}\r\n      >\r\n        <MenuItem\r\n          component='a'\r\n          href={`${process.env.PUBLIC_URL}/privacy.html`}\r\n        >\r\n          <ListItemIcon>\r\n            <PolicyIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Privacy Policy'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n        <MenuItem\r\n          component='a'\r\n          href={`${process.env.PUBLIC_URL}/terms.html`}\r\n        >\r\n          <ListItemIcon>\r\n            <TermsIcon/>\r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Terms And Conditions'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </Menu>\r\n      {isSignedIn && profile &&\r\n        <IconButton\r\n          size='large'\r\n          edge='end'\r\n          color='inherit'\r\n          aria-label='terms-and-policy'\r\n          ref={profileMenuRef}\r\n          onClick={handleProfileMenuClick}\r\n          sx={{\r\n            p: '6px'\r\n          }}\r\n        >\r\n          <Avatar\r\n            src={profile.imageUrl}\r\n            sx={{\r\n              width: 32,\r\n              height: 32\r\n            }}\r\n          />\r\n        </IconButton>\r\n      }\r\n      <Menu\r\n        anchorEl={profileMenuRef.current}\r\n        open={isProfileMenuOpen}\r\n        onClose={handleProfileMenuClose}\r\n        MenuListProps={{\r\n          'aria-labelledby': 'basic-button',\r\n        }}\r\n      >\r\n        <MenuItem\r\n          onClick={onSignOutClick}\r\n        >\r\n          <ListItemIcon>\r\n            <SignOutIcon/> \r\n          </ListItemIcon>\r\n          <ListItemText>\r\n            {'Sign Out'}\r\n          </ListItemText>\r\n        </MenuItem>\r\n      </Menu>\r\n      {!isSignedIn && isCookiesError &&\r\n        <Tooltip\r\n          title={`You need to enable 3rd party cookies.\r\n            Click \"eye\" icon at the end of address bar`}\r\n        >\r\n          <CookiesErrorIcon\r\n            color='error'\r\n            sx={{\r\n              ml: '12px',\r\n              mr: '-6px'\r\n            }}\r\n          />\r\n        </Tooltip>\r\n      }\r\n    </Toolbar>\r\n  );\r\n};\r\n\r\nexport default Topbar;","import React from 'react';\r\nimport Home from './containers/home';\r\nimport View from './containers/view';\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route\r\n} from 'react-router-dom';\r\n\r\nconst App: React.FC = () => {\r\n  return (\r\n    <Router>\r\n      <Switch>\r\n        <Route path='/view'>\r\n          <View />\r\n        </Route>\r\n        <Route path='/'>\r\n          <Home />\r\n        </Route>\r\n      </Switch>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { createTheme } from '@material-ui/core/styles';\r\n\r\nconst theme = createTheme({\r\n  palette: {\r\n    primary: {\r\n      main: '#ffffff',\r\n      contrastText: '#595959'\r\n    },\r\n    secondary: {\r\n      main: '#3476dd',\r\n      contrastText: '#ffffff'\r\n    }\r\n  },\r\n  components: {\r\n    MuiTooltip: {\r\n      styleOverrides: {\r\n        tooltip: {\r\n          backgroundColor: 'rgba(0, 0, 0, 0.5)'\r\n        }\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\nexport default theme;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport { ThemeProvider } from '@material-ui/core/styles';\r\nimport theme from './theme';\r\n\r\nReactDOM.render(\r\n  <ThemeProvider theme={theme}>\r\n    <React.StrictMode>\r\n      <CssBaseline />\r\n      <App />\r\n    </React.StrictMode>\r\n  </ThemeProvider>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}